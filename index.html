<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro - ìš´ëª…ì˜ ë²ˆí˜¸</title>
<meta name="description" content="ì‚¬ì£¼íŒ”ì ê¸°ë°˜ ë¡œë˜ ë²ˆí˜¸ ìƒì„±. ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ 100% ì œì™¸. ì „ë¬¸ ì‚¬ì£¼ ë¶„ì„.">

<!-- Open Graph / ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ì¸ë„¤ì¼ -->
<meta property="og:type" content="website">
<meta property="og:title" content="ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro - ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œ">
<meta property="og:description" content="âœ¨ ì „ë¬¸ê°€ ìˆ˜ì¤€ ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· ğŸ’• ê³¼í•™ì  ê¶í•© ì§„ë‹¨ Â· ğŸ² ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜">
<meta property="og:image" content="https://simplesajulotto.com/share-thumbnail.png">
<meta property="og:url" content="https://simplesajulotto.com">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro - ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œ">
<meta name="twitter:description" content="âœ¨ ì „ë¬¸ê°€ ìˆ˜ì¤€ ì‚¬ì£¼íŒ”ì ë¶„ì„ Â· ğŸ’• ê³¼í•™ì  ê¶í•© ì§„ë‹¨ Â· ğŸ² ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜">
<meta name="twitter:image" content="https://simplesajulotto.com/share-thumbnail.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700;900&display=swap" rel="stylesheet">
<style>
/* ========================================
   CSS Variables & Reset
   ======================================== */
* { margin:0; padding:0; box-sizing:border-box; }
:root {
    --bg: #1a1a2e;
    --card: #16213e;
    --gold: #FDD835;
    --gold-dark: #F9A825;
    --red: #C62828;
    --red-dark: #8B0000;
    --white: #fff;
    --gray: #9CA3AF;
    --wood: #4CAF50;
    --fire: #F44336;
    --earth: #FF9800;
    --metal: #9E9E9E;
    --water: #2196F3;
    --blue: #003478;
}
body {
    font-family: 'Noto Serif KR', serif;
    background: var(--bg);
    color: var(--white);
    min-height: 100vh;
    padding-bottom: 20px;
    line-height: 1.7;
    position: relative;
}

/* ì›Œí„°ë§ˆí¬ ë°°ê²½ (ê²€ê° ì´ë¯¸ì§€) */
.watermark {
    position: fixed;
    top: 140px;
    left: 50%;
    transform: translateX(-50%);
    width: 500px;
    max-width: 100%;
    opacity: 0.15;
    z-index: 999;
    pointer-events: none;
}
.watermark img {
    width: 100%;
    height: auto;
    display: block;
}

/* ëª¨ë°”ì¼: ì–‘ì˜† ê½‰ ì°¨ê²Œ */
@media (max-width: 600px) {
    .watermark {
        width: 100%;
        left: 0;
        transform: none;
    }
}

/* ========================================
   íŒ”ê´˜ ì¥ì‹ (ì‚¬ë°©)
   ======================================== */
.bagua {
    position: fixed;
    font-size: 2rem;
    opacity: 0.5;
    pointer-events: none;
    z-index: 1;
    font-family: serif;
    line-height: 1;
    text-shadow: 0 0 15px currentColor;
    text-align: center;
}
.bagua.tl { top: 200px; left: 10px; color: #FFD700; }
.bagua.tr { top: 200px; right: 10px; color: #FF6B6B; }
.bagua.bl { bottom: 120px; left: 10px; color: #4ECDC4; }
.bagua.br { bottom: 120px; right: 10px; color: #A29BFE; }
.bagua-sub { font-size: 0.45em; display: block; margin-top: 3px; opacity: 0.8; }

/* ========================================
   Header
   ======================================== */
header {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
    padding: 25px 20px 20px;
    text-align: center;
    position: relative;
    z-index: 2;
    border-bottom: 2px solid var(--gold);
    box-shadow: 0 4px 20px rgba(253,216,53,0.2);
    overflow: hidden;
}
header::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 200%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(253,216,53,0.1), transparent);
    animation: headerShine 3s infinite;
}
@keyframes headerShine {
    0% { transform: translateX(-50%); }
    100% { transform: translateX(50%); }
}
header::after {
    content: 'âœ¦ ç¦ âœ¦ é‹ âœ¦ è²¡ âœ¦ å‰ âœ¦';
    position: absolute;
    top: 5px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 9px;
    color: var(--gold);
    letter-spacing: 8px;
    opacity: 0.5;
}
header h1 { 
    font-size: 28px; 
    font-weight: 900; 
    background: linear-gradient(135deg, #FFD700 0%, #FFF8DC 25%, #FFD700 50%, #FFA500 75%, #FFD700 100%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: goldShine 3s linear infinite;
    margin-top: 15px;
    text-shadow: 0 0 30px rgba(253,216,53,0.5);
    position: relative;
    z-index: 1;
}
@keyframes goldShine {
    0% { background-position: 0% center; }
    100% { background-position: 200% center; }
}
header p { 
    font-size: 12px; 
    color: var(--gold); 
    margin-top: 10px; 
    opacity: 0.8;
    letter-spacing: 1px;
    position: relative;
    z-index: 1;
}
.header-sparkles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
}
.sparkle {
    position: absolute;
    color: var(--gold);
    font-size: 12px;
    animation: sparkleAnim 3s ease-in-out infinite;
    opacity: 0;
}
@keyframes sparkleAnim {
    0%, 100% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1.2); }
}

/* ========================================
   Top Navigation (ìƒë‹¨ íƒ­)
   ======================================== */
.top-nav {
    background: var(--bg);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 5px;
    padding: 12px 10px;
    position: sticky;
    top: 0;
    z-index: 100;
}
.top-nav button {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.15);
    color: var(--gray);
    font-family: inherit;
    font-size: 13px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 16px;
    border-radius: 25px;
    transition: all 0.2s;
}
.top-nav button:hover { background: rgba(255,255,255,0.1); }
.top-nav button.active { 
    background: linear-gradient(135deg, var(--gold), var(--gold-dark)); 
    color: var(--red-dark); 
    font-weight: 700;
    border-color: var(--gold);
    box-shadow: 0 2px 10px rgba(253,216,53,0.3);
}
.top-nav button span { font-size: 16px; }

/* ========================================
   Container & Cards
   ======================================== */
.container { max-width: 500px; margin: 0 auto; padding: 15px; position: relative; z-index: 1; }
.tab { display: none; animation: fadeIn 0.3s; }
.tab.active { display: block; }
@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

.card {
    background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 15px;
}
.card h3 { font-size: 15px; font-weight: 700; margin-bottom: 15px; color: var(--white); display: flex; align-items: center; gap: 8px; }
.card.gold { background: linear-gradient(145deg, rgba(253,216,53,0.15), rgba(253,216,53,0.05)); border-color: rgba(253,216,53,0.3); }
.card.warn { background: linear-gradient(145deg, rgba(244,67,54,0.15), rgba(244,67,54,0.05)); border-color: rgba(244,67,54,0.3); }

/* ========================================
   Buttons
   ======================================== */
.btn {
    background: linear-gradient(135deg, var(--red), var(--red-dark));
    color: var(--white);
    border: none;
    padding: 16px 30px;
    font-family: inherit;
    font-size: 15px;
    font-weight: 700;
    border-radius: 12px;
    cursor: pointer;
    width: 100%;
    margin: 6px 0;
    box-shadow: 0 4px 15px rgba(198,40,40,0.3);
    transition: transform 0.2s;
}
.btn:active { transform: scale(0.98); }
.btn.gold { background: linear-gradient(135deg, var(--gold), var(--gold-dark)); color: var(--red-dark); }
.btn.secondary { background: linear-gradient(135deg, #1a1a2e, #2d2d44); border: 1px solid rgba(255,255,255,0.2); box-shadow: none; }
.btn.outline { background: transparent; border: 1px solid rgba(255,255,255,0.3); box-shadow: none; }
.btn-row { display: flex; gap: 10px; margin: 10px 0; }
.btn-row .btn { flex: 1; margin: 0; }

/* ========================================
   Lotto Balls
   ======================================== */
.balls { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin: 15px 0; }
.ball {
    width: 48px; height: 48px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: 700;
    color: var(--white);
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    position: relative;
}
.ball::before {
    content: '';
    position: absolute;
    top: 8px; left: 12px;
    width: 8px; height: 8px;
    background: rgba(255,255,255,0.4);
    border-radius: 50%;
}
.ball.sm { width: 36px; height: 36px; font-size: 14px; }
.ball.sm::before { width: 6px; height: 6px; top: 6px; left: 9px; }
.ball.y { background: linear-gradient(135deg, #FFC107, #FF9800); }
.ball.b { background: linear-gradient(135deg, #42A5F5, #1976D2); }
.ball.r { background: linear-gradient(135deg, #EF5350, #C62828); }
.ball.g { background: linear-gradient(135deg, #66BB6A, #2E7D32); }
.ball.p { background: linear-gradient(135deg, #AB47BC, #6A1B9A); }

/* ========================================
   Forms
   ======================================== */
.form-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: flex-end; }
.form-group { flex: 1; }
.form-group label { display: block; color: var(--gray); font-size: 11px; margin-bottom: 4px; }
.form-group select, .form-group input {
    width: 100%;
    padding: 10px;
    background: #2a2a3d;
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    color: var(--white);
    font-family: inherit;
    font-size: 14px;
}
.form-group select option {
    background: #2a2a3d;
    color: #ffffff;
    padding: 10px;
}
.form-group select:focus, .form-group input:focus { outline: none; border-color: var(--gold); }
.toggle-btns { display: flex; gap: 5px; }
.toggle-btn {
    flex: 1;
    padding: 10px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    color: var(--gray);
    font-family: inherit;
    font-size: 12px;
    cursor: pointer;
}
.toggle-btn.on { background: linear-gradient(135deg, var(--gold), var(--gold-dark)); color: var(--red-dark); font-weight: 700; border-color: var(--gold); }

/* ========================================
   Saju Pillars
   ======================================== */
.pillars { display: flex; justify-content: center; gap: 8px; margin: 15px 0; }
.pillar {
    min-width: 70px;
    background: linear-gradient(180deg, rgba(253,216,53,0.1), rgba(0,0,0,0.3));
    border: 1px solid rgba(253,216,53,0.3);
    border-radius: 12px;
    padding: 12px 8px;
    text-align: center;
}
.pillar.dm { border-color: var(--gold); box-shadow: 0 0 15px rgba(253,216,53,0.3); }
.pillar-label { font-size: 10px; color: var(--gray); margin-bottom: 8px; }
.pillar-stem, .pillar-branch { font-size: 1.6rem; font-weight: 900; display: block; margin: 3px 0; }
.pillar-sub { font-size: 9px; color: var(--gray); margin-top: 6px; }
.pillar-god { font-size: 10px; color: var(--gold); margin-top: 4px; }

/* ========================================
   Element Colors
   ======================================== */
.el-wood { color: var(--wood); }
.el-fire { color: var(--fire); }
.el-earth { color: var(--earth); }
.el-metal { color: var(--metal); }
.el-water { color: var(--water); }
.bg-wood { background: var(--wood); }
.bg-fire { background: var(--fire); }
.bg-earth { background: var(--earth); }
.bg-metal { background: var(--metal); }
.bg-water { background: var(--water); }

/* ========================================
   Strength Bar
   ======================================== */
.strength-box { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin: 15px 0; }
.strength-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.strength-title { font-size: 14px; color: var(--gold); }
.strength-badge { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; }
.strength-badge.strong { background: rgba(239,68,68,0.2); color: #FCA5A5; }
.strength-badge.weak { background: rgba(59,130,246,0.2); color: #93C5FD; }
.strength-badge.balanced { background: rgba(234,179,8,0.2); color: #FDE047; }
.strength-bar { height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; margin-bottom: 12px; }
.strength-fill { height: 100%; border-radius: 4px; transition: width 0.5s; }
.strength-fill.strong { background: linear-gradient(90deg, #EF4444, #F97316); }
.strength-fill.weak { background: linear-gradient(90deg, #3B82F6, #06B6D4); }
.strength-fill.balanced { background: linear-gradient(90deg, #EAB308, #22C55E); }
.factors { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; }
.factor { display: flex; justify-content: space-between; padding: 6px 10px; background: rgba(255,255,255,0.03); border-radius: 6px; font-size: 12px; }
.factor-label { color: var(--gray); }
.factor-value { font-weight: 600; }
.factor-value.pos { color: var(--wood); }
.factor-value.neg { color: var(--fire); }

/* ========================================
   Gods (ìš©ì‹ /í¬ì‹ /ê¸°ì‹ )
   ======================================== */
.gods { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
.god {
    text-align: center;
    padding: 15px 10px;
    border-radius: 12px;
    background: rgba(0,0,0,0.2);
}
.god.yong { border: 2px solid var(--gold); background: linear-gradient(180deg, rgba(253,216,53,0.1), transparent); }
.god.hee { border: 2px solid var(--wood); background: linear-gradient(180deg, rgba(76,175,80,0.1), transparent); }
.god.gi { border: 2px solid var(--fire); background: linear-gradient(180deg, rgba(244,67,54,0.1), transparent); }
.god-title { font-size: 11px; color: var(--gray); margin-bottom: 8px; }
.god-element { font-size: 2rem; font-weight: 900; }
.god-name { font-size: 12px; margin-top: 5px; }
.god-desc { font-size: 10px; color: var(--gray); margin-top: 4px; }

/* ========================================
   Tabs (í†µë³€)
   ======================================== */
.sub-tabs { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; }
.sub-tab {
    padding: 8px 12px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 20px;
    color: var(--gray);
    font-size: 12px;
    cursor: pointer;
    font-family: inherit;
}
.sub-tab.on { background: var(--gold); color: var(--red-dark); font-weight: 700; border-color: var(--gold); }
.sub-content { display: none; }
.sub-content.on { display: block; }

/* ========================================
   Info Box
   ======================================== */
.info-box {
    background: rgba(255,255,255,0.03);
    border-radius: 10px;
    padding: 15px;
    margin: 10px 0;
    border-left: 3px solid var(--gray);
}
.info-box.good { border-color: var(--wood); background: rgba(76,175,80,0.1); }
.info-box.warn { border-color: var(--fire); background: rgba(244,67,54,0.1); }
.info-box.gold { border-color: var(--gold); background: rgba(253,216,53,0.1); }
.info-box p { font-size: 13px; line-height: 1.8; }
.info-box strong { color: var(--gold); }

/* ========================================
   Luck Timeline
   ======================================== */
.luck-timeline { display: flex; gap: 8px; overflow-x: auto; padding: 10px 0; }
.luck-item {
    min-width: 60px;
    text-align: center;
    padding: 10px 8px;
    background: rgba(255,255,255,0.05);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
    flex-shrink: 0;
}
.luck-item.current { border-color: var(--gold); background: rgba(253,216,53,0.1); }
.luck-item.good { border-color: var(--wood); }
.luck-item.bad { border-color: var(--fire); }
.luck-age { font-size: 10px; color: var(--gray); }
.luck-pillar { font-size: 16px; font-weight: 700; margin: 5px 0; }
.luck-rating { font-size: 14px; }

/* ========================================
   Sinsal Grid
   ======================================== */
.sinsal-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
.sinsal {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 12px;
    background: rgba(255,255,255,0.03);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
}
.sinsal.good { border-color: rgba(76,175,80,0.5); background: rgba(76,175,80,0.1); }
.sinsal.bad { border-color: rgba(244,67,54,0.5); background: rgba(244,67,54,0.1); }
.sinsal-icon { font-size: 1.5rem; }
.sinsal-name { font-size: 13px; font-weight: 700; margin-bottom: 4px; }
.sinsal-desc { font-size: 11px; color: var(--gray); line-height: 1.5; }

/* ========================================
   Interaction List
   ======================================== */
.int-list { margin: 10px 0; }
.int-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: rgba(255,255,255,0.03);
    border-radius: 10px;
    margin-bottom: 8px;
}
.int-type {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255,255,255,0.1);
    border-radius: 50%;
    font-weight: 900;
    font-size: 14px;
}
.int-chars { font-size: 16px; font-weight: 700; }
.int-meaning { font-size: 12px; color: var(--gray); margin-top: 4px; line-height: 1.5; }

/* ========================================
   Rating Stars
   ======================================== */
.rating { display: flex; align-items: center; gap: 5px; margin: 10px 0; }
.rating-label { font-size: 12px; color: var(--gray); }
.rating-stars { font-size: 16px; letter-spacing: 2px; }

/* ========================================
   History
   ======================================== */
.history-item {
    display: flex;
    justify-content: center;
    gap: 4px;
    padding: 12px;
    background: rgba(255,255,255,0.03);
    border-radius: 10px;
    margin: 6px 0;
}

/* ========================================
   Toast
   ======================================== */
.toast {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--gold);
    color: var(--red-dark);
    padding: 15px 30px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 700;
    opacity: 0;
    transition: all 0.3s;
    z-index: 200;
}
.toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

/* ========================================
   Modal
   ======================================== */
.modal {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.8);
    z-index: 200;
    align-items: center;
    justify-content: center;
    padding: 20px;
}
.modal.active { display: flex; }
.modal-content {
    background: var(--bg);
    border: 1px solid rgba(253,216,53,0.3);
    border-radius: 20px;
    padding: 25px;
    width: 100%;
    max-width: 380px;
    text-align: center;
}
.modal-content h3 { color: var(--gold); margin-bottom: 20px; font-size: 18px; }

/* ========================================
   Capture Area (Hidden)
   ======================================== */
#capture-area {
    position: fixed;
    top: -9999px;
    left: -9999px;
    width: 380px;
    padding: 35px 25px;
    background: linear-gradient(145deg, var(--gold), var(--gold-dark));
    text-align: center;
    font-family: 'Noto Serif KR', serif;
    border-radius: 20px;
    border: 4px solid var(--red);
}

/* ========================================
   Footer (íƒ­ë³„ ë‹¤ë¥¸ í‘¸í„°)
   ======================================== */
footer.tab-footer {
    display: none;
    text-align: center;
    padding: 30px 20px;
    color: #666;
    font-size: 11px;
    line-height: 1.8;
}
footer.tab-footer.active { display: block; }

/* ê³µìœ  ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.share-section {
    margin-top: 30px;
    padding: 20px;
    background: linear-gradient(145deg, rgba(253,216,53,0.08), rgba(255,215,0,0.03));
    border-radius: 15px;
    text-align: center;
}
.share-title {
    font-size: 1rem;
    color: var(--gold);
    margin-bottom: 15px;
}
.share-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
}
.share-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    border-radius: 25px;
    border: none;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}
.share-btn.kakao {
    background: #FEE500;
    color: #3C1E1E;
}
.share-btn.kakao:hover {
    background: #F5DC00;
    transform: scale(1.05);
}
.share-btn.copy-link {
    background: rgba(255,255,255,0.1);
    color: var(--gold);
    border: 1px solid var(--gold);
}
.share-btn.copy-link:hover {
    background: rgba(253,216,53,0.2);
}
</style>
<!-- Kakao SDK -->
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js" integrity="sha384-TiCUE00h649CAMonG018J2ujOgDKW/kVWlChEuu4jK2vxfAAD0eZxzCKakxg55G4" crossorigin="anonymous"></script>
<script>
// ğŸ”’ ë³µì‚¬ ë°©ì§€ ìŠ¤í¬ë¦½íŠ¸
(function(){
    // ìš°í´ë¦­ ë°©ì§€
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        return false;
    });
    
    // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë°©ì§€ (F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U)
    document.addEventListener('keydown', function(e) {
        // F12
        if (e.key === 'F12' || e.keyCode === 123) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
        if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C' || e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67)) {
            e.preventDefault();
            return false;
        }
        // Ctrl+U (ì†ŒìŠ¤ë³´ê¸°)
        if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.keyCode === 85)) {
            e.preventDefault();
            return false;
        }
        // Ctrl+S (ì €ì¥)
        if (e.ctrlKey && (e.key === 's' || e.key === 'S' || e.keyCode === 83)) {
            e.preventDefault();
            return false;
        }
    });
    
    // ë“œë˜ê·¸ ì„ íƒ ë°©ì§€
    document.addEventListener('selectstart', function(e) {
        if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
            e.preventDefault();
            return false;
        }
    });
})();
</script>
</head>
<body style="-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;">

<!-- ì›Œí„°ë§ˆí¬ ë°°ê²½ -->
<div class="watermark">
    <img src="share-thumbnail.png" alt="" onerror="this.parentElement.style.display='none'">
</div>

<!-- ========================================
     íŒ”ê´˜ ì¥ì‹ (ì‚¬ë°©)
     ======================================== -->
<div class="bagua tl">â˜°<span class="bagua-sub">ä¹¾</span></div>
<div class="bagua tr">â˜·<span class="bagua-sub">å¤</span></div>
<div class="bagua bl">â˜µ<span class="bagua-sub">å</span></div>
<div class="bagua br">â˜²<span class="bagua-sub">é›¢</span></div>

<!-- ========================================
     Capture Card (Hidden)
     ======================================== -->
<div id="capture-area">
    <div style="color:#C62828;font-size:10px;letter-spacing:10px;margin-bottom:15px;opacity:0.5;">ç¦ é‹ è²¡ å‰</div>
    <h2 style="font-size:22px;color:#C62828;margin-bottom:5px;">ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro</h2>
    <p style="font-size:11px;color:#8B0000;margin-bottom:20px;">ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ 100% ì œì™¸ Â· ì‚¬ì£¼ ê¸°ë°˜</p>
    <div style="background:rgba(139,0,0,0.1);border:2px dashed #C62828;border-radius:15px;padding:20px;margin-bottom:20px;">
        <p style="font-size:11px;color:#8B0000;margin-bottom:10px;" id="capture-date"></p>
        <div id="capture-numbers" style="display:flex;justify-content:center;gap:6px;flex-wrap:wrap;"></div>
    </div>
    <p style="font-size:14px;color:#C62828;font-weight:700;margin-bottom:5px;">"ëŒ€ë°•ë‚˜ì„¸ìš”! ğŸ€"</p>
    <p style="font-size:10px;color:#8B0000;opacity:0.6;">simplesajulotto.com</p>
</div>

<!-- ========================================
     Header
     ======================================== -->
<header>
    <div class="header-sparkles">
        <span class="sparkle" style="top:20%;left:10%;animation-delay:0s;">âœ¦</span>
        <span class="sparkle" style="top:60%;left:5%;animation-delay:0.5s;">âœ§</span>
        <span class="sparkle" style="top:30%;left:90%;animation-delay:1s;">âœ¦</span>
        <span class="sparkle" style="top:70%;left:85%;animation-delay:1.5s;">âœ§</span>
        <span class="sparkle" style="top:40%;left:15%;animation-delay:2s;">â‹†</span>
        <span class="sparkle" style="top:50%;left:92%;animation-delay:2.5s;">â‹†</span>
    </div>
    <h1>ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro</h1>
    <p>âœ¨ ì „ë¬¸ ì‚¬ì£¼ ë¶„ì„ Â· ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜ âœ¨</p>
</header>

<!-- ========================================
     ìƒë‹¨ íƒ­ ë„¤ë¹„ê²Œì´ì…˜
     ======================================== -->
<div class="top-nav">
    <button class="active" onclick="switchTab('saju')"><span>ğŸ”®</span><span>ì‚¬ì£¼</span></button>
    <button onclick="switchTab('match')"><span>ğŸ’‘</span><span>ê¶í•©</span></button>
    <button onclick="switchTab('lotto')"><span>ğŸ²</span><span>ë¡œë˜</span></button>
</div>

<div class="container">

<!-- ========================================
     Tab 1: ë¡œë˜ ë²ˆí˜¸ ìƒì„±
     ======================================== -->
<div id="tab-lotto" class="tab">
    <div class="card gold">
        <div style="text-align:center;padding:10px;background:rgba(198,40,40,0.2);border-radius:8px;margin-bottom:15px;">
            <span style="font-size:13px;color:var(--gold);">âœ… ì—­ëŒ€ ëª¨ë“  ë‹¹ì²¨ë²ˆí˜¸ ë¶„ì„ ì™„ë£Œ</span>
        </div>
        
        <div class="balls" id="lotto-balls">
            <div class="ball y">?</div>
            <div class="ball b">?</div>
            <div class="ball r">?</div>
            <div class="ball r">?</div>
            <div class="ball g">?</div>
            <div class="ball p">?</div>
        </div>
        
        <button class="btn" onclick="generateLotto()">ğŸ² í–‰ìš´ì˜ ë²ˆí˜¸ ìƒì„±</button>
        
        <div class="btn-row">
            <button class="btn secondary" onclick="openShareModal()">ğŸ“¤ ê³µìœ </button>
            <button class="btn gold" onclick="saveImage()">ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥</button>
        </div>
        
        <p style="text-align:center;margin-top:15px;font-size:12px;color:var(--gray);">
            <span style="background:rgba(253,216,53,0.2);padding:5px 12px;border-radius:20px;color:var(--gold);">
                âœ¨ ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ì™€ 100% ê²¹ì¹˜ì§€ ì•ŠëŠ” ì¡°í•©
            </span>
        </p>
    </div>
    
    <!-- ì˜¤ëŠ˜ì˜ ì¼ì§„ (ì‚¬ì£¼ ì…ë ¥ í›„ í‘œì‹œ) -->
    <div class="card" id="today-fortune" style="display:none;">
        <h3>ğŸŒŸ ì˜¤ëŠ˜ì˜ ìš´ì„¸</h3>
        <div id="today-fortune-content"></div>
    </div>
    
    <!-- íˆìŠ¤í† ë¦¬ -->
    <div class="card" id="history-card" style="display:none;">
        <h3>ğŸ“‹ ì˜¤ëŠ˜ ìƒì„±í•œ ë²ˆí˜¸</h3>
        <div id="history-list"></div>
    </div>
</div>

<!-- ========================================
     Tab 2: ì‚¬ì£¼ ë¶„ì„
     ======================================== -->
<div id="tab-saju" class="tab active">
    <!-- ìƒë…„ì›”ì¼ ì…ë ¥ -->
    <div class="card">
        <h3>ğŸ“… ìƒë…„ì›”ì¼ì‹œ</h3>
        <div class="form-row">
            <div class="form-group"><label>ë…„</label><select id="birth-year"></select></div>
            <div class="form-group"><label>ì›”</label><select id="birth-month"></select></div>
            <div class="form-group"><label>ì¼</label><select id="birth-day"></select></div>
            <div class="form-group"><label>ì‹œ</label><select id="birth-hour"></select></div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>ì„±ë³„</label>
                <div class="toggle-btns">
                    <button class="toggle-btn on" data-gender="m" onclick="setGender('m')">ğŸ‘¨ ë‚¨</button>
                    <button class="toggle-btn" data-gender="f" onclick="setGender('f')">ğŸ‘© ì—¬</button>
                </div>
            </div>
            <div class="form-group">
                <label>ì–‘/ìŒë ¥</label>
                <div class="toggle-btns">
                    <button class="toggle-btn on" data-cal="solar" onclick="setCalendar('solar')">â˜€ï¸ ì–‘ë ¥</button>
                    <button class="toggle-btn" data-cal="lunar" onclick="setCalendar('lunar')">ğŸŒ™ ìŒë ¥</button>
                </div>
            </div>
        </div>
        <button class="btn" onclick="analyzeSaju()">ğŸ”® ì •ë°€ ë¶„ì„</button>
    </div>
    
    <!-- ì‚¬ì£¼ ê²°ê³¼ ì˜ì—­ -->
    <div id="saju-result" style="display:none;">
        <!-- ì‚¬ì£¼ ì›êµ­ -->
        <div class="card">
            <h3>ğŸ“œ ì‚¬ì£¼ ì›êµ­</h3>
            <div class="pillars" id="pillars"></div>
            <div id="twelve-states"></div>
            <div class="strength-box" id="strength-box"></div>
        </div>
        
        <!-- ë‚©ìŒ/ëª…ê¶/íƒœì› (NEW) -->
        <div class="card">
            <h3>ğŸµ ë‚©ìŒ Â· ëª…ê¶ Â· íƒœì›</h3>
            <div id="napeum-myunggung"></div>
        </div>
        
        <!-- ì§€ì¥ê°„ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ” ì§€ì¥ê°„ ë¶„ì„</h3>
            <div id="jijanggan-analysis"></div>
        </div>
        
        <!-- í†µê·¼/íˆ¬ê°„ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸŒ³ í†µê·¼ Â· íˆ¬ê°„</h3>
            <div id="tonggeun-analysis"></div>
        </div>
        
        <!-- ìš©ì‹ /í¬ì‹ /ê¸°ì‹  -->
        <div class="card">
            <h3>ğŸ¯ ìš©ì‹  Â· í¬ì‹  Â· ê¸°ì‹ </h3>
            <div class="gods" id="gods"></div>
            <div id="gods-detail"></div>
            <div id="johu-detail"></div>
        </div>
        
        <!-- ìœ¡ì¹œ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ìœ¡ì¹œ(å…­è¦ª) ë¶„ì„</h3>
            <div id="yukcheon-analysis"></div>
        </div>
        
        <!-- ê²©êµ­ -->
        <div class="card">
            <h3>ğŸ“ ê²©êµ­</h3>
            <div id="format"></div>
        </div>
        
        <!-- 60ê°‘ì ì¼ì£¼ë¡  -->
        <div class="card">
            <h3>ğŸ´ 60ê°‘ì ì¼ì£¼ë¡ </h3>
            <div id="ilju"></div>
        </div>
        
        <!-- ê¶ìœ„ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ›ï¸ ê¶ìœ„(å®®ä½) ë¶„ì„</h3>
            <div id="gungwi-analysis"></div>
        </div>
        
        <!-- 12ìš´ì„± ì™„ì „ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ”„ 12ìš´ì„± ì™„ì „ ë¶„ì„</h3>
            <div id="twelve-states-full"></div>
        </div>
        
        <!-- ëŒ€ìš´ -->
        <div class="card">
            <h3>ğŸŒŠ ëŒ€ìš´</h3>
            <div class="luck-timeline" id="luck-timeline"></div>
            <div id="luck-detail"></div>
        </div>
        
        <!-- ëŒ€ìš´ êµìš´ê¸° (NEW) -->
        <div class="card">
            <h3>ğŸ”„ ëŒ€ìš´ êµìš´ê¸° ë¶„ì„</h3>
            <div id="gyoungi-analysis"></div>
        </div>
        
        <!-- 10ë…„ ìš´ì„¸ (NEW) -->
        <div class="card">
            <h3>ğŸ“† 10ë…„ ìš´ì„¸ ë¯¸ë¦¬ë³´ê¸°</h3>
            <div id="ten-years-luck"></div>
        </div>
        
        <!-- ì˜¬í•´ ì›”ìš´ (NEW) -->
        <div class="card">
            <h3>ğŸ—“ï¸ ì˜¬í•´ ì›”ë³„ ìš´ì„¸</h3>
            <div id="monthly-luck"></div>
        </div>
        
        <!-- í†µë³€ -->
        <div class="card">
            <h3>ğŸ”® í†µë³€</h3>
            <div class="sub-tabs" id="fortune-tabs">
                <button class="sub-tab on" onclick="showFortune('total')">ì´ìš´</button>
                <button class="sub-tab" onclick="showFortune('today')">ì˜¤ëŠ˜</button>
                <button class="sub-tab" onclick="showFortune('year')">ì—°ìš´</button>
                <button class="sub-tab" onclick="showFortune('career')">ì§ì—…</button>
                <button class="sub-tab" onclick="showFortune('love')">ì—°ì• </button>
                <button class="sub-tab" onclick="showFortune('wealth')">ì¬ë¬¼</button>
                <button class="sub-tab" onclick="showFortune('health')">ê±´ê°•</button>
            </div>
            <div id="fortune-content"></div>
        </div>
        
        <!-- í•©ì¶©í˜•íŒŒí•´ -->
        <div class="card">
            <h3>ğŸ’« í•©ì¶©í˜•íŒŒí•´</h3>
            <div id="interactions"></div>
        </div>
        
        <!-- ë°©í•©/ì•”í•© ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸŒ€ ë°©í•© Â· ì•”í•©</h3>
            <div id="banghap-amhap"></div>
        </div>
        
        <!-- í•©ì¶© ê³ ê¸‰ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>âš—ï¸ í•©í™”/ì¶©í•´ì†Œ ë¶„ì„</h3>
            <div id="advanced-interactions"></div>
        </div>
        
        <!-- ê³µë§ -->
        <div class="card">
            <h3>ğŸ•³ï¸ ê³µë§</h3>
            <div id="gongmang"></div>
        </div>
        
        <!-- ê³µë§ í•´ì†Œ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ”“ ê³µë§ í•´ì†Œ ë¶„ì„</h3>
            <div id="gongmang-haeso"></div>
        </div>
        
        <!-- ì‹ ì‚´ -->
        <div class="card">
            <h3>â­ ì‹ ì‚´</h3>
            <div class="sinsal-grid" id="sinsal"></div>
        </div>
        
        <!-- ì‹ ì‚´ ìœ„ì¹˜ë³„ ë¶„ì„ (NEW) -->
        <div class="card">
            <h3>ğŸ“ ì‹ ì‚´ ìœ„ì¹˜ë³„ í•´ì„</h3>
            <div id="sinsal-position"></div>
        </div>
        
        <!-- AI ì¢…í•© í•´ì„ (NEW) -->
        <div class="card" style="background:linear-gradient(145deg, rgba(156,39,176,0.15), rgba(103,58,183,0.08)); border-color:rgba(156,39,176,0.3);">
            <h3>ğŸ§  AI ì¢…í•© í•´ì„</h3>
            <div id="ai-interpretation"></div>
            <button class="btn" style="margin-top:15px;background:linear-gradient(135deg,#9C27B0,#673AB7);" onclick="copySajuForAI()">
                ğŸ“‹ ì„œìˆ í˜• í•´ì„ì„ ìœ„í•œ ë³µì‚¬ (Gemini/ChatGPT)
            </button>
            <p style="margin-top:15px;font-size:13px;color:#9C27B0;opacity:0.9;line-height:1.8;text-align:center;">
                âœ¨ ì •ë°€í•œ ëª…ë¦¬ ë°ì´í„°ì™€ AIì˜ ì‹¬ì¸µ ë¶„ì„ì´ ë§Œë‚˜ëŠ”<br>
                <span style="color:var(--gold);font-weight:600;">í˜„ì¡´í•˜ëŠ” ê°€ì¥ ì™„ë²½í•œ ì‚¬ì£¼ í•´ì„ì˜ ì¡°í•©</span>ì…ë‹ˆë‹¤
            </p>
            <p style="margin-top:10px;font-size:12px;color:#aaa;line-height:1.7;text-align:center;">
                ê³ ì „ ëª…ë¦¬ì˜ ë³µì¡í•œ ìˆ˜ì‹ì€ ë‹¨ í•œ ì¹˜ì˜ ì˜¤ì°¨ ì—†ì´ ê³„ì‚°í•˜ê³ ,<br>
                ê·¸ ê²°ê³¼ë¥¼ ì„¸ê³„ ìµœì •ìƒ AIê°€ ì˜¤ì§ ë‹¹ì‹ ë§Œì„ ìœ„í•´ í•´ì„í•©ë‹ˆë‹¤.<br>
                <span style="color:var(--gold);opacity:0.9;">ì „ë¬¸ê°€ì˜ í†µì°°ê³¼ ê¸°ìˆ ì˜ ì •í™•ì„±, ë‘˜ ëª¨ë‘ë¥¼ ì·¨í•˜ì‹­ì‹œì˜¤.</span>
            </p>
        </div>
        
        <!-- ì‚¬ì£¼ ê¸°ë°˜ ë¡œë˜ -->
        <div class="card gold">
            <h3>ğŸ° ì‚¬ì£¼ ê¸°ë°˜ í–‰ìš´ ë²ˆí˜¸</h3>
            <p style="font-size:12px;color:var(--gray);margin-bottom:15px;">
                ë‹¹ì‹ ì˜ ìš©ì‹ (ç”¨ç¥) ì˜¤í–‰ì— ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•œ íŠ¹ë³„í•œ ë²ˆí˜¸ì…ë‹ˆë‹¤.
            </p>
            <div class="balls" id="saju-lotto-balls"></div>
            <button class="btn gold" onclick="generateSajuLotto()">ğŸ”® ìš©ì‹  ê¸°ë°˜ ë²ˆí˜¸ ìƒì„±</button>
        </div>
    </div>
</div>

<!-- ========================================
     Tab 3: ê¶í•©
     ======================================== -->
<div id="tab-match" class="tab">
    <div class="card">
        <h3>ğŸ’‘ ê¶í•© ë¶„ì„</h3>
        <p style="font-size:12px;color:var(--gray);margin-bottom:15px;">
            ìƒëŒ€ë°© ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ë‘ ì‚¬ëŒì˜ ê¶í•©ì„ ë¶„ì„í•©ë‹ˆë‹¤.
        </p>
        
        <div style="background:rgba(253,216,53,0.1);padding:15px;border-radius:10px;margin-bottom:15px;">
            <p style="font-size:11px;color:var(--gray);margin-bottom:10px;">ğŸ‘¤ ë‚˜ì˜ ì •ë³´</p>
            <div id="my-info-display">
                <p style="color:var(--gold);">ë¨¼ì € [ì‚¬ì£¼ë¶„ì„] íƒ­ì—ì„œ ë‚´ ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”</p>
            </div>
        </div>
        
        <p style="font-size:11px;color:var(--gray);margin-bottom:10px;">ğŸ’• ìƒëŒ€ë°© ì •ë³´</p>
        <div class="form-row">
            <div class="form-group"><label>ë…„</label><select id="partner-year"></select></div>
            <div class="form-group"><label>ì›”</label><select id="partner-month"></select></div>
            <div class="form-group"><label>ì¼</label><select id="partner-day"></select></div>
            <div class="form-group">
                <label>ì„±ë³„</label>
                <select id="partner-gender">
                    <option value="m">ë‚¨</option>
                    <option value="f">ì—¬</option>
                </select>
            </div>
        </div>
        <button class="btn" onclick="analyzeMatch()">ğŸ’• ê¶í•© ë³´ê¸°</button>
    </div>
    
    <div id="match-result"></div>
</div>

</div><!-- container -->

<!-- ========================================
     Share Modal
     ======================================== -->
<div class="modal" id="share-modal">
    <div class="modal-content">
        <h3>ğŸ“¤ ë²ˆí˜¸ ê³µìœ í•˜ê¸°</h3>
        <div style="background:rgba(0,0,0,0.3);padding:20px;border-radius:12px;margin:15px 0;">
            <p style="font-size:12px;color:var(--gray);margin-bottom:10px;">ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro</p>
            <div class="balls" id="share-balls"></div>
        </div>
        <button class="btn" onclick="shareNumbers()">ğŸ“¤ ê³µìœ í•˜ê¸°</button>
        <button class="btn secondary" onclick="copyNumbers()">ğŸ“‹ ë²ˆí˜¸ ë³µì‚¬</button>
        <button class="btn outline" onclick="closeShareModal()">ë‹«ê¸°</button>
    </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- ê³µìœ  ì„¹ì…˜ -->
<div class="container" style="margin-top:30px;margin-bottom:20px;">
    <div class="share-section">
        <p class="share-title">âœ¨ ì´ ì•±ì´ ë§ˆìŒì— ë“œì…¨ë‚˜ìš”?</p>
        <p style="font-size:0.85rem;color:#aaa;margin-bottom:15px;line-height:1.6;">
            ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œë¥¼ ë‹´ì€ ì‚¬ì£¼ ë¶„ì„<br>
            ì†Œì¤‘í•œ ë¶„ë“¤ê³¼ í•¨ê»˜ ë‚˜ëˆ ë³´ì„¸ìš”
        </p>
        <div class="share-buttons">
            <button class="share-btn kakao" onclick="shareKakao()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 3C6.48 3 2 6.58 2 11c0 2.84 1.89 5.33 4.71 6.73-.15.54-.53 1.97-.61 2.27-.09.38.14.37.3.27.12-.07 1.93-1.31 2.71-1.84.62.09 1.26.14 1.89.14 5.52 0 10-3.58 10-8S17.52 3 12 3z"/>
                </svg>
                ì¹´ì¹´ì˜¤í†¡ ê³µìœ 
            </button>
            <button class="share-btn copy-link" onclick="copyShareLink()">
                ğŸ”— ë§í¬ ë³µì‚¬
            </button>
        </div>
    </div>
    
    <!-- ë³µì±„ ì„¹ì…˜ -->
    <div style="margin-top:20px;padding:20px;background:linear-gradient(145deg, rgba(255,215,0,0.1), rgba(255,180,0,0.05));border-radius:15px;text-align:center;">
        <p style="font-size:1rem;color:var(--gold);margin-bottom:10px;">ğŸ™ ë³µì±„(ç¦å‚µ)</p>
        <p style="font-size:0.95rem;color:#ddd;margin-bottom:5px;line-height:1.7;">
            ì ê´˜ë¥¼ ë³´ì…¨ìœ¼ë‹ˆ, ë³µì±„ëŠ” ì˜ˆ(ç¦®)ì…ë‹ˆë‹¤.
        </p>
        <p style="font-size:0.9rem;color:#aaa;margin-bottom:18px;">
            ë‚˜ëˆˆ ë³µì€ ë°°ê°€ ë˜ì–´ ëŒì•„ì˜µë‹ˆë‹¤.
        </p>
        <div style="display:flex;flex-direction:column;gap:10px;align-items:center;">
            <a href="https://qr.kakaopay.com/FGskvpJmd" target="_blank" style="display:inline-block;width:220px;padding:12px 20px;background:#FEE500;color:#3C1E1E;font-weight:600;border-radius:25px;text-decoration:none;font-size:0.9rem;">
                ğŸ’› ì¹´ì¹´ì˜¤í˜ì´
            </a>
            <button onclick="copyAccount()" style="width:220px;padding:12px 20px;background:rgba(255,255,255,0.1);color:var(--gold);font-weight:600;border-radius:25px;border:1px solid var(--gold);font-size:0.9rem;cursor:pointer;">
                ğŸ¦ ê³„ì¢Œë³µì‚¬ (ì¼€ì´ë±…í¬)
            </button>
        </div>
        <p style="margin-top:20px;font-size:1.05rem;color:#ccc;line-height:1.8;">
            ğŸ”’ ê´‘ê³  ì—†ì´, ë¶ˆìˆœí•œ ê¸°ìš´ ì—†ì´<br>
            <span style="color:var(--gold);font-size:1.1rem;">ì˜¤ë¡¯ì´ ë§‘ì€ ê¸°(æ°£)ë§Œ ë¨¸ë¬´ëŠ” ê³³</span>
        </p>
        <p style="margin-top:12px;font-size:0.8rem;color:#888;line-height:1.6;">
            ë³µì±„ëŠ” ìë°œì  ê°ì‚¬ì˜ í‘œì‹œì´ë©°, ì„œë¹„ìŠ¤ ì´ìš©ê³¼ ë¬´ê´€í•©ë‹ˆë‹¤.
        </p>
    </div>
</div>

<footer id="footer-lotto" class="tab-footer">
    <div style="border-top:1px solid rgba(76,175,80,0.2);padding-top:25px;margin-bottom:20px;">
        <p style="color:var(--wood);font-size:13px;margin-bottom:15px;">ğŸ€ ì‚¬ì£¼ ê¸°ë°˜ í–‰ìš´ ë²ˆí˜¸ ìƒì„±</p>
        <p style="font-size:12px;line-height:2;color:#999;">
            <span style="opacity:0.8;">ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ 100% ì œì™¸ Â· ì˜¤í–‰(äº”è¡Œ) ê· í˜• ë°°ì¹˜</span><br>
            <span style="opacity:0.7;">ìš©ì‹ (ç”¨ç¥) ê¸°ë°˜ í–‰ìš´ìˆ˜ ë„ì¶œ Â· ê°œì¸í™” ì•Œê³ ë¦¬ì¦˜</span>
        </p>
    </div>
    <p style="font-size:11px;opacity:0.6;">âš ï¸ ë¡œë˜ëŠ” ì˜¤ë½ì…ë‹ˆë‹¤. ê³¼ë„í•œ êµ¬ë§¤ëŠ” ì‚¼ê°€ì„¸ìš”.</p>
    <p style="font-size:10px;opacity:0.4;margin-top:5px;">ë³¸ ì‚¬ì´íŠ¸ëŠ” ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    <p style="margin-top:15px;opacity:0.4;font-size:10px;">ğŸ”’ ê´‘ê³  ì—†ëŠ” ì²­ì • ê³µê°„ Â· Â© 2026 ì‚¬ì£¼ë¡œë˜ Pro</p>
</footer>

<footer id="footer-saju" class="tab-footer active">
    <div style="padding-top:25px;margin-bottom:20px;">
        <p style="color:var(--gold);font-size:13px;margin-bottom:15px;">â˜¯ ê³ ì „ ëª…ë¦¬í•™ì˜ ì •ìˆ˜(ç²¾é«“)</p>
        <p style="font-size:12px;line-height:2;color:#999;">
            <strong style="color:var(--gold);">ã€ì ì²œìˆ˜(æ»´å¤©é«“)ã€</strong> Â· 
            <strong style="color:var(--gold);">ã€ìí‰ì§„ì „(å­å¹³çœè©®)ã€</strong> Â· 
            <strong style="color:var(--gold);">ã€ê¶í†µë³´ê°(çª®é€šå¯¶é‘‘)ã€</strong><br>
            ì‚¼ëŒ€ ê³ ì „ì˜ ì •í†µ ëª…ë¦¬ ì´ë¡ ì„ í˜„ëŒ€ì ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.<br><br>
            <span style="opacity:0.8;">ë§Œì„¸ë ¥(è¬æ­²æ›†) ì •ë°€ ê³„ì‚° Â· ì ˆê¸°(ç¯€æ°£) ì‹œê°„ ë³´ì • Â· ì¡°í›„ìš©ì‹ (èª¿å€™ç”¨ç¥)</span><br>
            <span style="opacity:0.7;">ë‚©ìŒì˜¤í–‰(ç´éŸ³äº”è¡Œ) Â· ëª…ê¶(å‘½å®®) Â· íƒœì›(èƒå…ƒ) Â· ì§€ì¥ê°„(æ”¯è—å¹²)</span><br>
            <span style="opacity:0.6;">í†µê·¼íˆ¬ê°„(é€šæ ¹é€å¹²) Â· ë°©í•©(æ–¹åˆ) Â· ì•”í•©(æš—åˆ) Â· 60ê°‘ì ì¼ì£¼ë¡ </span>
        </p>
    </div>
    <p style="font-size:11px;opacity:0.5;">ğŸ”’ ì¼ì²´ì˜ ê´‘ê³  ì—†ì´ ìˆœìˆ˜í•œ í•™ë¬¸ì  íƒêµ¬(å­¸å•çš„ æ¢ç©¶)ë§Œì„ ì¶”êµ¬í•©ë‹ˆë‹¤</p>
    <p style="margin-top:10px;opacity:0.4;font-size:10px;">Â© 2026 ì‚¬ì£¼ë¡œë˜ Pro Â· å‘½ç†ç¡ç©¶æ‰€</p>
</footer>

<footer id="footer-match" class="tab-footer">
    <div style="border-top:1px solid rgba(233,30,99,0.2);padding-top:25px;margin-bottom:20px;">
        <p style="color:#e91e63;font-size:13px;margin-bottom:15px;">ğŸ’• ì²œë…„ ì¸ì—°í•™(åƒå¹´ å§»ç·£å­¸)</p>
        <p style="font-size:12px;line-height:2;color:#999;">
            <strong style="color:#e91e63;">ì²œê°„í•©(å¤©å¹²åˆ)</strong> Â· 
            <strong style="color:#e91e63;">ì§€ì§€ìœ¡í•©(åœ°æ”¯å…­åˆ)</strong> Â· 
            <strong style="color:#e91e63;">ì‚¼í•©ë°©í•©(ä¸‰åˆæ–¹åˆ)</strong><br>
            <span style="opacity:0.8;">ë‚©ìŒê¶í•©(ç´éŸ³å®®åˆ) Â· ìš©ì‹ ê¶í•©(ç”¨ç¥å®®åˆ) Â· ì•”í•©(æš—åˆ)</span><br>
            <span style="opacity:0.7;">ì²œì„ê·€ì¸(å¤©ä¹™è²´äºº) Â· ë°°ìš°ìê¶(é…å¶è€…å®®) ë¶„ì„</span><br><br>
            ë™ì–‘ ì „í†µ ê¶í•©ë²•ì˜ <strong style="color:#e91e63;">8ëŒ€ í•µì‹¬ ì›ë¦¬(å…«å¤§ æ ¸å¿ƒ åŸç†)</strong>ë¥¼ ì§‘ëŒ€ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
        </p>
    </div>
    <p style="font-size:11px;opacity:0.5;">ğŸ”’ ê´‘ê³  ì—†ëŠ” ì²­ì • ê³µê°„(æ·¸æ·¨ ç©ºé–“)</p>
    <p style="margin-top:10px;opacity:0.4;font-size:10px;">Â© 2026 ì‚¬ì£¼ë¡œë˜ Pro Â· å§»ç·£ç¡ç©¶</p>
</footer>

<script>
/* ========================================
   1. ê¸°ì´ˆ ë°ì´í„°
   ======================================== */

// ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸
const PAST_WINNERS = [
[1,4,16,23,31,41],[10,23,29,33,37,40],[9,13,21,25,32,42],[11,16,19,21,27,31],[14,27,30,31,40,42],[16,24,29,40,41,42],
[14,15,26,27,40,42],[2,9,16,25,26,40],[8,19,25,34,37,39],[2,4,16,17,36,39],[9,25,30,33,41,44],[1,7,36,37,41,42],
[2,11,21,25,39,45],[22,34,36,37,42,44],[2,6,12,19,33,44],[1,4,9,23,34,45],[6,13,27,35,40,41],[4,14,22,38,39,45],
[6,8,14,21,23,38],[3,5,15,16,44,45],[8,13,14,26,28,43],[5,17,18,23,30,33],[4,5,7,9,24,42],[1,6,11,20,31,35],
[7,16,34,37,38,43],[4,9,12,14,24,44],[2,10,12,13,23,29],[2,14,16,18,28,43],[3,6,7,8,27,35],[1,5,23,24,35,37],
[9,14,20,23,33,34],[11,16,21,22,28,42],[8,18,21,27,29,45],[1,4,7,23,28,43],[3,13,24,29,34,40],[5,6,17,22,28,31],
[3,4,14,15,22,26],[1,4,15,25,29,30],[4,6,14,16,24,40],[5,6,11,22,25,38],[12,19,24,26,38,43],[5,13,26,28,41,42],
[4,16,17,21,31,45],[2,5,6,30,31,36],[1,9,16,19,21,25],[7,8,27,30,36,43],[4,10,14,27,29,41],[10,11,25,27,28,31],
[4,9,12,30,39,43],[4,13,22,24,40,42],[3,12,17,34,36,40],[1,13,22,25,34,41],[3,6,10,13,27,42],[3,4,18,30,32,35],
[6,9,11,17,18,25],[8,10,14,28,38,40],[2,8,16,21,27,44],[4,21,23,24,39,41],[2,3,5,8,18,29],[6,12,18,32,40,43]
];
const PAST_SET = new Set(PAST_WINNERS.map(arr => [...arr].sort((a,b)=>a-b).join(',')));

// ì²œê°„(å¤©å¹²)
const STEM = [
    {c:'ç”²',k:'ê°‘',e:'wood',y:true},{c:'ä¹™',k:'ì„',e:'wood',y:false},
    {c:'ä¸™',k:'ë³‘',e:'fire',y:true},{c:'ä¸',k:'ì •',e:'fire',y:false},
    {c:'æˆŠ',k:'ë¬´',e:'earth',y:true},{c:'å·±',k:'ê¸°',e:'earth',y:false},
    {c:'åºš',k:'ê²½',e:'metal',y:true},{c:'è¾›',k:'ì‹ ',e:'metal',y:false},
    {c:'å£¬',k:'ì„',e:'water',y:true},{c:'ç™¸',k:'ê³„',e:'water',y:false}
];

// ì§€ì§€(åœ°æ”¯)
const BRANCH = [
    {c:'å­',k:'ì',e:'water',a:'ì¥',m:'rat'},{c:'ä¸‘',k:'ì¶•',e:'earth',a:'ì†Œ',m:'ox'},
    {c:'å¯…',k:'ì¸',e:'wood',a:'í˜¸ë‘ì´',m:'tiger'},{c:'å¯',k:'ë¬˜',e:'wood',a:'í† ë¼',m:'rabbit'},
    {c:'è¾°',k:'ì§„',e:'earth',a:'ìš©',m:'dragon'},{c:'å·³',k:'ì‚¬',e:'fire',a:'ë±€',m:'snake'},
    {c:'åˆ',k:'ì˜¤',e:'fire',a:'ë§',m:'horse'},{c:'æœª',k:'ë¯¸',e:'earth',a:'ì–‘',m:'goat'},
    {c:'ç”³',k:'ì‹ ',e:'metal',a:'ì›ìˆ­ì´',m:'monkey'},{c:'é…‰',k:'ìœ ',e:'metal',a:'ë‹­',m:'rooster'},
    {c:'æˆŒ',k:'ìˆ ',e:'earth',a:'ê°œ',m:'dog'},{c:'äº¥',k:'í•´',e:'water',a:'ë¼ì§€',m:'pig'}
];

// ì§€ì¥ê°„(åœ°è—å¹²) - ì •ê¸°/ì¤‘ê¸°/ì—¬ê¸° with ì¼ìˆ˜
// ê° ì§€ì§€ì— ìˆ¨ì–´ìˆëŠ” ì²œê°„ (ì •ê¸°=ë³¸ê¸°, ì¤‘ê¸°, ì—¬ê¸°)
// days: í•´ë‹¹ ê¸°ìš´ì´ ì‘ìš©í•˜ëŠ” ì¼ìˆ˜ (30ì¼ ê¸°ì¤€)
const JIJANGGAN = {
    0: [ // å­ (ì)
        {stem: 9, type: 'jung', days: 30, name: 'ç™¸(ì •ê¸°)'} // ê³„ìˆ˜ 30ì¼
    ],
    1: [ // ä¸‘ (ì¶•)
        {stem: 9, type: 'yeo', days: 9, name: 'ç™¸(ì—¬ê¸°)'},  // ê³„ìˆ˜ 9ì¼
        {stem: 7, type: 'jung', days: 3, name: 'è¾›(ì¤‘ê¸°)'}, // ì‹ ê¸ˆ 3ì¼
        {stem: 5, type: 'jung', days: 18, name: 'å·±(ì •ê¸°)'} // ê¸°í†  18ì¼
    ],
    2: [ // å¯… (ì¸)
        {stem: 4, type: 'yeo', days: 7, name: 'æˆŠ(ì—¬ê¸°)'},  // ë¬´í†  7ì¼
        {stem: 2, type: 'jung', days: 7, name: 'ä¸™(ì¤‘ê¸°)'}, // ë³‘í™” 7ì¼
        {stem: 0, type: 'jung', days: 16, name: 'ç”²(ì •ê¸°)'} // ê°‘ëª© 16ì¼
    ],
    3: [ // å¯ (ë¬˜)
        {stem: 1, type: 'jung', days: 30, name: 'ä¹™(ì •ê¸°)'} // ì„ëª© 30ì¼
    ],
    4: [ // è¾° (ì§„)
        {stem: 1, type: 'yeo', days: 9, name: 'ä¹™(ì—¬ê¸°)'},  // ì„ëª© 9ì¼
        {stem: 9, type: 'jung', days: 3, name: 'ç™¸(ì¤‘ê¸°)'}, // ê³„ìˆ˜ 3ì¼
        {stem: 4, type: 'jung', days: 18, name: 'æˆŠ(ì •ê¸°)'} // ë¬´í†  18ì¼
    ],
    5: [ // å·³ (ì‚¬)
        {stem: 4, type: 'yeo', days: 5, name: 'æˆŠ(ì—¬ê¸°)'},  // ë¬´í†  5ì¼
        {stem: 6, type: 'jung', days: 9, name: 'åºš(ì¤‘ê¸°)'}, // ê²½ê¸ˆ 9ì¼
        {stem: 2, type: 'jung', days: 16, name: 'ä¸™(ì •ê¸°)'} // ë³‘í™” 16ì¼
    ],
    6: [ // åˆ (ì˜¤)
        {stem: 5, type: 'yeo', days: 9, name: 'å·±(ì—¬ê¸°)'},  // ê¸°í†  9ì¼
        {stem: 3, type: 'jung', days: 21, name: 'ä¸(ì •ê¸°)'} // ì •í™” 21ì¼
    ],
    7: [ // æœª (ë¯¸)
        {stem: 3, type: 'yeo', days: 9, name: 'ä¸(ì—¬ê¸°)'},  // ì •í™” 9ì¼
        {stem: 1, type: 'jung', days: 3, name: 'ä¹™(ì¤‘ê¸°)'}, // ì„ëª© 3ì¼
        {stem: 5, type: 'jung', days: 18, name: 'å·±(ì •ê¸°)'} // ê¸°í†  18ì¼
    ],
    8: [ // ç”³ (ì‹ )
        {stem: 4, type: 'yeo', days: 7, name: 'æˆŠ(ì—¬ê¸°)'},  // ë¬´í†  7ì¼
        {stem: 8, type: 'jung', days: 7, name: 'å£¬(ì¤‘ê¸°)'}, // ì„ìˆ˜ 7ì¼
        {stem: 6, type: 'jung', days: 16, name: 'åºš(ì •ê¸°)'} // ê²½ê¸ˆ 16ì¼
    ],
    9: [ // é…‰ (ìœ )
        {stem: 7, type: 'jung', days: 30, name: 'è¾›(ì •ê¸°)'} // ì‹ ê¸ˆ 30ì¼
    ],
    10: [ // æˆŒ (ìˆ )
        {stem: 7, type: 'yeo', days: 9, name: 'è¾›(ì—¬ê¸°)'},  // ì‹ ê¸ˆ 9ì¼
        {stem: 3, type: 'jung', days: 3, name: 'ä¸(ì¤‘ê¸°)'}, // ì •í™” 3ì¼
        {stem: 4, type: 'jung', days: 18, name: 'æˆŠ(ì •ê¸°)'} // ë¬´í†  18ì¼
    ],
    11: [ // äº¥ (í•´)
        {stem: 0, type: 'yeo', days: 7, name: 'ç”²(ì—¬ê¸°)'},  // ê°‘ëª© 7ì¼
        {stem: 8, type: 'jung', days: 23, name: 'å£¬(ì •ê¸°)'} // ì„ìˆ˜ 23ì¼
    ]
};

// ì˜¤í–‰
const ELEMENT = {
    wood:{c:'æœ¨',k:'ëª©',n:'ë‚˜ë¬´',color:'#4CAF50',icon:'ğŸŒ³',nums:[3,8,13,18,23,28,33,38,43]},
    fire:{c:'ç«',k:'í™”',n:'ë¶ˆ',color:'#F44336',icon:'ğŸ”¥',nums:[2,7,12,17,22,27,32,37,42]},
    earth:{c:'åœŸ',k:'í† ',n:'í™',color:'#FF9800',icon:'ğŸŒ',nums:[5,10,15,20,25,30,35,40,45]},
    metal:{c:'é‡‘',k:'ê¸ˆ',n:'ì‡ ',color:'#9E9E9E',icon:'âš™ï¸',nums:[4,9,14,19,24,29,34,39,44]},
    water:{c:'æ°´',k:'ìˆ˜',n:'ë¬¼',color:'#2196F3',icon:'ğŸ’§',nums:[1,6,11,16,21,26,31,36,41]}
};
const EL_ORDER = ['wood','fire','earth','metal','water'];

// ë°©í•©(æ–¹åˆ) - ê°™ì€ ë°©í–¥ 3ì§€ì§€ê°€ ëª¨ì—¬ ê°•ë ¥í•œ ì˜¤í–‰ í˜•ì„±
const BANGHAP = [
    {branches: [2,3,4], element: 'wood', name: 'ì¸ë¬˜ì§„ ë°©í•©', dir: 'ë™ë°©ëª©êµ­(æ±æ–¹æœ¨å±€)'},   // å¯…å¯è¾°
    {branches: [5,6,7], element: 'fire', name: 'ì‚¬ì˜¤ë¯¸ ë°©í•©', dir: 'ë‚¨ë°©í™”êµ­(å—æ–¹ç«å±€)'},   // å·³åˆæœª
    {branches: [8,9,10], element: 'metal', name: 'ì‹ ìœ ìˆ  ë°©í•©', dir: 'ì„œë°©ê¸ˆêµ­(è¥¿æ–¹é‡‘å±€)'}, // ç”³é…‰æˆŒ
    {branches: [11,0,1], element: 'water', name: 'í•´ìì¶• ë°©í•©', dir: 'ë¶ë°©ìˆ˜êµ­(åŒ—æ–¹æ°´å±€)'}  // äº¥å­ä¸‘
];

// ì•”í•©(æš—åˆ) - ì§€ì¥ê°„ë¼ë¦¬ì˜ ìˆ¨ì€ í•©
const AMHAP = [
    {a: 2, b: 1, name: 'ì¸ì¶•ì•”í•©', desc: 'å¯…ì˜ ë³‘(ä¸™)ê³¼ ä¸‘ì˜ ì‹ (è¾›)ì´ ì•”í•©'},    // å¯…-ä¸‘
    {a: 3, b: 8, name: 'ë¬˜ì‹ ì•”í•©', desc: 'å¯ì˜ ì„(ä¹™)ê³¼ ç”³ì˜ ê²½(åºš)ì´ ì•”í•©'},    // å¯-ç”³
    {a: 4, b: 9, name: 'ì§„ìœ ì•”í•©', desc: 'è¾°ì˜ ì„(ä¹™)ê³¼ é…‰ì˜ ê²½(åºš)ì´ ì•”í•©'},    // è¾°-é…‰
    {a: 5, b: 8, name: 'ì‚¬ì‹ ì•”í•©', desc: 'å·³ì˜ ë³‘(ä¸™)ê³¼ ç”³ì˜ ê²½(åºš)ì´ ì•”í•©'},    // å·³-ç”³
    {a: 6, b: 1, name: 'ì˜¤ì¶•ì•”í•©', desc: 'åˆì˜ ì •(ä¸)ê³¼ ä¸‘ì˜ ê¸°(å·±)ê°€ ì•”í•©'},    // åˆ-ä¸‘
    {a: 6, b: 11, name: 'ì˜¤í•´ì•”í•©', desc: 'åˆì˜ ì •(ä¸)ê³¼ äº¥ì˜ ì„(å£¬)ì´ ì•”í•©'}    // åˆ-äº¥
];

// ë‚©ìŒì˜¤í–‰(ç´éŸ³äº”è¡Œ) - 60ê°‘ì ìŒë¥  ì˜¤í–‰
const NAPEUM = [
    {name: 'í•´ì¤‘ê¸ˆ(æµ·ä¸­é‡‘)', element: 'metal', desc: 'ë°”ë‹¤ ì†ì˜ ê¸ˆ. ê¹Šì´ ìˆ¨ê²¨ì§„ ë³´ë¬¼.'},      // ê°‘ì, ì„ì¶•
    {name: 'ë…¸ì¤‘í™”(çˆä¸­ç«)', element: 'fire', desc: 'í™”ë¡œ ì†ì˜ ë¶ˆ. ì œë ¨í•˜ëŠ” ì—´ì •.'},          // ë³‘ì¸, ì •ë¬˜
    {name: 'ëŒ€ë¦¼ëª©(å¤§æ—æœ¨)', element: 'wood', desc: 'í° ìˆ²ì˜ ë‚˜ë¬´. ìš°ëš ì†Ÿì€ ê¸°ìƒ.'},         // ë¬´ì§„, ê¸°ì‚¬
    {name: 'ë…¸ë°©í† (è·¯å‚åœŸ)', element: 'earth', desc: 'ê¸¸ê°€ì˜ í™. ì–´ë””ì„œë‚˜ ì ì‘í•˜ëŠ” ìœ ì—°í•¨.'}, // ê²½ì˜¤, ì‹ ë¯¸
    {name: 'ê²€ë´‰ê¸ˆ(åŠé‹’é‡‘)', element: 'metal', desc: 'ì¹¼ë‚ ì˜ ê¸ˆ. ë‚ ì¹´ë¡œìš´ ê²°ë‹¨ë ¥.'},          // ì„ì‹ , ê³„ìœ 
    {name: 'ì‚°ë‘í™”(å±±é ­ç«)', element: 'fire', desc: 'ì‚° ì •ìƒì˜ ë¶ˆ. ë†’ì€ ì´ìƒê³¼ ì—´ë§.'},       // ê°‘ìˆ , ì„í•´
    {name: 'ê°„í•˜ìˆ˜(æ¾—ä¸‹æ°´)', element: 'water', desc: 'ì‹œëƒ‡ë¬¼. ë§‘ê³  ìˆœìˆ˜í•œ ì§€í˜œ.'},            // ë³‘ì, ì •ì¶•
    {name: 'ì„±ë‘í† (åŸé ­åœŸ)', element: 'earth', desc: 'ì„±ë²½ì˜ í™. íŠ¼íŠ¼í•˜ê³  ì•ˆì •ì .'},          // ë¬´ì¸, ê¸°ë¬˜
    {name: 'ë°±ëê¸ˆ(ç™½è Ÿé‡‘)', element: 'metal', desc: 'ë°€ëì˜ ê¸ˆ. ì„¬ì„¸í•˜ê³  ì„¸ë ¨ëœ.'},          // ê²½ì§„, ì‹ ì‚¬
    {name: 'ì–‘ë¥˜ëª©(æ¥ŠæŸ³æœ¨)', element: 'wood', desc: 'ë²„ë“œë‚˜ë¬´. ìœ ì—°í•˜ê³  ì•„ë¦„ë‹¤ìš´.'},          // ì„ì˜¤, ê³„ë¯¸
    {name: 'ì²œìƒìˆ˜(æ³‰ä¸Šæ°´)', element: 'water', desc: 'ìƒ˜ë¬¼. ëŠì„ì—†ì´ ì†ŸëŠ” ìƒëª…ë ¥.'},          // ê°‘ì‹ , ì„ìœ 
    {name: 'ì˜¥ìƒí† (å±‹ä¸ŠåœŸ)', element: 'earth', desc: 'ì§€ë¶•ì˜ í™. ë³´í˜¸í•˜ê³  ê°ì‹¸ëŠ”.'},          // ë³‘ìˆ , ì •í•´
    {name: 'ë²½ë ¥í™”(éœ¹é‚ç«)', element: 'fire', desc: 'ë²ˆê°œë¶ˆ. ê°•ë ¬í•˜ê³  í­ë°œì ì¸.'},            // ë¬´ì, ê¸°ì¶•
    {name: 'ì†¡ë°±ëª©(æ¾æ ¢æœ¨)', element: 'wood', desc: 'ì†Œë‚˜ë¬´. ì‚¬ì‹œì‚¬ì²  í‘¸ë¥¸ ì ˆê°œ.'},           // ê²½ì¸, ì‹ ë¬˜
    {name: 'ì¥ë¥˜ìˆ˜(é•·æµæ°´)', element: 'water', desc: 'ê¸´ ê°•ë¬¼. ìœ ìœ íˆ íë¥´ëŠ”.'},              // ì„ì§„, ê³„ì‚¬
    {name: 'ì‚¬ì¤‘ê¸ˆ(ç ‚ä¸­é‡‘)', element: 'metal', desc: 'ëª¨ë˜ ì† ê¸ˆ. ìˆ¨ê²¨ì§„ ì¬ëŠ¥.'},             // ê°‘ì˜¤, ì„ë¯¸
    {name: 'ì‚°í•˜í™”(å±±ä¸‹ç«)', element: 'fire', desc: 'ì‚° ì•„ë˜ ë¶ˆ. ì ì¬ëœ ì—ë„ˆì§€.'},            // ë³‘ì‹ , ì •ìœ 
    {name: 'í‰ì§€ëª©(å¹³åœ°æœ¨)', element: 'wood', desc: 'í‰ì§€ì˜ ë‚˜ë¬´. ë„“ê²Œ í¼ì§€ëŠ”.'},             // ë¬´ìˆ , ê¸°í•´
    {name: 'ë²½ìƒí† (å£ä¸ŠåœŸ)', element: 'earth', desc: 'ë²½ì˜ í™. ì˜ˆìˆ ì  ê°ê°.'},                // ê²½ì, ì‹ ì¶•
    {name: 'ê¸ˆë°•ê¸ˆ(é‡‘ç®”é‡‘)', element: 'metal', desc: 'ê¸ˆë°•. í™”ë ¤í•˜ì§€ë§Œ ì–‡ì€.'},               // ì„ì¸, ê³„ë¬˜
    {name: 'ë³µë“±í™”(è¦†ç‡ˆç«)', element: 'fire', desc: 'ë“±ë¶ˆ. ì–´ë‘ ì„ ë°íˆëŠ” ì§€í˜œ.'},             // ê°‘ì§„, ì„ì‚¬
    {name: 'ì²œí•˜ìˆ˜(å¤©æ²³æ°´)', element: 'water', desc: 'ì€í•˜ìˆ˜. ë“œë†’ì€ ì´ìƒ.'},                 // ë³‘ì˜¤, ì •ë¯¸
    {name: 'ëŒ€ì—­í† (å¤§é©›åœŸ)', element: 'earth', desc: 'í° ì—­ì˜ í™. ì†Œí†µê³¼ êµë¥˜.'},             // ë¬´ì‹ , ê¸°ìœ 
    {name: 'ì°¨ì²œê¸ˆ(é‡µé‡§é‡‘)', element: 'metal', desc: 'ë¹„ë…€ê¸ˆ. ê³ ê·€í•˜ê³  ìš°ì•„í•œ.'},             // ê²½ìˆ , ì‹ í•´
    {name: 'ìƒìëª©(æ¡‘æŸ˜æœ¨)', element: 'wood', desc: 'ë½•ë‚˜ë¬´. ì‹¤ìš©ì ì´ê³  ìœ ìµí•œ.'},            // ì„ì, ê³„ì¶•
    {name: 'ëŒ€ê³„ìˆ˜(å¤§æºªæ°´)', element: 'water', desc: 'í° ê³„ê³¡ë¬¼. ê¹Šê³  ë„“ì€.'},                // ê°‘ì¸, ì„ë¬˜
    {name: 'ì‚¬ì¤‘í† (ç ‚ä¸­åœŸ)', element: 'earth', desc: 'ëª¨ë˜ ì† í™. ê²¬ê³ í•˜ê²Œ ë‹¤ì§€ëŠ”.'},         // ë³‘ì§„, ì •ì‚¬
    {name: 'ì²œìƒí™”(å¤©ä¸Šç«)', element: 'fire', desc: 'í•˜ëŠ˜ì˜ ë¶ˆ(íƒœì–‘). ë¹›ë‚˜ëŠ” ì¡´ì¬.'},         // ë¬´ì˜¤, ê¸°ë¯¸
    {name: 'ì„ë¥˜ëª©(çŸ³æ¦´æœ¨)', element: 'wood', desc: 'ì„ë¥˜ë‚˜ë¬´. í’ì„±í•œ ê²°ì‹¤.'},                // ê²½ì‹ , ì‹ ìœ 
    {name: 'ëŒ€í•´ìˆ˜(å¤§æµ·æ°´)', element: 'water', desc: 'í° ë°”ë‹¤. ëì—†ëŠ” í¬ìš©ë ¥.'}               // ì„ìˆ , ê³„í•´
];

// ê³„ì ˆ
const SEASON = {0:'winter',1:'winter',2:'spring',3:'spring',4:'spring',5:'summer',6:'summer',7:'summer',8:'autumn',9:'autumn',10:'autumn',11:'winter'};

// ì‹­ì‹ 
const TEN_GODS = {
    bijeon:{k:'ë¹„ê²¬',c:'æ¯”è‚©',d:'í˜•ì œ, ì¹œêµ¬, ê²½ìŸì. ìì‹ ê°ê³¼ ë…ë¦½ì‹¬ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.'},
    geupjae:{k:'ê²ì¬',c:'åŠ«è²¡',d:'ê²½ìŸ, ì†ì¬. ìŠ¹ë¶€ìš•ì´ ê°•í•˜ì§€ë§Œ ëˆ ê´€ë¦¬ ì£¼ì˜.'},
    siksin:{k:'ì‹ì‹ ',c:'é£Ÿç¥',d:'ì¬ëŠ¥, ë¨¹ê±°ë¦¬. ì°½ì˜ë ¥ê³¼ í‘œí˜„ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.'},
    sanggwan:{k:'ìƒê´€',c:'å‚·å®˜',d:'í‘œí˜„, ì°½ì‘. ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ìˆìœ¼ë‚˜ ë§ì¡°ì‹¬ í•„ìš”.'},
    pyeonjae:{k:'í¸ì¬',c:'åè²¡',d:'íš¡ì¬, íˆ¬ì. ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ì§€ë§Œ ë°”ëŒê¸° ì£¼ì˜.'},
    jeongjae:{k:'ì •ì¬',c:'æ­£è²¡',d:'ì •ë‹¹í•œ ì¬ë¬¼. ì„±ì‹¤í•˜ê³  ì €ì¶•ì„ ì˜í•©ë‹ˆë‹¤.'},
    pyeongwan:{k:'í¸ê´€',c:'åå®˜',d:'ê¶Œìœ„, ì••ë°•. ì¶”ì§„ë ¥ì´ ìˆìœ¼ë‚˜ ìŠ¤íŠ¸ë ˆìŠ¤ ì£¼ì˜.'},
    jeonggwan:{k:'ì •ê´€',c:'æ­£å®˜',d:'ëª…ì˜ˆ, ìŠ¹ì§„. í’ˆìœ„ìˆê³  ì‚¬íšŒì  ì¸ì •ì„ ë°›ìŠµë‹ˆë‹¤.'},
    pyeonin:{k:'í¸ì¸',c:'åå°',d:'í•™ë¬¸, ì˜ê°. ë…ì°½ì ì´ì§€ë§Œ ìš°ìš¸í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
    jeongin:{k:'ì •ì¸',c:'æ­£å°',d:'í•™ì—…, ë¬¸ì„œ. ì‹œí—˜ìš´ì´ ì¢‹ê³  ì–´ë¥¸ì˜ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤.'}
};

// 12ìš´ì„±
const TWELVE_STATES = [
    {k:'ì¥ìƒ',l:12,d:'ìƒˆë¡œ íƒœì–´ë‚˜ëŠ” ê¸°ìš´. ì‹œì‘ê³¼ í¬ë§ì´ ìˆìŠµë‹ˆë‹¤.'},
    {k:'ëª©ìš•',l:8,d:'ì”»ê¹€ì„ ë°›ëŠ” ì‹œê¸°. ë³€í™”ì™€ ë¶ˆì•ˆì •ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
    {k:'ê´€ëŒ€',l:10,d:'ì„±ì¥í•˜ëŠ” ê¸°ìš´. ë°œì „ê³¼ ê¸°íšŒê°€ ì˜µë‹ˆë‹¤.'},
    {k:'ê±´ë¡',l:11,d:'ì™•ì„±í•œ í™œë™ê¸°. ìµœê³ ì˜ ì—ë„ˆì§€ì™€ ì„±ì·¨ê°€ ìˆìŠµë‹ˆë‹¤.'},
    {k:'ì œì™•',l:12,d:'ì •ì ì— ì˜¤ë¥¸ ìƒíƒœ. ê¶Œë ¥ê³¼ ì§€ìœ„ê°€ ë†’ìŠµë‹ˆë‹¤.'},
    {k:'ì‡ ',l:7,d:'ë‚´ë ¤ê°€ëŠ” ê¸°ìš´. ì•ˆì •ì„ ì·¨í•˜ë©° ì§€í˜œë¥¼ ìŒ“ìŠµë‹ˆë‹¤.'},
    {k:'ë³‘',l:4,d:'ê¸°ìš´ì´ ì•½í•´ì§. ê±´ê°•ê³¼ íœ´ì‹ì— ì‹ ê²½ ì“°ì„¸ìš”.'},
    {k:'ì‚¬',l:3,d:'ëë‚˜ê°€ëŠ” ì‹œê¸°. ë§ˆë¬´ë¦¬ì™€ ì •ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.'},
    {k:'ë¬˜',l:2,d:'ìˆ¨ê²¨ì§„ ìƒíƒœ. ì¡°ìš©íˆ ë‚´ë©´ì„ ê°€ê¾¸ì„¸ìš”.'},
    {k:'ì ˆ',l:1,d:'ì™„ì „íˆ ë¹„ì›Œì§„ ìƒíƒœ. ìƒˆë¡œìš´ ì‹œì‘ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.'},
    {k:'íƒœ',l:5,d:'ì‰íƒœë˜ëŠ” ê¸°ìš´. ìƒˆ ìƒëª…ê³¼ ê°€ëŠ¥ì„±ì´ ì‹¹í‹‰ë‹ˆë‹¤.'},
    {k:'ì–‘',l:6,d:'ê¸°ë¥´ëŠ” ì‹œê¸°. ì²œì²œíˆ ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.'}
];

// ì ˆê¸° ë°ì´í„° (1950-2050)
const SOLAR_TERMS = {
    1950:[{m:2,d:4,h:16,n:52},{m:3,d:6,h:10,n:36},{m:4,d:5,h:15,n:1},{m:5,d:6,h:3,n:8},{m:6,d:6,h:7,n:18},{m:7,d:7,h:17,n:53},{m:8,d:8,h:3,n:32},{m:9,d:8,h:6,n:7},{m:10,d:8,h:21,n:43},{m:11,d:8,h:0,n:21},{m:12,d:7,h:17,n:8}],
    1960:[{m:2,d:5,h:4,n:23},{m:3,d:5,h:22,n:7},{m:4,d:5,h:2,n:30},{m:5,d:5,h:14,n:36},{m:6,d:5,h:18,n:45},{m:7,d:7,h:5,n:19},{m:8,d:7,h:14,n:58},{m:9,d:7,h:17,n:32},{m:10,d:8,h:9,n:8},{m:11,d:7,h:11,n:47},{m:12,d:7,h:4,n:33}],
    1970:[{m:2,d:4,h:16,n:46},{m:3,d:6,h:10,n:29},{m:4,d:5,h:14,n:51},{m:5,d:6,h:2,n:55},{m:6,d:6,h:7,n:2},{m:7,d:7,h:17,n:35},{m:8,d:8,h:3,n:14},{m:9,d:8,h:5,n:48},{m:10,d:8,h:21,n:23},{m:11,d:8,h:0,n:1},{m:12,d:7,h:16,n:48}],
    1980:[{m:2,d:5,h:4,n:10},{m:3,d:5,h:21,n:51},{m:4,d:5,h:2,n:10},{m:5,d:5,h:14,n:11},{m:6,d:5,h:18,n:16},{m:7,d:7,h:4,n:47},{m:8,d:7,h:14,n:26},{m:9,d:7,h:16,n:59},{m:10,d:8,h:8,n:35},{m:11,d:7,h:11,n:14},{m:12,d:7,h:4,n:0}],
    1990:[{m:2,d:4,h:15,n:14},{m:3,d:6,h:8,n:53},{m:4,d:5,h:13,n:9},{m:5,d:6,h:1,n:8},{m:6,d:6,h:5,n:12},{m:7,d:7,h:15,n:42},{m:8,d:8,h:1,n:20},{m:9,d:8,h:3,n:53},{m:10,d:8,h:19,n:28},{m:11,d:7,h:22,n:6},{m:12,d:7,h:14,n:52}],
    2000:[{m:2,d:4,h:20,n:32},{m:3,d:5,h:14,n:14},{m:4,d:4,h:18,n:32},{m:5,d:5,h:6,n:31},{m:6,d:5,h:10,n:35},{m:7,d:7,h:21,n:2},{m:8,d:7,h:6,n:39},{m:9,d:7,h:9,n:11},{m:10,d:8,h:0,n:45},{m:11,d:7,h:3,n:22},{m:12,d:7,h:20,n:7}],
    2010:[{m:2,d:4,h:7,n:42},{m:3,d:6,h:1,n:21},{m:4,d:5,h:5,n:36},{m:5,d:5,h:17,n:33},{m:6,d:5,h:21,n:37},{m:7,d:7,h:8,n:6},{m:8,d:7,h:17,n:45},{m:9,d:7,h:20,n:17},{m:10,d:8,h:11,n:51},{m:11,d:7,h:14,n:28},{m:12,d:7,h:7,n:13}],
    2020:[{m:2,d:4,h:18,n:3},{m:3,d:5,h:11,n:43},{m:4,d:4,h:16,n:0},{m:5,d:5,h:3,n:57},{m:6,d:5,h:8,n:1},{m:7,d:6,h:18,n:30},{m:8,d:7,h:4,n:8},{m:9,d:7,h:6,n:40},{m:10,d:8,h:22,n:14},{m:11,d:7,h:0,n:51},{m:12,d:7,h:17,n:36}],
    2025:[{m:2,d:3,h:23,n:10},{m:3,d:5,h:16,n:47},{m:4,d:4,h:21,n:2},{m:5,d:5,h:8,n:57},{m:6,d:5,h:13,n:0},{m:7,d:6,h:23,n:28},{m:8,d:7,h:9,n:6},{m:9,d:7,h:11,n:37},{m:10,d:8,h:3,n:11},{m:11,d:7,h:5,n:48},{m:12,d:7,h:22,n:33}],
    2026:[{m:2,d:4,h:5,n:2},{m:3,d:5,h:22,n:38},{m:4,d:5,h:2,n:52},{m:5,d:5,h:14,n:48},{m:6,d:5,h:18,n:51},{m:7,d:7,h:5,n:20},{m:8,d:7,h:14,n:58},{m:9,d:7,h:17,n:29},{m:10,d:8,h:9,n:3},{m:11,d:7,h:11,n:40},{m:12,d:7,h:4,n:25}],
    2030:[{m:2,d:4,h:16,n:38},{m:3,d:6,h:10,n:14},{m:4,d:5,h:14,n:28},{m:5,d:6,h:2,n:24},{m:6,d:6,h:6,n:28},{m:7,d:7,h:16,n:57},{m:8,d:8,h:2,n:36},{m:9,d:8,h:5,n:8},{m:10,d:8,h:20,n:42},{m:11,d:7,h:23,n:19},{m:12,d:7,h:16,n:5}]
};

// ìŒë ¥ ë°ì´í„°
const LUNAR_DATA=[0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,0x06ca0,0x0b550,0x15355,0x04da0,0x0a5d0,0x14573,0x052d0,0x0a9a8,0x0e950,0x06aa0,0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b5a0,0x195a6,0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x055c0,0x0ab60,0x096d5,0x092e0,0x0c960,0x0d954,0x0d4a0,0x0da50,0x07552,0x056a0,0x0abb7,0x025d0,0x092d0,0x0cab5,0x0a950,0x0b4a0,0x0baa4,0x0ad50,0x055d9,0x04ba0,0x0a5b0,0x15176,0x052b0,0x0a930,0x07954,0x06aa0,0x0ad50,0x05b52,0x04b60,0x0a6e6,0x0a4e0,0x0d260,0x0ea65,0x0d530,0x05aa0,0x076a3,0x096d0,0x04bd7,0x04ad0,0x0a4d0,0x1d0b6,0x0d250,0x0d520,0x0dd45,0x0b5a0,0x056d0,0x055b2,0x049b0,0x0a577,0x0a4b0,0x0aa50,0x1b255,0x06d20,0x0ada0];
const LUNAR_START = 1900;

// ê³„ì¢Œ ì •ë³´
const MY_ACCOUNT = "ì¼€ì´ë±…í¬ 100150462483 ê¹€ëŒ€ì¸";

/* ========================================
   2. ë‹¤êµ­ì–´
   ======================================== */

/* ========================================
   3. ì „ì—­ ìƒíƒœ
   ======================================== */
let GENDER = 'm';
let CALENDAR = 'solar';
let SAJU = null;
let GODS = null;
let BIRTH_YEAR = null;
let currentNumbers = [];
let history = [];

/* ========================================
   3-1. ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥
   ======================================== */
// ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™” (ì‹¤ì œ ë°°í¬ ì‹œ JavaScript í‚¤ë¡œ êµì²´ í•„ìš”)
// https://developers.kakao.com ì—ì„œ ì•± ë“±ë¡ í›„ JavaScript í‚¤ ë°œê¸‰
const KAKAO_KEY = 'YOUR_KAKAO_JAVASCRIPT_KEY'; // TODO: ì‹¤ì œ í‚¤ë¡œ êµì²´

function initKakao() {
    if (typeof Kakao !== 'undefined' && !Kakao.isInitialized()) {
        try {
            Kakao.init(KAKAO_KEY);
            console.log('Kakao SDK initialized');
        } catch(e) {
            console.log('Kakao init skipped (key not set)');
        }
    }
}

function shareKakao() {
    const shareData = {
        title: 'ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro',
        text: 'ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œë¥¼ í˜„ëŒ€ì ìœ¼ë¡œ êµ¬í˜„í•œ ì‚¬ì£¼ ë¶„ì„ ì•±\n\nâœ¨ ì „ë¬¸ê°€ ìˆ˜ì¤€ ì‚¬ì£¼íŒ”ì ë¶„ì„\nğŸ’• ê³¼í•™ì  ê¶í•© ì§„ë‹¨\nğŸ€ ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜',
        url: window.location.href
    };
    
    // 1. Web Share API ì§€ì› ì‹œ (ëª¨ë°”ì¼ ë¸Œë¼ìš°ì €)
    if (navigator.share) {
        navigator.share(shareData)
            .then(() => toast('ê³µìœ  ì™„ë£Œ! ğŸ‰'))
            .catch((err) => {
                if (err.name !== 'AbortError') {
                    copyShareLink();
                }
            });
        return;
    }
    
    // 2. ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”ëœ ê²½ìš°
    if (typeof Kakao !== 'undefined' && Kakao.isInitialized()) {
        try {
            Kakao.Share.sendDefault({
                objectType: 'feed',
                content: {
                    title: 'ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro',
                    description: getShareText(),
                    imageUrl: getShareImageUrl(),
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href
                    }
                },
                buttons: [{
                    title: 'ë‚˜ë„ ìš´ì„¸ ë³´ê¸°',
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href
                    }
                }]
            });
            return;
        } catch(e) {
            console.error('Kakao share error:', e);
        }
    }
    
    // 3. í´ë°±: ë§í¬ ë³µì‚¬
    copyShareLink();
}

function getShareText() {
    return `ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œë¥¼ í˜„ëŒ€ì ìœ¼ë¡œ êµ¬í˜„í•œ ì‚¬ì£¼ ë¶„ì„ ì•±

âœ¨ ì „ë¬¸ê°€ ìˆ˜ì¤€ ì‚¬ì£¼íŒ”ì ë¶„ì„
ğŸ’• ê³¼í•™ì  ê¶í•© ì§„ë‹¨
ğŸ€ ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜

ìš´ëª…ì˜ ë¹„ë°€ì„ í’€ì–´ë³´ì„¸ìš” ğŸ”®`;
}

function getShareImageUrl() {
    return 'https://simplesajulotto.com/share-thumbnail.png';
}

function copyShareLink() {
    const text = `ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro - ì²œë…„ ëª…ë¦¬í•™ì˜ ì§€í˜œ

âœ¨ AIê¸‰ ì •ë°€ ì‚¬ì£¼ ë¶„ì„
ğŸ’• 8ëŒ€ ì›ë¦¬ ê¶í•© ì§„ë‹¨  
ğŸ² ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ ì œì™¸ ë¡œë˜

ğŸ‘‰ ${window.location.href}`;

    navigator.clipboard.writeText(text).then(() => {
        toast('ğŸ“‹ ê³µìœ  ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }).catch(() => {
        // í´ë°±
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        toast('ğŸ“‹ ê³µìœ  ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    });
}

/* ========================================
   4. ì´ˆê¸°í™”
   ======================================== */
function init() {
    // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”
    initKakao();
    
    const cy = new Date().getFullYear();
    
    // ìƒë…„ì›”ì¼ ì…€ë ‰íŠ¸ ì´ˆê¸°í™”
    ['birth-year', 'partner-year'].forEach(id => {
        const el = document.getElementById(id);
        if (el) for (let i = cy; i >= 1940; i--) el.innerHTML += `<option value="${i}">${i}</option>`;
    });
    
    ['birth-month', 'partner-month'].forEach(id => {
        const el = document.getElementById(id);
        if (el) for (let i = 1; i <= 12; i++) el.innerHTML += `<option value="${i}">${i}</option>`;
    });
    
    ['birth-day', 'partner-day'].forEach(id => {
        const el = document.getElementById(id);
        if (el) for (let i = 1; i <= 31; i++) el.innerHTML += `<option value="${i}">${i}</option>`;
    });
    
    // ì‹œê°„ ì…€ë ‰íŠ¸
    const hourEl = document.getElementById('birth-hour');
    if (hourEl) {
        const hours = ['å­æ™‚(23:30-01:29)','ä¸‘æ™‚(01:30-03:29)','å¯…æ™‚(03:30-05:29)','å¯æ™‚(05:30-07:29)',
                       'è¾°æ™‚(07:30-09:29)','å·³æ™‚(09:30-11:29)','åˆæ™‚(11:30-13:29)','æœªæ™‚(13:30-15:29)',
                       'ç”³æ™‚(15:30-17:29)','é…‰æ™‚(17:30-19:29)','æˆŒæ™‚(19:30-21:29)','äº¥æ™‚(21:30-23:29)'];
        hours.forEach((t, i) => hourEl.innerHTML += `<option value="${i}">${t}</option>`);
        hourEl.innerHTML += `<option value="-1">ëª¨ë¦„</option>`;
    }
    
    // í†µê³„ ì—…ë°ì´íŠ¸
    // ì´ˆê¸°í™” ì™„ë£Œ
}

document.addEventListener('DOMContentLoaded', init);

/* ========================================
   5. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
   ======================================== */
function toast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
}

function getBallColor(n) {
    if (n <= 10) return 'y';
    if (n <= 20) return 'b';
    if (n <= 30) return 'r';
    if (n <= 40) return 'g';
    return 'p';
}

function createBall(n, sm = false) {
    return `<div class="ball ${sm ? 'sm' : ''} ${getBallColor(n)}">${n}</div>`;
}

function setGender(g) {
    GENDER = g;
    document.querySelectorAll('[data-gender]').forEach(b => b.classList.toggle('on', b.dataset.gender === g));
}

function setCalendar(c) {
    CALENDAR = c;
    document.querySelectorAll('[data-cal]').forEach(b => b.classList.toggle('on', b.dataset.cal === c));
}

function switchTab(name) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.top-nav button').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.tab-footer').forEach(f => f.classList.remove('active'));
    document.getElementById('tab-' + name).classList.add('active');
    document.getElementById('footer-' + name)?.classList.add('active');
    event.currentTarget.classList.add('active');
}

function showFortune(type) {
    document.querySelectorAll('#fortune-tabs .sub-tab').forEach(t => t.classList.remove('on'));
    event.currentTarget.classList.add('on');
    renderFortune(type);
}

/* ========================================
   6. ë¡œë˜ ë²ˆí˜¸ ìƒì„±
   ======================================== */
function generateLotto() {
    try {
        const container = document.getElementById('lotto-balls');
        if (!container) { toast('í™”ë©´ ì˜¤ë¥˜'); return; }
        
        const btn = event?.currentTarget;
        if (btn) {
            btn.disabled = true;
            btn.textContent = 'ğŸ² ì¶”ì²¨ ì¤‘...';
        }
        
        let counter = 0;
        const interval = setInterval(() => {
            const temp = Array.from({length: 6}, () => Math.floor(Math.random() * 45) + 1);
            container.innerHTML = temp.map(n => createBall(n)).join('');
            counter++;
            
            if (counter > 15) {
                clearInterval(interval);
                
                let nums, attempts = 0;
                do {
                    const pool = Array.from({length: 45}, (_, i) => i + 1);
                    nums = [];
                    for (let i = 0; i < 6; i++) {
                        const idx = Math.floor(Math.random() * pool.length);
                        nums.push(pool.splice(idx, 1)[0]);
                    }
                    nums.sort((a, b) => a - b);
                    attempts++;
                } while (PAST_SET.has(nums.join(',')) && attempts < 1000);
                
                currentNumbers = nums;
                container.innerHTML = nums.map(n => createBall(n)).join('');
                
                history.unshift(nums);
                if (history.length > 5) history.pop();
                
                document.getElementById('history-card').style.display = 'block';
                document.getElementById('history-list').innerHTML = history.map(h =>
                    `<div class="history-item">${h.map(n => createBall(n, true)).join('')}</div>`
                ).join('');
                
                if (btn) {
                    btn.disabled = false;
                    btn.textContent = 'ğŸ² í–‰ìš´ì˜ ë²ˆí˜¸ ìƒì„±';
                }
                
                if (SAJU) showTodayFortune();
            }
        }, 50);
    } catch (error) {
        console.error('ë¡œë˜ ìƒì„± ì˜¤ë¥˜:', error);
        toast('ë²ˆí˜¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}

function generateSajuLotto() {
    try {
        if (!GODS) { toast('ë¨¼ì € ì‚¬ì£¼ ë¶„ì„ì„ í•´ì£¼ì„¸ìš”'); return; }
        
        const container = document.getElementById('saju-lotto-balls');
        if (!container) { toast('í™”ë©´ ì˜¤ë¥˜'); return; }
        
        const yongNums = ELEMENT[GODS.yong]?.nums || [];
        const heeNums = ELEMENT[GODS.hee]?.nums || [];
        const giNums = ELEMENT[GODS.gi]?.nums || [];
        
        let weightedPool = [];
        for (let i = 1; i <= 45; i++) {
            let weight = 1;
            if (yongNums.includes(i)) weight = 3;
            else if (heeNums.includes(i)) weight = 2;
            else if (giNums.includes(i)) weight = 0.5;
            for (let j = 0; j < weight * 2; j++) weightedPool.push(i);
        }
        
        let nums = [], attempts = 0;
        do {
            const selected = new Set();
            while (selected.size < 6) {
                const idx = Math.floor(Math.random() * weightedPool.length);
                selected.add(weightedPool[idx]);
            }
            nums = [...selected].sort((a, b) => a - b);
            attempts++;
        } while (PAST_SET.has(nums.join(',')) && attempts < 1000);
        
        currentNumbers = nums;
        container.innerHTML = nums.map(n => createBall(n)).join('');
        
        const yongCount = nums.filter(n => yongNums.includes(n)).length;
        toast(`ìš©ì‹ (${ELEMENT[GODS.yong].k}) ${yongCount}ê°œ í¬í•¨!`);
    } catch (error) {
        console.error('ì‚¬ì£¼ ë¡œë˜ ìƒì„± ì˜¤ë¥˜:', error);
        toast('ë²ˆí˜¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}

/* ========================================
   7. ìŒë ¥/ì‹œì°¨ ë³´ì •
   ======================================== */
function lunarToSolar(ly, lm, ld) {
    // ê°„ì†Œí™”ëœ ìŒë ¥ ë³€í™˜ (ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ë” ì •í™•í•œ ë°ì´í„° í•„ìš”)
    return { year: ly, month: lm, day: ld };
}

function adjustTime(y, m, d, h) {
    if (h < 0) return { y, m, d, h };
    let hour = h;
    const isDST = ((y >= 1948 && y <= 1951) || (y >= 1955 && y <= 1960) || (y >= 1987 && y <= 1988));
    if (isDST) hour -= 1;
    hour = hour - 0.5; // 30ë¶„ ë³´ì •
    if (hour < 0) { hour += 12; d -= 1; }
    if (d < 1) { m -= 1; if (m < 1) { m = 12; y -= 1; } d = 28; }
    return { y, m, d, h: Math.floor(hour) };
}

/* ========================================
   8. ì‚¬ì£¼ ê³„ì‚°
   ======================================== */
function calcYearPillar(y, m, d) {
    let adjY = y;
    if (m < 2 || (m === 2 && d < 4)) adjY--;
    const si = (adjY - 4) % 10;
    const bi = (adjY - 4) % 12;
    return { s: STEM[si < 0 ? si + 10 : si], b: BRANCH[bi < 0 ? bi + 12 : bi] };
}

function calcMonthPillar(y, m, d) {
    let adjM = m;
    if (d < 5) adjM--;
    if (adjM <= 0) { adjM = 12; y--; }
    const yp = calcYearPillar(y, m, d);
    const ysi = STEM.indexOf(yp.s);
    const msi = ((ysi % 5) * 2 + adjM + 1) % 10;
    const mbi = (adjM + 1) % 12;
    return { s: STEM[msi], b: BRANCH[mbi] };
}

function calcDayPillar(y, m, d) {
    const a = Math.floor((14 - m) / 12);
    const adjY = y + 4800 - a;
    const adjM = m + 12 * a - 3;
    const jdn = d + Math.floor((153 * adjM + 2) / 5) + 365 * adjY + Math.floor(adjY / 4) - Math.floor(adjY / 100) + Math.floor(adjY / 400) - 32045;
    const baseJdn = 2415021;
    const diff = jdn - baseJdn;
    return { s: STEM[((diff % 10) + 10) % 10], b: BRANCH[((diff % 12) + 12) % 12] };
}

function calcHourPillar(dayStem, h) {
    if (h < 0) return null;
    const hbi = h;
    const dsi = STEM.indexOf(dayStem);
    const hsi = (dsi * 2 + hbi) % 10;
    return { s: STEM[hsi], b: BRANCH[hbi] };
}

/* ========================================
   9. ì§€ì¥ê°„/ì‹­ì‹ /12ìš´ì„±/ì‹ ê°•ì‹ ì•½
   ======================================== */

/* ----------------------------------------
   9-1. ì§€ì¥ê°„(åœ°è—å¹²) ì™„ì „ ë¶„ì„
   ---------------------------------------- */
function analyzeJijanggan(saju) {
    const dm = saju.day.s;
    const dmi = STEM.indexOf(dm);
    const result = { pillars: [], summary: { elements: {wood:0,fire:0,earth:0,metal:0,water:0}, gods: {}, tougans: [] } };
    
    const pillarNames = ['ë…„ì§€', 'ì›”ì§€', 'ì¼ì§€', 'ì‹œì§€'];
    const branches = [saju.year?.b, saju.month?.b, saju.day?.b, saju.hour?.b];
    const stems = [saju.year?.s, saju.month?.s, saju.day?.s, saju.hour?.s];
    
    branches.forEach((branch, pIdx) => {
        if (!branch) return;
        const bi = BRANCH.indexOf(branch);
        const jj = JIJANGGAN[bi];
        
        const pillarInfo = {
            name: pillarNames[pIdx],
            branch: branch,
            hidden: []
        };
        
        jj.forEach((h, hIdx) => {
            const hiddenStem = STEM[h.stem];
            const god = getTenGod(hiddenStem, dm);
            const isJunggi = hIdx === jj.length - 1; // ë§ˆì§€ë§‰ì´ ì •ê¸°
            
            // íˆ¬ê°„(é€å¹²) ì²´í¬ - ì§€ì¥ê°„ì´ ì²œê°„ì— ë‚˜íƒ€ë‚¬ëŠ”ì§€
            const tougan = stems.some((s, si) => s && STEM.indexOf(s) === h.stem);
            
            // í†µê·¼(é€šæ ¹) ì²´í¬ - ì²œê°„ì´ ì§€ì¥ê°„ì— ë¿Œë¦¬ë¥¼ ë‘ì—ˆëŠ”ì§€
            const tonggeun = stems.some((s, si) => {
                if (!s) return false;
                return STEM.indexOf(s) === h.stem;
            });
            
            const hiddenInfo = {
                stem: hiddenStem,
                type: isJunggi ? 'ì •ê¸°' : (hIdx === 0 ? 'ì—¬ê¸°' : 'ì¤‘ê¸°'),
                days: h.days,
                god: god,
                tougan: tougan,
                tonggeun: tonggeun,
                strength: isJunggi ? 1.0 : (hIdx === 0 ? 0.3 : 0.5) // ì •ê¸°:1.0, ì¤‘ê¸°:0.5, ì—¬ê¸°:0.3
            };
            
            pillarInfo.hidden.push(hiddenInfo);
            
            // ìš”ì•½ ì§‘ê³„
            result.summary.elements[hiddenStem.e] += hiddenInfo.strength;
            if (!result.summary.gods[god.k]) result.summary.gods[god.k] = 0;
            result.summary.gods[god.k] += hiddenInfo.strength;
            
            // íˆ¬ê°„ ê¸°ë¡
            if (tougan && !result.summary.tougans.find(t => t.stem === h.stem)) {
                result.summary.tougans.push({ 
                    stem: h.stem, 
                    name: hiddenStem.c + hiddenStem.k, 
                    from: pillarNames[pIdx],
                    god: god.k
                });
            }
        });
        
        result.pillars.push(pillarInfo);
    });
    
    return result;
}

/* ----------------------------------------
   9-2. í†µê·¼/íˆ¬ê°„ ë¶„ì„
   ---------------------------------------- */
function analyzeTonggeunTougan(saju) {
    const result = { tonggeun: [], tougan: [] };
    const dm = saju.day.s;
    const pillarNames = ['ë…„ì£¼', 'ì›”ì£¼', 'ì¼ì£¼', 'ì‹œì£¼'];
    const branches = [saju.year?.b, saju.month?.b, saju.day?.b, saju.hour?.b];
    const stems = [saju.year?.s, saju.month?.s, saju.day?.s, saju.hour?.s];
    
    // ê° ì²œê°„ì— ëŒ€í•´ í†µê·¼ ì—¬ë¶€ ì²´í¬
    stems.forEach((stem, sIdx) => {
        if (!stem) return;
        const si = STEM.indexOf(stem);
        const roots = [];
        
        branches.forEach((branch, bIdx) => {
            if (!branch) return;
            const bi = BRANCH.indexOf(branch);
            const jj = JIJANGGAN[bi];
            
            jj.forEach((h, hIdx) => {
                if (h.stem === si) {
                    const isJunggi = hIdx === jj.length - 1;
                    roots.push({
                        pillar: pillarNames[bIdx].slice(0, 1) + 'ì§€',
                        branch: branch.c,
                        type: isJunggi ? 'ì •ê¸°' : (hIdx === 0 ? 'ì—¬ê¸°' : 'ì¤‘ê¸°'),
                        strength: isJunggi ? 'ê°•' : (hIdx === 0 ? 'ì•½' : 'ì¤‘')
                    });
                }
            });
        });
        
        if (roots.length > 0) {
            result.tonggeun.push({
                pillar: pillarNames[sIdx],
                stem: stem.c + stem.k,
                god: sIdx === 2 ? 'ì¼ê°„' : getTenGod(stem, dm).k,
                roots: roots
            });
        }
    });
    
    // íˆ¬ê°„ ì²´í¬ - ì§€ì¥ê°„ì´ ì²œê°„ì— ë‚˜íƒ€ë‚¬ëŠ”ì§€
    branches.forEach((branch, bIdx) => {
        if (!branch) return;
        const bi = BRANCH.indexOf(branch);
        const jj = JIJANGGAN[bi];
        
        jj.forEach(h => {
            stems.forEach((stem, sIdx) => {
                if (!stem) return;
                if (STEM.indexOf(stem) === h.stem) {
                    const existing = result.tougan.find(t => t.stem === stem.c + stem.k);
                    if (!existing) {
                        result.tougan.push({
                            stem: stem.c + stem.k,
                            pillar: pillarNames[sIdx],
                            from: pillarNames[bIdx].slice(0, 1) + 'ì§€',
                            god: sIdx === 2 ? 'ì¼ê°„' : getTenGod(stem, dm).k
                        });
                    }
                }
            });
        });
    });
    
    return result;
}

/* ----------------------------------------
   9-3. ì‹­ì‹  ìƒì„¸ ë¶„ì„
   ---------------------------------------- */
function getTenGod(stem, dayStem) {
    const dEl = EL_ORDER.indexOf(dayStem.e);
    const sEl = EL_ORDER.indexOf(stem.e);
    const diff = (sEl - dEl + 5) % 5;
    const samePol = (dayStem.y === stem.y);
    const godKeys = ['bijeon','geupjae','siksin','sanggwan','pyeonjae','jeongjae','pyeongwan','jeonggwan','pyeonin','jeongin'];
    const godMap = { 0: samePol ? 0 : 1, 1: samePol ? 2 : 3, 2: samePol ? 4 : 5, 3: samePol ? 6 : 7, 4: samePol ? 8 : 9 };
    return TEN_GODS[godKeys[godMap[diff]]];
}

function getTwelveState(dayStem, branch) {
    const starts = [11, 6, 2, 9, 2, 9, 5, 0, 8, 3];
    const dsi = STEM.indexOf(dayStem);
    const bi = BRANCH.indexOf(branch);
    const start = starts[dsi];
    const dir = dayStem.y ? 1 : -1;
    return TWELVE_STATES[(start + dir * bi + 120) % 12];
}

/* ========================================
   ë‚©ìŒì˜¤í–‰(ç´éŸ³äº”è¡Œ) ê³„ì‚°
   ======================================== */
function calcNapeum(stem, branch) {
    const si = STEM.indexOf(stem);
    const bi = BRANCH.indexOf(branch);
    // 60ê°‘ì ìˆœì„œ ê³„ì‚°
    const idx = (si * 6 + Math.floor(bi / 2)) % 30;
    const napeum = NAPEUM[idx];
    return {
        name: napeum.name,
        element: napeum.element,
        elementK: ELEMENT[napeum.element].k,
        desc: napeum.desc
    };
}

/* ========================================
   ëª…ê¶(å‘½å®®) ê³„ì‚°
   ======================================== */
function calcMyunggung(monthBranch, hourBranch) {
    // ëª…ê¶ = (14 - ì›”ì§€ - ì‹œì§€) % 12
    const mbi = BRANCH.indexOf(monthBranch);
    const hbi = BRANCH.indexOf(hourBranch);
    const mgIdx = (14 - mbi - hbi + 24) % 12;
    const mgBranch = BRANCH[mgIdx];
    
    // ëª…ê¶ í•´ì„
    const mgDesc = {
        0: {name: 'ìê¶(å­å®®)', trait: 'ì§€í˜œë¡­ê³  ì¹¨ì°©í•¨. ë¹„ë°€ì´ ë§ê³  ë°¤ì— í™œë™ì .', career: 'ì—°êµ¬, ì² í•™, ì•¼ê°„ì—…ì¢…'},
        1: {name: 'ì¶•ê¶(ä¸‘å®®)', trait: 'ì„±ì‹¤í•˜ê³  ëˆê¸° ìˆìŒ. ì¬ë¬¼ì„ ëª¨ìœ¼ëŠ” ì¬ì£¼.', career: 'ê¸ˆìœµ, ë¶€ë™ì‚°, ë†ì—…'},
        2: {name: 'ì¸ê¶(å¯…å®®)', trait: 'ì•¼ì‹¬ì°¨ê³  ìš©ê°í•¨. ë¦¬ë”ì‹­ì´ ê°•í•¨.', career: 'êµ°ì¸, ì •ì¹˜, ìŠ¤í¬ì¸ '},
        3: {name: 'ë¬˜ê¶(å¯å®®)', trait: 'ì˜¨í™”í•˜ê³  ì˜ˆìˆ ì . ì¸ê¸°ê°€ ë§ìŒ.', career: 'ì˜ˆìˆ , ë””ìì¸, ì„œë¹„ìŠ¤'},
        4: {name: 'ì§„ê¶(è¾°å®®)', trait: 'ë³€í™”ë¬´ìŒí•˜ê³  ì‹ ë¹„ë¡œì›€. í° ê¿ˆì„ ê°€ì§.', career: 'ì¢…êµ, ì² í•™, ì°½ì—…'},
        5: {name: 'ì‚¬ê¶(å·³å®®)', trait: 'ì§€í˜œë¡­ê³  ì‹ ì¤‘í•¨. ë¹„ë°€ì„ ì˜ ì§€í‚´.', career: 'ë²•ë¥ , ì˜ë£Œ, ìƒë‹´'},
        6: {name: 'ì˜¤ê¶(åˆå®®)', trait: 'ì—´ì •ì ì´ê³  ì ê·¹ì . ëª…ì˜ˆë¥¼ ì¤‘ì‹œ.', career: 'ì •ì¹˜, ì—°ì˜ˆ, êµìœ¡'},
        7: {name: 'ë¯¸ê¶(æœªå®®)', trait: 'ë¶€ë“œëŸ½ê³  ì˜ˆìˆ ì . ë´‰ì‚¬ì •ì‹ ì´ ê°•í•¨.', career: 'ì˜ˆìˆ , ì¢…êµ, ì˜ë£Œ'},
        8: {name: 'ì‹ ê¶(ç”³å®®)', trait: 'ì˜ë¦¬í•˜ê³  ì¬ì¹˜ ìˆìŒ. ë§ì†œì”¨ê°€ ì¢‹ìŒ.', career: 'ì˜ì—…, ì™¸êµ, IT'},
        9: {name: 'ìœ ê¶(é…‰å®®)', trait: 'ì„¬ì„¸í•˜ê³  ì™„ë²½ì£¼ì˜. ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚¨.', career: 'ê¸ˆìœµ, ë³´ì„, ë¯¸ìš©'},
        10: {name: 'ìˆ ê¶(æˆŒå®®)', trait: 'ì˜ë¦¬ ìˆê³  ì¶©ì§í•¨. ì±…ì„ê°ì´ ê°•í•¨.', career: 'êµ°ì¸, ê²½ì°°, ë³´ì•ˆ'},
        11: {name: 'í•´ê¶(äº¥å®®)', trait: 'ë‚™ì²œì ì´ê³  ëŒ€ì¸ê´€ê³„ ì¢‹ìŒ. ë³µì´ ë§ìŒ.', career: 'ë¬´ì—­, ì—¬í–‰, ìœ í†µ'}
    };
    
    return {
        branch: mgBranch,
        index: mgIdx,
        ...mgDesc[mgIdx]
    };
}

/* ========================================
   íƒœì›(èƒå…ƒ) ê³„ì‚°
   ======================================== */
function calcTaewon(yearStem, monthStem, monthBranch) {
    // íƒœì› = ì›”ê°„ +1, ì›”ì§€ +3
    const msi = STEM.indexOf(monthStem);
    const mbi = BRANCH.indexOf(monthBranch);
    
    const tStem = STEM[(msi + 1) % 10];
    const tBranch = BRANCH[(mbi + 3) % 12];
    
    // íƒœì›ì´ ì‚¬ì£¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥
    const napeum = calcNapeum(tStem, tBranch);
    
    return {
        stem: tStem,
        branch: tBranch,
        pillar: tStem.c + tBranch.c,
        napeum: napeum,
        desc: `ì‰íƒœ ì‹œì ì˜ ê¸°ìš´. ${napeum.name}(${napeum.elementK})ì˜ ê¸°ìš´ìœ¼ë¡œ íƒœì–´ë‚¨.`
    };
}

/* ========================================
   ë°©í•©(æ–¹åˆ) ë¶„ì„
   ======================================== */
function analyzeBanghap(saju) {
    const branches = [];
    if (saju.year) branches.push(BRANCH.indexOf(saju.year.b));
    if (saju.month) branches.push(BRANCH.indexOf(saju.month.b));
    if (saju.day) branches.push(BRANCH.indexOf(saju.day.b));
    if (saju.hour) branches.push(BRANCH.indexOf(saju.hour.b));
    
    const results = [];
    
    for (const bh of BANGHAP) {
        const has = bh.branches.map(b => branches.includes(b));
        const count = has.filter(x => x).length;
        
        if (count === 3) {
            // ì™„ì „ ë°©í•©
            results.push({
                type: 'complete',
                name: bh.name,
                dir: bh.dir,
                element: bh.element,
                elementK: ELEMENT[bh.element].k,
                branches: bh.branches.map(b => BRANCH[b].c).join(''),
                power: 'ê°•ë ¥',
                desc: `${bh.dir} ì™„ì„±! ${ELEMENT[bh.element].k} ê¸°ìš´ì´ ë§¤ìš° ê°•í•´ì§‘ë‹ˆë‹¤.`
            });
        } else if (count === 2) {
            // 2ê°œ ë°©í•© (íšŒêµ­ ê°€ëŠ¥ì„±)
            const missing = bh.branches.find((b, i) => !has[i]);
            results.push({
                type: 'partial',
                name: bh.name + ' ë¯¸ì™„',
                dir: bh.dir,
                element: bh.element,
                elementK: ELEMENT[bh.element].k,
                branches: bh.branches.filter((b, i) => has[i]).map(b => BRANCH[b].c).join(''),
                missing: BRANCH[missing].c,
                power: 'ì¤‘ê°„',
                desc: `${BRANCH[missing].c}ê°€ ì˜¤ë©´ ${bh.dir}ì´ ì™„ì„±ë©ë‹ˆë‹¤.`
            });
        }
    }
    
    return results;
}

/* ========================================
   ì•”í•©(æš—åˆ) ë¶„ì„
   ======================================== */
function analyzeAmhap(saju) {
    const branches = [];
    const pillars = ['ë…„ì§€', 'ì›”ì§€', 'ì¼ì§€', 'ì‹œì§€'];
    
    if (saju.year) branches.push({idx: BRANCH.indexOf(saju.year.b), name: 'ë…„ì§€', c: saju.year.b.c});
    if (saju.month) branches.push({idx: BRANCH.indexOf(saju.month.b), name: 'ì›”ì§€', c: saju.month.b.c});
    if (saju.day) branches.push({idx: BRANCH.indexOf(saju.day.b), name: 'ì¼ì§€', c: saju.day.b.c});
    if (saju.hour) branches.push({idx: BRANCH.indexOf(saju.hour.b), name: 'ì‹œì§€', c: saju.hour.b.c});
    
    const results = [];
    
    for (let i = 0; i < branches.length; i++) {
        for (let j = i + 1; j < branches.length; j++) {
            for (const ah of AMHAP) {
                if ((branches[i].idx === ah.a && branches[j].idx === ah.b) ||
                    (branches[i].idx === ah.b && branches[j].idx === ah.a)) {
                    results.push({
                        name: ah.name,
                        positions: `${branches[i].name}(${branches[i].c})â†”${branches[j].name}(${branches[j].c})`,
                        desc: ah.desc,
                        meaning: 'ê²‰ìœ¼ë¡œëŠ” ì•ˆ ë“œëŸ¬ë‚˜ì§€ë§Œ ì†ìœ¼ë¡œ í†µí•˜ëŠ” ê´€ê³„. ìˆ¨ê²¨ì§„ ì¸ì—°, ë¹„ë°€ìŠ¤ëŸ¬ìš´ ê´€ê³„ë¥¼ ì˜ë¯¸.'
                    });
                }
            }
        }
    }
    
    return results;
}

/* ========================================
   ê³µë§ í•´ì†Œ ë¶„ì„
   ======================================== */
function analyzeGongmangHaeso(saju, gongmang) {
    if (!gongmang || !gongmang.affected || gongmang.affected.length === 0) {
        return { hasGongmang: false, results: [] };
    }
    
    const branches = [];
    if (saju.year) branches.push(BRANCH.indexOf(saju.year.b));
    if (saju.month) branches.push(BRANCH.indexOf(saju.month.b));
    if (saju.day) branches.push(BRANCH.indexOf(saju.day.b));
    if (saju.hour) branches.push(BRANCH.indexOf(saju.hour.b));
    
    const results = [];
    
    for (const affected of gongmang.affected) {
        // ê³µë§ ì§€ì§€ ì°¾ê¸°
        const gmBranchIdx = BRANCH.findIndex(b => affected.includes(b.k) || affected.includes(b.c));
        if (gmBranchIdx === -1) continue;
        
        let resolved = false;
        let resolveMethod = '';
        
        // ì¶©ìœ¼ë¡œ í•´ì†Œ ì²´í¬
        const chungPair = (gmBranchIdx + 6) % 12;
        if (branches.includes(chungPair)) {
            resolved = true;
            resolveMethod = `${BRANCH[chungPair].c}(ì¶©)ìœ¼ë¡œ ê³µë§ í•´ì†Œ`;
        }
        
        // ì‚¼í•©ìœ¼ë¡œ í•´ì†Œ ì²´í¬
        const samhapSets = [[0,4,8], [1,5,9], [2,6,10], [3,7,11]];
        for (const set of samhapSets) {
            if (set.includes(gmBranchIdx)) {
                const others = set.filter(s => s !== gmBranchIdx);
                if (others.every(o => branches.includes(o))) {
                    resolved = true;
                    resolveMethod = `ì‚¼í•©(${set.map(s => BRANCH[s].c).join('')})ìœ¼ë¡œ ê³µë§ í•´ì†Œ`;
                }
            }
        }
        
        results.push({
            position: affected,
            branch: BRANCH[gmBranchIdx].c,
            resolved: resolved,
            method: resolveMethod,
            effect: resolved ? 
                'ê³µë§ì´ í•´ì†Œë˜ì–´ í•´ë‹¹ ê¸°ìš´ì´ ì œ ì—­í• ì„ í•©ë‹ˆë‹¤.' : 
                'ê³µë§ì´ í•´ì†Œë˜ì§€ ì•Šì•„ í•´ë‹¹ ê¸°ìš´ì´ ì•½í•©ë‹ˆë‹¤. ì„¸ìš´ì´ë‚˜ ëŒ€ìš´ì—ì„œ í•´ì†Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
        });
    }
    
    return { hasGongmang: true, results };
}

/* ========================================
   ì‹ ì‚´ ìœ„ì¹˜ë³„ í•´ì„
   ======================================== */
function analyzeSinsalPosition(saju) {
    const results = [];
    const positions = [
        {name: 'ë…„ì§€', b: saju.year?.b, meaning: 'ì¡°ìƒ, ì‚¬íšŒ', age: 'ìœ ë…„ê¸°(0-15ì„¸)'},
        {name: 'ì›”ì§€', b: saju.month?.b, meaning: 'ë¶€ëª¨, í˜•ì œ', age: 'ì²­ë…„ê¸°(15-30ì„¸)'},
        {name: 'ì¼ì§€', b: saju.day?.b, meaning: 'ë°°ìš°ì, ë³¸ì¸', age: 'ì¤‘ë…„ê¸°(30-45ì„¸)'},
        {name: 'ì‹œì§€', b: saju.hour?.b, meaning: 'ìë…€, ë§ë…„', age: 'ë§ë…„ê¸°(45ì„¸ ì´í›„)'}
    ];
    
    const ybi = BRANCH.indexOf(saju.year?.b);
    
    // ë„í™”ì‚´ ìœ„ì¹˜ ë¶„ì„
    const taohua = {0:9,1:6,2:3,3:0,4:9,5:6,6:3,7:0,8:9,9:6,10:3,11:0};
    for (const pos of positions) {
        if (!pos.b) continue;
        const bi = BRANCH.indexOf(pos.b);
        if (bi === taohua[ybi]) {
            results.push({
                sinsal: 'ë„í™”ì‚´(æ¡ƒèŠ±æ®º)',
                position: pos.name,
                interpretation: pos.name === 'ë…„ì§€' ? 'ì–´ë¦´ ë•Œë¶€í„° ì¸ê¸°ê°€ ë§ìŒ. ì´ë¥¸ ì—°ì•  ê°€ëŠ¥ì„±.' :
                               pos.name === 'ì›”ì§€' ? 'í•™ì°½ì‹œì ˆ ì¸ê¸° ë§ìŒ. ì—°ì˜ˆì¸ ê¸°ì§ˆ.' :
                               pos.name === 'ì¼ì§€' ? 'ë°°ìš°ìê°€ ë§¤ë ¥ì . ë³¸ì¸ë„ ë§¤ë ¥ì´ ë„˜ì¹¨.' :
                               'ìë…€ê°€ ì˜ˆì˜ê±°ë‚˜ ì¸ê¸° ë§ìŒ. ë§ë…„ì—ë„ ì¸ê¸°.',
                advice: pos.name === 'ì¼ì§€' ? 'ë°°ìš°ìì™€ì˜ ê´€ê³„ì—ì„œ ë°”ëŒê¸° ì¡°ì‹¬' : 'ë§¤ë ¥ì„ ì¥ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”'
            });
        }
    }
    
    // ì—­ë§ˆì‚´ ìœ„ì¹˜ ë¶„ì„
    const yima = {0:2,1:11,2:8,3:5,4:2,5:11,6:8,7:5,8:2,9:11,10:8,11:5};
    for (const pos of positions) {
        if (!pos.b) continue;
        const bi = BRANCH.indexOf(pos.b);
        if (bi === yima[ybi]) {
            results.push({
                sinsal: 'ì—­ë§ˆì‚´(é©›é¦¬æ®º)',
                position: pos.name,
                interpretation: pos.name === 'ë…„ì§€' ? 'ì¡°ìƒì´ ì´ì‚¬ê°€ ë§ì•˜ê±°ë‚˜ íƒ€í–¥ì‚´ì´.' :
                               pos.name === 'ì›”ì§€' ? 'ì–´ë¦° ì‹œì ˆ ì´ì‚¬ê°€ ë§ìŒ. í•´ì™¸ ìœ í•™ ê°€ëŠ¥.' :
                               pos.name === 'ì¼ì§€' ? 'ì§ì—…ìƒ ì¶œì¥/ì´ë™ì´ ë§ìŒ. ë°°ìš°ìê°€ ë°”ìœ ì‚¬ëŒ.' :
                               'ë§ë…„ì—ë„ í™œë™ì . ìë…€ê°€ ë©€ë¦¬ ê°.',
                advice: 'ê°€ë§Œíˆ ìˆìœ¼ë©´ ì•ˆ ì¢‹ìŒ. í™œë°œíˆ ì›€ì§ì´ì„¸ìš”!'
            });
        }
    }
    
    // í™”ê°œì‚´ ìœ„ì¹˜ ë¶„ì„
    const huagai = {0:4,1:1,2:10,3:7,4:4,5:1,6:10,7:7,8:4,9:1,10:10,11:7};
    for (const pos of positions) {
        if (!pos.b) continue;
        const bi = BRANCH.indexOf(pos.b);
        if (bi === huagai[ybi]) {
            results.push({
                sinsal: 'í™”ê°œì‚´(è¯è“‹æ®º)',
                position: pos.name,
                interpretation: pos.name === 'ë…„ì§€' ? 'ì¡°ìƒ ì¤‘ ì˜ˆìˆ ê°€ë‚˜ ì¢…êµì¸ì´ ìˆìŒ.' :
                               pos.name === 'ì›”ì§€' ? 'í•™ì°½ì‹œì ˆ ì™¸ë¡œì›€. ì˜ˆìˆ /ì² í•™ì— ê´€ì‹¬.' :
                               pos.name === 'ì¼ì§€' ? 'ë°°ìš°ìê°€ ì˜ˆìˆ ì ì´ê±°ë‚˜ ì¢…êµì . ì •ì‹ ì„¸ê³„ ì¤‘ì‹œ.' :
                               'ë§ë…„ì— ì¢…êµ/ì² í•™ì— ë¹ ì§. ê³ ë…í•  ìˆ˜ ìˆìŒ.',
                advice: 'ì˜ˆìˆ , ì¢…êµ, í•™ë¬¸ ë“± ì •ì‹ ì  í™œë™ì—ì„œ ìœ„ì•ˆì„ ì°¾ìœ¼ì„¸ìš”'
            });
        }
    }
    
    return results;
}

/* ========================================
   ëŒ€ìš´ êµìš´ê¸° ë¶„ì„
   ======================================== */
function analyzeGyoungi(luck, birthYear, currentYear) {
    const age = currentYear - birthYear + 1;
    const results = [];
    
    for (let i = 0; i < luck.length - 1; i++) {
        const curr = luck[i];
        const next = luck[i + 1];
        
        // êµìš´ê¸° ì‹œì  (ëŒ€ìš´ì´ ë°”ë€Œê¸° 1ë…„ ì „ë¶€í„° 1ë…„ í›„)
        const transitionAge = next.startAge;
        const transitionYear = birthYear + transitionAge - 1;
        
        // í˜„ì¬ ë‚˜ì´ê°€ êµìš´ê¸° ê·¼ì²˜ì¸ì§€ ì²´í¬ (Â±2ë…„)
        if (Math.abs(age - transitionAge) <= 2) {
            // ì²œê°„ ë³€í™”
            const stemChange = `${curr.s.c}â†’${next.s.c}`;
            const branchChange = `${curr.b.c}â†’${next.b.c}`;
            
            // ì˜¤í–‰ ë³€í™”
            const fromEl = ELEMENT[curr.s.e].k + ELEMENT[curr.b.e].k;
            const toEl = ELEMENT[next.s.e].k + ELEMENT[next.b.e].k;
            
            // ê¸‰ê²©í•œ ë³€í™”ì¸ì§€ ì²´í¬
            let intensity = 'normal';
            let warning = '';
            
            // ì˜¤í–‰ì´ ìƒê·¹ìœ¼ë¡œ ë³€í•˜ë©´ ê¸‰ê²©í•œ ë³€í™”
            const elIdx1 = EL_ORDER.indexOf(curr.s.e);
            const elIdx2 = EL_ORDER.indexOf(next.s.e);
            if (Math.abs(elIdx1 - elIdx2) === 2 || Math.abs(elIdx1 - elIdx2) === 3) {
                intensity = 'strong';
                warning = 'ì˜¤í–‰ì´ í¬ê²Œ ë°”ë€ŒëŠ” ì‹œê¸°. ìƒí™œ ì „ë°˜ì— ë³€í™”ê°€ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            }
            
            // ì¢‹ì€ ìš´ì—ì„œ ë‚˜ìœ ìš´ìœ¼ë¡œ, ë˜ëŠ” ë°˜ëŒ€
            if (curr.rating !== next.rating) {
                intensity = 'strong';
                if (curr.rating === 'good' && next.rating === 'bad') {
                    warning += ' ì¢‹ì€ ìš´ì—ì„œ ì–´ë ¤ìš´ ìš´ìœ¼ë¡œ ë°”ë€ë‹ˆë‹¤. ë¯¸ë¦¬ ëŒ€ë¹„í•˜ì„¸ìš”.';
                } else if (curr.rating === 'bad' && next.rating === 'good') {
                    warning += ' ì–´ë ¤ìš´ ìš´ì´ ëë‚˜ê³  ì¢‹ì€ ìš´ì´ ì˜µë‹ˆë‹¤. í¬ë§ì„ ê°€ì§€ì„¸ìš”!';
                }
            }
            
            results.push({
                transitionAge: transitionAge,
                transitionYear: transitionYear,
                from: `${curr.s.c}${curr.b.c} (${fromEl})`,
                to: `${next.s.c}${next.b.c} (${toEl})`,
                stemChange: stemChange,
                branchChange: branchChange,
                intensity: intensity,
                warning: warning || 'ëŒ€ìš´ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì „í™˜ë©ë‹ˆë‹¤.',
                advice: intensity === 'strong' ? 
                    'ì´ ì‹œê¸°ëŠ” ì¸ìƒì˜ ì¤‘ìš”í•œ ì „í™˜ì ì…ë‹ˆë‹¤. í° ê²°ì •ì€ ì‹ ì¤‘í•˜ê²Œ!' :
                    'ë³€í™”ì— ìì—°ìŠ¤ëŸ½ê²Œ ì ì‘í•˜ë©´ ë©ë‹ˆë‹¤.',
                isCurrent: Math.abs(age - transitionAge) <= 1
            });
        }
    }
    
    return results;
}

function calcStrength(saju) {
    const dm = saju.day.s;
    const dme = dm.e;
    const season = SEASON[BRANCH.indexOf(saju.month.b)];
    let score = 0;
    const factors = [];
    
    // ì˜¤í–‰ ê´€ê³„ ê³„ì‚°
    const myEls = [dme, EL_ORDER[(EL_ORDER.indexOf(dme) + 4) % 5]]; // ë¹„ê² + ì¸ì„±
    const jaes = [EL_ORDER[(EL_ORDER.indexOf(dme) + 2) % 5]]; // ì¬ì„±
    const gwans = [EL_ORDER[(EL_ORDER.indexOf(dme) + 3) % 5]]; // ê´€ì‚´
    
    // 1. ì›”ë ¹ë“ë ¹ (ê°€ì¥ ì¤‘ìš”, 40%)
    const seasonScore = { spring:{wood:3,fire:2,earth:0,metal:-1,water:-2}, summer:{fire:3,earth:2,metal:0,water:-1,wood:-2}, autumn:{metal:3,water:2,wood:0,fire:-1,earth:-2}, winter:{water:3,wood:2,fire:0,earth:-1,metal:-2} };
    const ms = seasonScore[season][dme];
    const deukRyung = ms >= 2;
    score += ms * 4;
    factors.push({ l: 'ì›”ë ¹ë“ë ¹', v: deukRyung ? `ë“ë ¹(+${ms*4})` : `ì‹¤ë ¹(${ms*4})`, p: deukRyung });
    
    // 2. ì§€ì§€ í†µê·¼ (ë¿Œë¦¬, 30%) - ì§€ì¥ê°„ ì •ê¸°/ì¤‘ê¸°/ì—¬ê¸° êµ¬ë¶„
    let roots = 0;
    const allBr = [saju.year.b, saju.month.b, saju.day.b, saju.hour?.b].filter(b => b);
    const jijanggan = {0:[9],1:[9,7,5],2:[0,2,4],3:[1],4:[4,1,9],5:[2,4,6],6:[3,5],7:[5,3,1],8:[6,8,4],9:[7],10:[4,7,3],11:[8,0]};
    allBr.forEach(b => {
        const bi = BRANCH.indexOf(b);
        if (myEls.includes(b.e)) roots += 1.5; // ë³¸ê¸°ê°€ ë¹„ê²/ì¸ì„±
        const hidden = jijanggan[bi] || [];
        hidden.forEach((hi, idx) => {
            const hEl = STEM[hi].e;
            if (myEls.includes(hEl)) roots += (idx === 0 ? 0.5 : 0.3); // ì •ê¸° > ì¤‘ê¸° > ì—¬ê¸°
        });
    });
    const rootStrong = roots >= 3;
    score += Math.min(roots * 1.5, 8);
    factors.push({ l: 'ì§€ì§€í†µê·¼', v: rootStrong ? `ê°•(${roots.toFixed(1)})` : `ì•½(${roots.toFixed(1)})`, p: rootStrong });
    
    // 3. ì²œê°„ íˆ¬ì¶œ - ë¹„ê²/ì¸ì„± vs ê´€ì‚´/ì¬ì„±
    let helps = 0, attacks = 0;
    const allSt = [saju.year.s, saju.month.s, saju.hour?.s].filter(s => s);
    allSt.forEach(st => {
        if (myEls.includes(st.e)) helps++;
        if (gwans.includes(st.e)) attacks += 1.5;
        if (jaes.includes(st.e)) attacks += 0.5;
    });
    score += helps * 2;
    score -= attacks;
    if (helps >= 1) factors.push({ l: 'ì²œê°„íˆ¬ì¶œ', v: `ë¹„ê²ì¸ì„± ${helps}ê°œ`, p: true });
    
    // 4. ê´€ì‚´ ì••ë°•
    let gwanCount = 0;
    [...allSt, ...allBr].forEach(p => { if (gwans.includes(p.e)) gwanCount++; });
    if (gwanCount >= 2) { score -= 2; factors.push({ l: 'ê´€ì‚´ì••ë°•', v: `${gwanCount}ê°œ (ì‹ ì•½â†“)`, p: false }); }
    
    // 5. ì¬ì„± ê³¼ë‹¤
    let jaeCount = 0;
    [...allSt, ...allBr].forEach(p => { if (jaes.includes(p.e)) jaeCount++; });
    if (jaeCount >= 3) { score -= 2; factors.push({ l: 'ì¬ì„±ê³¼ë‹¤', v: `${jaeCount}ê°œ (ì‹ ì•½â†“)`, p: false }); }
    
    // 6. ì¼ì§€ 12ìš´ì„±
    const ds = getTwelveState(dm, saju.day.b);
    const dsScore = ds.l >= 8 ? 3 : ds.l >= 6 ? 1 : ds.l >= 4 ? 0 : ds.l >= 2 ? -1 : -2;
    score += dsScore;
    factors.push({ l: 'ì¼ì§€12ìš´', v: `${ds.k}(${dsScore >= 0 ? '+' : ''}${dsScore})`, p: ds.l >= 6 });
    
    // 7. ë¹„ê² ê°œìˆ˜
    let biCount = 0;
    [...allSt, ...allBr].forEach(p => { if (p.e === dme) biCount++; });
    if (biCount >= 3) { score += 2; factors.push({ l: 'ë¹„ê²ë‹¤ìˆ˜', v: `${biCount}ê°œ (ì‹ ê°•â†‘)`, p: true }); }
    
    // 8. ì¸ì„± ê°œìˆ˜
    const inEl = EL_ORDER[(EL_ORDER.indexOf(dme) + 4) % 5];
    let inCount = 0;
    [...allSt, ...allBr].forEach(p => { if (p.e === inEl) inCount++; });
    if (inCount >= 2) { score += 1.5; factors.push({ l: 'ì¸ì„±ìƒë¶€', v: `${inCount}ê°œ (ì‹ ê°•â†‘)`, p: true }); }
    
    // ê·¹ì‹ ê°•/ê·¹ì‹ ì•½ íŒì •
    let type = 'balanced';
    let extreme = null;
    if (score >= 15) { type = 'strong'; extreme = 'ê·¹ì‹ ê°•'; }
    else if (score >= 8) type = 'strong';
    else if (score >= 3) type = 'balanced';
    else if (score <= -5) { type = 'weak'; extreme = 'ê·¹ì‹ ì•½'; }
    else if (score <= 2) type = 'weak';
    
    return { type, score: Math.round(score * 10) / 10, pct: Math.min(100, Math.max(0, (score + 5) * 4)), factors, extreme };
}

/* ========================================
   9-4. ì¡°í›„(èª¿å€™) ê³ ê¸‰ ì ìš©
   ======================================== */

// ì›”ë³„ ì¡°í›„ìš©ì‹ í‘œ - ì¼ê°„ë³„ ê° ì›”ì˜ ì¡°í›„ìš©ì‹ 
const JOHU_TABLE = {
    // ç”²æœ¨ (ê°‘ëª©)
    0: {
        0: {yong:'fire', sub:'wood', desc:'ê²¨ìš¸ ê°‘ëª©ì€ ì–¼ì–´ìˆì–´ ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},  // ìì›”
        1: {yong:'fire', sub:'wood', desc:'ì¶•ì›” í† ì™•ì ˆ, ç«ë¡œ í•œê¸° ì œê±°'},
        2: {yong:'water', sub:'fire', desc:'ì¸ì›” ë´„ê¸°ìš´ ì‹œì‘, æ°´ë¡œ ë¿Œë¦¬ ì–‘ë¶„'},
        3: {yong:'water', sub:'fire', desc:'ë¬˜ì›” ëª©ì™•, æ°´ë¡œ ìœ¤íƒí•˜ê²Œ'},
        4: {yong:'water', sub:'metal', desc:'ì§„ì›” í† ê¸° ê°•í•´ æ°´ë¡œ ì¡°ì ˆ'},
        5: {yong:'water', sub:'metal', desc:'ì‚¬ì›” ì—¬ë¦„ ì‹œì‘, æ°´ë¡œ ê±´ì¡° ë°©ì§€'},
        6: {yong:'water', sub:'metal', desc:'ì˜¤ì›” í™”ì™•, æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'metal', desc:'ë¯¸ì›” í† ì™•ì ˆ, æ°´ë¡œ ì¡°ì—´ ì œê±°'},
        8: {yong:'water', sub:'fire', desc:'ì‹ ì›” ê¸ˆê¸°ìš´ ê°•í•´ æ°´ë¡œ ì„¤ê¸°'},
        9: {yong:'water', sub:'fire', desc:'ìœ ì›” ê¸ˆì™•, æ°´ë¡œ ê¸ˆìƒìˆ˜'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í† ê¸°ìš´, ç«ë¡œ ìƒëª©'},
        11: {yong:'fire', sub:'water', desc:'í•´ì›” ìˆ˜ê¸°ìš´ ê°•í•´ ç«ë¡œ ì¡°ì ˆ'}
    },
    // ä¹™æœ¨ (ì„ëª©)
    1: {
        0: {yong:'fire', sub:'water', desc:'ê²¨ìš¸ ì„ëª©ì€ ì•½í•´ì„œ ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},
        1: {yong:'fire', sub:'water', desc:'ì¶•ì›” í•œê¸° ê°•í•´ ç«ê°€ í•„ìˆ˜'},
        2: {yong:'water', sub:'fire', desc:'ì¸ì›” ì´ˆë´„, æ°´ë¡œ ì„±ì¥'},
        3: {yong:'fire', sub:'water', desc:'ë¬˜ì›” ì„ëª© ì™•, ç«ë¡œ ì„¤ê¸°'},
        4: {yong:'water', sub:'fire', desc:'ì§„ì›” í† ê¸°ìš´, æ°´ë¡œ ìƒëª©'},
        5: {yong:'water', sub:'metal', desc:'ì‚¬ì›” í™”ê¸° ê°•í•´ æ°´ë¡œ ìì–‘'},
        6: {yong:'water', sub:'metal', desc:'ì˜¤ì›” ëœ¨ê±°ì›Œ æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'metal', desc:'ë¯¸ì›” ì¡°ì—´, æ°´ë¡œ ì‹œì›í•˜ê²Œ'},
        8: {yong:'fire', sub:'water', desc:'ì‹ ì›” ê¸ˆì™•ì ˆ, ç«ë¡œ ê¸ˆ ì œì–´'},
        9: {yong:'fire', sub:'water', desc:'ìœ ì›” ê¸ˆì™•, ç«ë¡œ ë³´í˜¸'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í™”ê¸° ìˆ˜ì¥, ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},
        11: {yong:'fire', sub:'wood', desc:'í•´ì›” ìˆ˜ì™•, ç«ë¡œ ê· í˜•'}
    },
    // ä¸™ç« (ë³‘í™”)
    2: {
        0: {yong:'wood', sub:'earth', desc:'ê²¨ìš¸ ë³‘í™”ëŠ” æœ¨ìœ¼ë¡œ ìƒí™”'},
        1: {yong:'wood', sub:'fire', desc:'ì¶•ì›” í•œí† , æœ¨ìœ¼ë¡œ ìƒí™”'},
        2: {yong:'water', sub:'metal', desc:'ì¸ì›” ëª©ìƒí™” ì™•, æ°´ë¡œ ì¡°ì ˆ'},
        3: {yong:'water', sub:'metal', desc:'ë¬˜ì›” ëª©ì™•, æ°´ë¡œ ê· í˜•'},
        4: {yong:'water', sub:'metal', desc:'ì§„ì›” í† ê¸°, æ°´ë¡œ ìœ¤íƒ'},
        5: {yong:'water', sub:'metal', desc:'ì‚¬ì›” í™”ì™•, æ°´ê°€ í•„ìˆ˜'},
        6: {yong:'water', sub:'metal', desc:'ì˜¤ì›” íƒœì–‘ ì •ì , æ°´ë¡œ ì‹í˜'},
        7: {yong:'water', sub:'metal', desc:'ë¯¸ì›” ì¡°ì—´, æ°´ë¡œ ì‹œì›í•˜ê²Œ'},
        8: {yong:'wood', sub:'water', desc:'ì‹ ì›” ê¸ˆì™•, æœ¨ìœ¼ë¡œ ìƒí™”'},
        9: {yong:'wood', sub:'water', desc:'ìœ ì›” ê¸ˆì™•, æœ¨ìœ¼ë¡œ ë³´ê°•'},
        10: {yong:'wood', sub:'water', desc:'ìˆ ì›” í† ì¡°, æœ¨ìœ¼ë¡œ ìƒí™”'},
        11: {yong:'wood', sub:'fire', desc:'í•´ì›” ìˆ˜ì™•, æœ¨ìœ¼ë¡œ í†µê´€'}
    },
    // ä¸ç« (ì •í™”)
    3: {
        0: {yong:'wood', sub:'fire', desc:'ê²¨ìš¸ ì •í™”ëŠ” æœ¨ìœ¼ë¡œ ë¶ˆì”¨ ìœ ì§€'},
        1: {yong:'wood', sub:'fire', desc:'ì¶•ì›” í•œê¸°, æœ¨ìœ¼ë¡œ ìƒí™”'},
        2: {yong:'wood', sub:'water', desc:'ì¸ì›” ìƒëª©, æ°´ë¡œ ì¡°ì ˆ'},
        3: {yong:'wood', sub:'water', desc:'ë¬˜ì›” ëª©ì™•, æ°´ë¡œ ê· í˜•'},
        4: {yong:'wood', sub:'water', desc:'ì§„ì›” ìŠµí† , æœ¨ìœ¼ë¡œ ìƒí™”'},
        5: {yong:'water', sub:'wood', desc:'ì‚¬ì›” í™”ì™•, æ°´ë¡œ ì¡°í›„'},
        6: {yong:'water', sub:'wood', desc:'ì˜¤ì›” í™”ê·¹ì„±, æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'wood', desc:'ë¯¸ì›” ì¡°ì—´, æ°´ë¡œ ì‹œì›í•˜ê²Œ'},
        8: {yong:'wood', sub:'fire', desc:'ì‹ ì›” ê¸ˆê¸° ê°•í•´ æœ¨ìœ¼ë¡œ ìƒí™”'},
        9: {yong:'wood', sub:'fire', desc:'ìœ ì›” ê¸ˆì™•, æœ¨ìœ¼ë¡œ ë³´ê°•'},
        10: {yong:'wood', sub:'fire', desc:'ìˆ ì›” í™”ê¸° ìˆ˜ì¥, æœ¨ìœ¼ë¡œ ìœ ì§€'},
        11: {yong:'wood', sub:'fire', desc:'í•´ì›” ìˆ˜ê·¹í™”, æœ¨ìœ¼ë¡œ í†µê´€'}
    },
    // æˆŠåœŸ (ë¬´í† )
    4: {
        0: {yong:'fire', sub:'wood', desc:'ê²¨ìš¸ ë¬´í† ëŠ” ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},
        1: {yong:'fire', sub:'wood', desc:'ì¶•ì›” í•œí† , ç«ë¡œ ì˜¨ê¸°'},
        2: {yong:'fire', sub:'wood', desc:'ì¸ì›” ëª©ê·¹í† , ç«ë¡œ í†µê´€'},
        3: {yong:'fire', sub:'metal', desc:'ë¬˜ì›” ëª©ì™•, ç«ë¡œ ì œì–´'},
        4: {yong:'metal', sub:'water', desc:'ì§„ì›” í† ì™•, é‡‘ìœ¼ë¡œ ì„¤ê¸°'},
        5: {yong:'water', sub:'metal', desc:'ì‚¬ì›” í™”ì™•, æ°´ë¡œ ì¡°í›„'},
        6: {yong:'water', sub:'metal', desc:'ì˜¤ì›” ì¡°í† , æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'metal', desc:'ë¯¸ì›” í† ì™•ì ˆ, æ°´ë¡œ ìœ¤íƒ'},
        8: {yong:'water', sub:'fire', desc:'ì‹ ì›” ê¸ˆê¸° ê°•í•´ æ°´ë¡œ ê· í˜•'},
        9: {yong:'fire', sub:'water', desc:'ìœ ì›” ê¸ˆì™•, ç«ë¡œ ì¡°ì ˆ'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í† ì™•, ç«ë¡œ ìƒí† '},
        11: {yong:'fire', sub:'wood', desc:'í•´ì›” ìˆ˜ì™•, ç«ë¡œ ì˜¨ê¸°'}
    },
    // å·±åœŸ (ê¸°í† )
    5: {
        0: {yong:'fire', sub:'wood', desc:'ê²¨ìš¸ ê¸°í† ëŠ” ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},
        1: {yong:'fire', sub:'wood', desc:'ì¶•ì›” í•œìŠµí† , ç«ë¡œ ì˜¨ê¸°'},
        2: {yong:'fire', sub:'water', desc:'ì¸ì›” ëª©ê·¹í† , ç«ë¡œ ë³´í˜¸'},
        3: {yong:'fire', sub:'water', desc:'ë¬˜ì›” ëª©ì™•, ç«ë¡œ í†µê´€'},
        4: {yong:'metal', sub:'water', desc:'ì§„ì›” í† ì™•, é‡‘ìœ¼ë¡œ ì„¤ê¸°'},
        5: {yong:'water', sub:'metal', desc:'ì‚¬ì›” ì¡°í† , æ°´ë¡œ ìœ¤íƒ'},
        6: {yong:'water', sub:'metal', desc:'ì˜¤ì›” í™”ì™•, æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'metal', desc:'ë¯¸ì›” í† ì™•ì ˆ, æ°´ë¡œ ì¡°ìŠµ'},
        8: {yong:'water', sub:'fire', desc:'ì‹ ì›” ê¸ˆê¸°, æ°´ë¡œ ìœ¤ê¸°'},
        9: {yong:'fire', sub:'water', desc:'ìœ ì›” ê¸ˆì™•, ç«ë¡œ ê· í˜•'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í† ì™•, ç«ë¡œ ìƒí† '},
        11: {yong:'fire', sub:'wood', desc:'í•´ì›” ìˆ˜ì™•, ç«ë¡œ ì¡°ì ˆ'}
    },
    // åºšé‡‘ (ê²½ê¸ˆ)
    6: {
        0: {yong:'fire', sub:'earth', desc:'ê²¨ìš¸ ê²½ê¸ˆì€ ç«ë¡œ ë‹¨ë ¨'},
        1: {yong:'fire', sub:'earth', desc:'ì¶•ì›” í•œê¸ˆ, ç«ë¡œ ë…¹ì„'},
        2: {yong:'fire', sub:'water', desc:'ì¸ì›” ëª©ê¸°ìš´, ç«ë¡œ ë³´í˜¸'},
        3: {yong:'fire', sub:'earth', desc:'ë¬˜ì›” ëª©ì™•, ç«ë¡œ í†µê´€'},
        4: {yong:'water', sub:'fire', desc:'ì§„ì›” í† ê¸°, æ°´ë¡œ ì„¤ê¸ˆ'},
        5: {yong:'water', sub:'earth', desc:'ì‚¬ì›” í™”ì™•, æ°´ë¡œ ì¡°í›„'},
        6: {yong:'water', sub:'earth', desc:'ì˜¤ì›” í™”ê·¹ê¸ˆ, æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'earth', desc:'ë¯¸ì›” ì¡°ì—´, æ°´ë¡œ ì‹í˜'},
        8: {yong:'water', sub:'fire', desc:'ì‹ ì›” ê¸ˆì™•, æ°´ë¡œ ì„¤ê¸°'},
        9: {yong:'water', sub:'fire', desc:'ìœ ì›” ê¸ˆê·¹ì„±, æ°´ç« í•„ìš”'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í† ìƒê¸ˆ, ç«ë¡œ ë‹¨ë ¨'},
        11: {yong:'fire', sub:'earth', desc:'í•´ì›” ìˆ˜ì™•, ç«ë¡œ ì˜¨ê¸°'}
    },
    // è¾›é‡‘ (ì‹ ê¸ˆ)
    7: {
        0: {yong:'fire', sub:'earth', desc:'ê²¨ìš¸ ì‹ ê¸ˆì€ ç«ë¡œ ë”°ëœ»í•˜ê²Œ'},
        1: {yong:'fire', sub:'earth', desc:'ì¶•ì›” í•œê¸ˆ, ç«ë¡œ ì˜¨ê¸°'},
        2: {yong:'water', sub:'fire', desc:'ì¸ì›” ëª©ê¸°ìš´, æ°´ë¡œ ì„¸ì •'},
        3: {yong:'water', sub:'fire', desc:'ë¬˜ì›” ëª©ì™•, æ°´ë¡œ ìœ¤ê¸°'},
        4: {yong:'water', sub:'fire', desc:'ì§„ì›” í† ê¸°, æ°´ë¡œ ì”»ê¹€'},
        5: {yong:'water', sub:'earth', desc:'ì‚¬ì›” í™”ì™•, æ°´ë¡œ ì¡°í›„'},
        6: {yong:'water', sub:'earth', desc:'ì˜¤ì›” í™”ê·¹ê¸ˆ, æ°´ê°€ í•„ìˆ˜'},
        7: {yong:'water', sub:'earth', desc:'ë¯¸ì›” ì¡°ì—´, æ°´ë¡œ ì‹œì›í•˜ê²Œ'},
        8: {yong:'water', sub:'fire', desc:'ì‹ ì›” ê¸ˆì™•, æ°´ë¡œ ì„¤ê¸°'},
        9: {yong:'water', sub:'fire', desc:'ìœ ì›” ê¸ˆê·¹ì„±, æ°´ë¡œ ì„¸ì •'},
        10: {yong:'fire', sub:'water', desc:'ìˆ ì›” í† ê¸°, ç«ë¡œ ë¹›ë‚¨'},
        11: {yong:'fire', sub:'earth', desc:'í•´ì›” ìˆ˜ì™•, ç«ë¡œ ê· í˜•'}
    },
    // å£¬æ°´ (ì„ìˆ˜)
    8: {
        0: {yong:'fire', sub:'earth', desc:'ê²¨ìš¸ ì„ìˆ˜ëŠ” ç«ë¡œ ì–¼ìŒ ë…¹ì„'},
        1: {yong:'fire', sub:'wood', desc:'ì¶•ì›” í•œìˆ˜, ç«ë¡œ ì˜¨ê¸°'},
        2: {yong:'earth', sub:'fire', desc:'ì¸ì›” ìˆ˜ìƒëª©, åœŸë¡œ ì œì–´'},
        3: {yong:'earth', sub:'fire', desc:'ë¬˜ì›” ëª©ê¸°ìš´, åœŸë¡œ ê· í˜•'},
        4: {yong:'metal', sub:'fire', desc:'ì§„ì›” í† ê¸°, é‡‘ìœ¼ë¡œ ìƒìˆ˜'},
        5: {yong:'metal', sub:'water', desc:'ì‚¬ì›” í™”ì™•, é‡‘ìœ¼ë¡œ ìƒìˆ˜'},
        6: {yong:'metal', sub:'water', desc:'ì˜¤ì›” í™”ê·¹ì„±, é‡‘æ°´ í•„ìš”'},
        7: {yong:'metal', sub:'water', desc:'ë¯¸ì›” í† ì™•, é‡‘ìœ¼ë¡œ í†µê´€'},
        8: {yong:'fire', sub:'earth', desc:'ì‹ ì›” ê¸ˆìƒìˆ˜, ç«ë¡œ ì¡°ì ˆ'},
        9: {yong:'fire', sub:'earth', desc:'ìœ ì›” ê¸ˆì™•, ç«ë¡œ ê· í˜•'},
        10: {yong:'fire', sub:'wood', desc:'ìˆ ì›” í† ê¸°, ç«ë¡œ ì˜¨ê¸°'},
        11: {yong:'fire', sub:'wood', desc:'í•´ì›” ìˆ˜ì™•, ç«ê°€ í•„ìˆ˜'}
    },
    // ç™¸æ°´ (ê³„ìˆ˜)
    9: {
        0: {yong:'fire', sub:'wood', desc:'ê²¨ìš¸ ê³„ìˆ˜ëŠ” ç«ë¡œ ì–¼ìŒ ë…¹ì„'},
        1: {yong:'fire', sub:'wood', desc:'ì¶•ì›” í•œìˆ˜, ç«ë¡œ ì˜¨ê¸°'},
        2: {yong:'fire', sub:'metal', desc:'ì¸ì›” ëª©ê¸°ìš´, ç«ë¡œ ì„¤ê¸°'},
        3: {yong:'fire', sub:'metal', desc:'ë¬˜ì›” ëª©ì™•, ç«ë¡œ ê· í˜•'},
        4: {yong:'fire', sub:'metal', desc:'ì§„ì›” í† ê·¹ìˆ˜, ç«ë¡œ í†µê´€'},
        5: {yong:'metal', sub:'water', desc:'ì‚¬ì›” í™”ì™•, é‡‘ìœ¼ë¡œ ìƒìˆ˜'},
        6: {yong:'metal', sub:'water', desc:'ì˜¤ì›” í™”ê·¹ì„±, é‡‘æ°´ í•„ìš”'},
        7: {yong:'metal', sub:'water', desc:'ë¯¸ì›” í† ì™•, é‡‘ìœ¼ë¡œ í†µê´€'},
        8: {yong:'fire', sub:'wood', desc:'ì‹ ì›” ê¸ˆìƒìˆ˜, ç«ë¡œ ì¡°ì ˆ'},
        9: {yong:'fire', sub:'wood', desc:'ìœ ì›” ê¸ˆì™•, ç«ë¡œ ì„¤ê¸ˆ'},
        10: {yong:'fire', sub:'wood', desc:'ìˆ ì›” í† ê¸°, ç«ë¡œ ì˜¨ê¸°'},
        11: {yong:'fire', sub:'metal', desc:'í•´ì›” ìˆ˜ì™•, ç«ê°€ í•„ìˆ˜'}
    }
};

// í•œë‚œì¡°ìŠµ(å¯’æš–ç‡¥æ¿•) íŒë‹¨
function analyzeClimate(saju) {
    const mbi = BRANCH.indexOf(saju.month.b);
    const season = SEASON[mbi];
    
    let climate = {type: '', desc: '', needs: []};
    
    // ì§€ì§€ì˜ ì˜¤í–‰ ë¶„í¬ ì²´í¬
    const brs = [saju.year?.b, saju.month?.b, saju.day?.b, saju.hour?.b].filter(b => b);
    let fireCount = 0, waterCount = 0, earthCount = 0;
    brs.forEach(b => {
        if (b.e === 'fire') fireCount++;
        if (b.e === 'water') waterCount++;
        if (b.e === 'earth') earthCount++;
    });
    
    // ê¸°ë³¸ ê¸°í›„ íŒë‹¨
    if (season === 'winter') {
        climate.type = waterCount >= 2 ? 'ê·¹í•œ(æ¥µå¯’)' : 'í•œ(å¯’)';
        climate.desc = 'ì°¨ê°€ìš´ ì‚¬ì£¼ì…ë‹ˆë‹¤. ë”°ëœ»í•œ ç« ê¸°ìš´ì´ í•„ìš”í•©ë‹ˆë‹¤.';
        climate.needs = ['fire', 'wood'];
    } else if (season === 'summer') {
        climate.type = fireCount >= 2 ? 'ê·¹ì¡°(æ¥µç‡¥)' : 'ì¡°(ç‡¥)';
        climate.desc = 'ëœ¨ê²ê³  ê±´ì¡°í•œ ì‚¬ì£¼ì…ë‹ˆë‹¤. ì‹œì›í•œ æ°´ ê¸°ìš´ì´ í•„ìš”í•©ë‹ˆë‹¤.';
        climate.needs = ['water', 'metal'];
    } else if (mbi === 1 || mbi === 4 || mbi === 7 || mbi === 10) {
        // í† ì™•ì ˆ
        if (earthCount >= 2) {
            climate.type = 'ìŠµ(æ¿•)';
            climate.desc = 'ìŠµí•œ ê¸°ìš´ì´ ìˆëŠ” ì‚¬ì£¼ì…ë‹ˆë‹¤. ç«ë¡œ ê±´ì¡°í•˜ê²Œ í•´ì•¼ í•©ë‹ˆë‹¤.';
            climate.needs = ['fire', 'wood'];
        } else {
            climate.type = 'ì¤‘í™”(ä¸­å’Œ)';
            climate.desc = 'ê¸°í›„ê°€ ê· í˜• ì¡íŒ ì‚¬ì£¼ì…ë‹ˆë‹¤.';
            climate.needs = [];
        }
    } else {
        climate.type = 'ì˜¨(æº«)';
        climate.desc = 'ì˜¨í™”í•œ ê¸°ìš´ì˜ ì‚¬ì£¼ì…ë‹ˆë‹¤.';
        climate.needs = [];
    }
    
    return climate;
}

// ë³‘ì•½(ç—…è—¥) ìš©ì‹  ì°¾ê¸°
function findByungYak(saju, strength) {
    const dm = saju.day.s;
    const dmi = STEM.indexOf(dm);
    const ec = countElements(saju);
    
    let byung = null, yak = null;
    
    // ê°€ì¥ ë§ì€ ì˜¤í–‰ (ë³‘)
    let maxEl = null, maxCount = 0;
    for (let e of EL_ORDER) {
        if (ec[e] > maxCount && e !== dm.e) {
            maxCount = ec[e];
            maxEl = e;
        }
    }
    
    if (maxCount >= 3) {
        byung = maxEl;
        // ì•½(è—¥) ì°¾ê¸° - ë³‘ì„ ì œì–´í•˜ëŠ” ì˜¤í–‰
        const kontrolIdx = (EL_ORDER.indexOf(maxEl) + 3) % 5;
        yak = EL_ORDER[kontrolIdx];
    }
    
    return { byung, yak, desc: byung ? `${ELEMENT[byung].k}ì´ ê³¼ë‹¤í•˜ë‹ˆ ${ELEMENT[yak].k}ìœ¼ë¡œ ì œì–´` : null };
}

function calcGods(saju, str) {
    const dm = saju.day.s;
    const dmi = STEM.indexOf(dm);
    const mbi = BRANCH.indexOf(saju.month.b);
    const season = SEASON[mbi];
    let yong, hee, gi, johu = null, johuDesc = '';
    
    // 1. ê¸°ë³¸ ìš©ì‹  (ì‹ ê°•/ì‹ ì•½ ê¸°ì¤€)
    if (str.type === 'strong') { 
        yong = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 2) % 5]; // ì¬ì„±
        hee = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 1) % 5]; // ì‹ìƒ
        gi = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 4) % 5];  // ì¸ì„±
    }
    else if (str.type === 'weak') { 
        yong = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 4) % 5]; // ì¸ì„±
        hee = dm.e; // ë¹„ê²
        gi = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 3) % 5];  // ê´€ì‚´
    }
    else { 
        yong = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 1) % 5]; // ì‹ìƒ
        hee = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 2) % 5]; // ì¬ì„±
        gi = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 3) % 5];  // ê´€ì‚´
    }
    
    // 2. ì¡°í›„ìš©ì‹  ê³ ê¸‰ ì ìš© (ì›”ë³„ í…Œì´ë¸” ì‚¬ìš©)
    const johuData = JOHU_TABLE[dmi] && JOHU_TABLE[dmi][mbi];
    if (johuData) {
        johu = johuData.yong;
        johuDesc = johuData.desc;
        
        // ì¡°í›„ìš©ì‹ ì´ ê¸°ì‹ ì´ ì•„ë‹ˆë©´ ìš°ì„  ì ìš©
        if (johu !== gi) {
            hee = yong;
            yong = johu;
        }
    }
    
    // 3. í•œë‚œì¡°ìŠµ ë¶„ì„
    const climate = analyzeClimate(saju);
    
    // 4. ë³‘ì•½ ë¶„ì„
    const byungYak = findByungYak(saju, str);
    
    return { 
        yong, hee, gi, 
        type: str.type, 
        johu, johuDesc,
        climate,
        byungYak,
        sub: johuData?.sub || null
    };
}

/* ========================================
   9-5. ìœ¡ì¹œ(å…­è¦ª) ì •ë°€ ë¶„ì„
   ======================================== */

// ìœ¡ì¹œ ì •ì˜
const YUKCHEON = {
    m: { // ë‚¨ì
        'ë¹„ê²¬': {relation: 'í˜•ì œ/ì¹œêµ¬', desc: 'ë‚˜ì™€ ë™ë“±í•œ ê´€ê³„', detailed: 'í˜•ì œìë§¤, ì¹œêµ¬, ë™ë£Œ, ê²½ìŸì'},
        'ê²ì¬': {relation: 'í˜•ì œ/ê²½ìŸì', desc: 'ë‚˜ì™€ ê²½ìŸí•˜ëŠ” ê´€ê³„', detailed: 'ì´ë³µí˜•ì œ, ì‚¬ì´Œ, ê²½ìŸì, ë™ì—…ì'},
        'ì‹ì‹ ': {relation: 'ìë…€(ë”¸)/í›„ë°°', desc: 'ë‚´ê°€ ë‚³ì€ ê²ƒ', detailed: 'ë”¸, ì†ë…€, í›„ë°°, ë¶€í•˜, ì œì'},
        'ìƒê´€': {relation: 'ìë…€(ì•„ë“¤)/ì¬ëŠ¥', desc: 'ë‚´ê°€ í‘œí˜„í•˜ëŠ” ê²ƒ', detailed: 'ì•„ë“¤, ì†ì, ì°½ì‘ë¬¼, ì•„ì´ë””ì–´'},
        'í¸ì¬': {relation: 'ì•„ë²„ì§€/ì• ì¸', desc: 'ë‚´ê°€ ë‹¤ìŠ¤ë¦¬ëŠ” ì¬ë¬¼', detailed: 'ì•„ë²„ì§€, ì²©, ì• ì¸, ìœ í¥, íˆ¬ê¸°ì¬'},
        'ì •ì¬': {relation: 'ì•„ë‚´/ì¬ì‚°', desc: 'ë‚´ê°€ ì§€í‚¤ëŠ” ì¬ë¬¼', detailed: 'ì•„ë‚´, ì •ì—…ìœ¼ë¡œ ë²ˆ ëˆ, ê¸‰ì—¬'},
        'í¸ê´€': {relation: 'ìë…€(ì•„ë“¤)/ì§ì¥', desc: 'ë‚˜ë¥¼ ë‹¤ìŠ¤ë¦¬ëŠ” ê²ƒ', detailed: 'ì•„ë“¤, ì§ì¥ìƒì‚¬, ê¶Œë ¥, ì••ë°•'},
        'ì •ê´€': {relation: 'ìë…€(ë”¸)/ëª…ì˜ˆ', desc: 'ë‚˜ë¥¼ ë°”ë¥´ê²Œ í•˜ëŠ” ê²ƒ', detailed: 'ë”¸, ëª…ì˜ˆ, ì§ì¥, ë²•ë¥ '},
        'í¸ì¸': {relation: 'ê³„ëª¨/ì˜ë¶€', desc: 'ë‚˜ë¥¼ í¸ì¤‘ë˜ê²Œ ê¸°ë¥´ëŠ” ê²ƒ', detailed: 'ê³„ëª¨, ì˜ë¶“ì–´ë¨¸ë‹ˆ, ì„œëª¨'},
        'ì •ì¸': {relation: 'ì–´ë¨¸ë‹ˆ/í•™ë¬¸', desc: 'ë‚˜ë¥¼ ë°”ë¥´ê²Œ ê¸°ë¥´ëŠ” ê²ƒ', detailed: 'ì–´ë¨¸ë‹ˆ, í•™ì—…, ë¬¸ì„œ, ìê²©ì¦'}
    },
    f: { // ì—¬ì
        'ë¹„ê²¬': {relation: 'ìë§¤/ì¹œêµ¬', desc: 'ë‚˜ì™€ ë™ë“±í•œ ê´€ê³„', detailed: 'ìë§¤, ì¹œêµ¬, ë™ë£Œ, ê²½ìŸì'},
        'ê²ì¬': {relation: 'ìë§¤/ê²½ìŸì', desc: 'ë‚˜ì™€ ê²½ìŸí•˜ëŠ” ê´€ê³„', detailed: 'ì´ë³µìë§¤, ì‚¬ì´Œ, ê²½ìŸì'},
        'ì‹ì‹ ': {relation: 'ìë…€(ë”¸)/ì¬ëŠ¥', desc: 'ë‚´ê°€ ë‚³ì€ ê²ƒ', detailed: 'ë”¸, ì†ë…€, í‘œí˜„ë ¥, ì¬ëŠ¥'},
        'ìƒê´€': {relation: 'ìë…€(ì•„ë“¤)/ì´ì„±', desc: 'ë‚´ê°€ í‘œí˜„í•˜ëŠ” ê²ƒ', detailed: 'ì•„ë“¤, ì†ì, ì—°ì¸, ë§¤ë ¥'},
        'í¸ì¬': {relation: 'ì‹œì•„ë²„ì§€/ì¬ë¬¼', desc: 'ë‚´ê°€ ë‹¤ìŠ¤ë¦¬ëŠ” ì¬ë¬¼', detailed: 'ì‹œì•„ë²„ì§€, íˆ¬ê¸°ì¬, íš¡ì¬'},
        'ì •ì¬': {relation: 'ì‹œì–´ë¨¸ë‹ˆ/ì¬ì‚°', desc: 'ë‚´ê°€ ì§€í‚¤ëŠ” ì¬ë¬¼', detailed: 'ì‹œì–´ë¨¸ë‹ˆ, ì •ì—…ì¬, ê¸‰ì—¬'},
        'í¸ê´€': {relation: 'ì• ì¸/ë‚¨ì', desc: 'ë‚˜ë¥¼ ë‹¤ìŠ¤ë¦¬ëŠ” ê²ƒ', detailed: 'ì• ì¸, ë°”ëŒ, ì™¸ë„ë‚¨, í­ë ¥ë‚¨'},
        'ì •ê´€': {relation: 'ë‚¨í¸/ëª…ì˜ˆ', desc: 'ë‚˜ë¥¼ ë°”ë¥´ê²Œ í•˜ëŠ” ê²ƒ', detailed: 'ë‚¨í¸, ëª…ì˜ˆ, ì§ì¥'},
        'í¸ì¸': {relation: 'ê³„ëª¨/ì¥ì• ', desc: 'ë‚˜ë¥¼ í¸ì¤‘ë˜ê²Œ ê¸°ë¥´ëŠ” ê²ƒ', detailed: 'ê³„ëª¨, ì˜ëª¨, ë¶ˆì™„ì „í•œ í•™ì—…'},
        'ì •ì¸': {relation: 'ì–´ë¨¸ë‹ˆ/í•™ë¬¸', desc: 'ë‚˜ë¥¼ ë°”ë¥´ê²Œ ê¸°ë¥´ëŠ” ê²ƒ', detailed: 'ì–´ë¨¸ë‹ˆ, í•™ì—…, ë¬¸ì„œ'}
    }
};

// ìœ¡ì¹œ ìœ„ì¹˜ë³„ ì˜ë¯¸
const YUKCHEON_POSITION = {
    year: {name: 'ë…„ì£¼', meaning: 'ì¡°ìƒ, ì‚¬íšŒ, ì´ˆë…„(1-15ì„¸)', body: 'ë¨¸ë¦¬/ì–¼êµ´'},
    month: {name: 'ì›”ì£¼', meaning: 'ë¶€ëª¨, í˜•ì œ, ì§ì—…, ì²­ë…„(16-30ì„¸)', body: 'ê°€ìŠ´/ì–´ê¹¨'},
    day: {name: 'ì¼ì£¼', meaning: 'ë³¸ì¸, ë°°ìš°ì, ê°€ì •, ì¤‘ë…„(31-45ì„¸)', body: 'í—ˆë¦¬/ë³µë¶€'},
    hour: {name: 'ì‹œì£¼', meaning: 'ìë…€, í›„ë°°, ë§ë…„(46ì„¸+)', body: 'ë‹¤ë¦¬/ë°œ'}
};

// ìœ¡ì¹œ ì •ë°€ ë¶„ì„
function analyzeYukcheon(saju, gender) {
    const dm = saju.day.s;
    const g = gender || GENDER || 'm';
    const yukData = YUKCHEON[g];
    
    const result = {
        positions: [],   // ê° ìœ„ì¹˜ë³„ ìœ¡ì¹œ
        counts: {},      // ìœ¡ì¹œë³„ ê°œìˆ˜
        analysis: [],    // ì¢…í•© ë¶„ì„
        spouse: null,    // ë°°ìš°ì ë¶„ì„
        children: null,  // ìë…€ ë¶„ì„
        parents: null    // ë¶€ëª¨ ë¶„ì„
    };
    
    const pillars = [
        {pos: 'year', pillar: saju.year},
        {pos: 'month', pillar: saju.month},
        {pos: 'day', pillar: saju.day},
        {pos: 'hour', pillar: saju.hour}
    ];
    
    // ê° ê¸°ë‘¥ ë¶„ì„
    pillars.forEach(({pos, pillar}) => {
        if (!pillar) return;
        
        // ì²œê°„ ì‹­ì‹ 
        const stemGod = pos === 'day' ? {k: 'ì¼ê°„', c: 'æ—¥å¹²'} : getTenGod(pillar.s, dm);
        
        // ì§€ì§€ ë³¸ê¸° ì‹­ì‹ 
        const mainJJ = JIJANGGAN[BRANCH.indexOf(pillar.b)];
        const mainStem = mainJJ && mainJJ.length > 0 ? STEM[mainJJ[mainJJ.length - 1].stem] : null;
        const branchGod = mainStem ? getTenGod(mainStem, dm) : null;
        
        const posInfo = YUKCHEON_POSITION[pos];
        const yukInfo = yukData[stemGod.k];
        
        result.positions.push({
            position: pos,
            posName: posInfo.name,
            posMeaning: posInfo.meaning,
            stem: pillar.s,
            branch: pillar.b,
            stemGod: stemGod.k,
            branchGod: branchGod ? branchGod.k : null,
            relation: yukInfo ? yukInfo.relation : 'ë³¸ì¸',
            detailed: yukInfo ? yukInfo.detailed : 'ìê¸° ìì‹ '
        });
        
        // ê°œìˆ˜ ì§‘ê³„
        if (stemGod.k !== 'ì¼ê°„') {
            result.counts[stemGod.k] = (result.counts[stemGod.k] || 0) + 1;
        }
        if (branchGod) {
            result.counts[branchGod.k] = (result.counts[branchGod.k] || 0) + 0.5;
        }
    });
    
    // ========== ë°°ìš°ì ë¶„ì„ ==========
    const spouseGod = g === 'm' ? 'ì •ì¬' : 'ì •ê´€';
    const spouseGod2 = g === 'm' ? 'í¸ì¬' : 'í¸ê´€'; // í¸ì¬/í¸ê´€ë„ í¬í•¨
    const spouseCount = (result.counts[spouseGod] || 0) + (result.counts[spouseGod2] || 0);
    const dayBranchState = getTwelveState(dm, saju.day.b);
    
    // ì§€ì¥ê°„ì— ì¬ì„±/ê´€ì„±ì´ ìˆëŠ”ì§€ ì²´í¬
    let hasHiddenSpouse = false;
    const branches = [saju.year.b, saju.month.b, saju.day.b];
    if (saju.hour) branches.push(saju.hour.b);
    
    branches.forEach(br => {
        const bi = BRANCH.indexOf(br);
        const jj = JIJANGGAN[bi];
        if (jj) {
            jj.forEach(j => {
                const jjGod = getTenGod(STEM[j.stem], dm);
                if (jjGod && (jjGod.k === spouseGod || jjGod.k === spouseGod2)) {
                    hasHiddenSpouse = true;
                }
            });
        }
    });
    
    let spouseAnalysis = '';
    
    // â˜… ë°°ìš°ìê¶(ì¼ì§€) ì¶©ê·¹ ì²´í¬
    const dbi = BRANCH.indexOf(saju.day.b);
    const ybi = BRANCH.indexOf(saju.year.b);
    const mbi = BRANCH.indexOf(saju.month.b);
    const hbi = saju.hour ? BRANCH.indexOf(saju.hour.b) : -1;
    const otherBranches = [ybi, mbi];
    if (hbi >= 0) otherBranches.push(hbi);
    
    // ì¶© ì²´í¬ (ìì˜¤, ì¶•ë¯¸, ì¸ì‹ , ë¬˜ìœ , ì§„ìˆ , ì‚¬í•´)
    const chungPairs = [[0,6],[1,7],[2,8],[3,9],[4,10],[5,11]];
    let spouseClash = false;
    let spouseClashType = '';
    chungPairs.forEach(([a,b]) => {
        if ((dbi === a && otherBranches.includes(b)) || (dbi === b && otherBranches.includes(a))) {
            spouseClash = true;
            spouseClashType = 'ì¶©(æ²–)';
        }
    });
    
    // í˜• ì²´í¬ (ë¬˜ì‹ ì›ì§„ ë“±)
    const harmPairs = [[3,8],[1,6],[3,4]]; // ë¬˜ì‹ , ì¶•ì˜¤, ë¬˜ì§„ ë“±
    harmPairs.forEach(([a,b]) => {
        if ((dbi === a && otherBranches.includes(b)) || (dbi === b && otherBranches.includes(a))) {
            if (!spouseClash) {
                spouseClash = true;
                spouseClashType = 'ì›ì§„/í•´(å®³)';
            }
        }
    });
    
    if (spouseCount === 0 && !hasHiddenSpouse) {
        spouseAnalysis = 'ë°°ìš°ìì„±ì´ ì—†ì–´ìš”. ê²°í˜¼ì´ ëŠ¦ê±°ë‚˜ ì¸ì—°ì´ ì•½í•  ìˆ˜ ìˆì–´ìš”. ëŒ€ìš´ì—ì„œ ë“¤ì–´ì˜¤ë©´ ì¸ì—°ì´ ìƒê²¨ìš”.';
    } else if (spouseCount === 0 && hasHiddenSpouse) {
        spouseAnalysis = 'ì²œê°„ì— ë°°ìš°ìì„±ì´ ì—†ì§€ë§Œ ì§€ì¥ê°„ì— ìˆ¨ì–´ ìˆì–´ìš”. ê²‰ìœ¼ë¡œ ë“œëŸ¬ë‚˜ì§€ ì•ŠëŠ” ì‹¤ì†í˜• ë°°ìš°ìë¥¼ ë§Œë‚˜ê±°ë‚˜, ì†Œê°œíŒ…ë³´ë‹¤ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ ë§Œë‚¨ì—ì„œ ì¸ì—°ì´ ìƒê²¨ìš”.';
    } else if (spouseCount >= 2) {
        spouseAnalysis = 'ë°°ìš°ìì„±ì´ ë§ì•„ìš”. ì´ì„± ì¸ê¸° ë§ì§€ë§Œ ë°”ëŒê¸° ì¡°ì‹¬! í•œ ì‚¬ëŒì—ê²Œ ì§‘ì¤‘í•˜ì„¸ìš”.';
    } else {
        spouseAnalysis = 'ë°°ìš°ìì„±ì´ ì ì ˆí•´ìš”. ì¢‹ì€ ì¸ì—°ì„ ë§Œë‚  ìˆ˜ ìˆì–´ìš”.';
    }
    
    // ë°°ìš°ìê¶ ì¶©ê·¹ ì‹œ ê²½ê³  ì¶”ê°€
    if (spouseClash) {
        spouseAnalysis += ` âš ï¸ ë‹¨, ë°°ìš°ìê¶(ì¼ì§€)ì´ ${spouseClashType}ì„ ë°›ì•„ ë¶€ë¶€ ê°ˆë“±ì´ ìˆì„ ìˆ˜ ìˆì–´ìš”. ì„œë¡œ ê±°ë¦¬ë¥¼ ë‘ê±°ë‚˜ ê°ì ë°”ìœ ìƒí™œì´ ì˜¤íˆë ¤ ì¢‹ì•„ìš”.`;
    }
    
    result.spouse = {
        god: spouseGod,
        count: spouseCount,
        dayBranch: dayBranchState,
        analysis: spouseAnalysis
    };
    
    // ========== ìë…€ ë¶„ì„ ==========
    const childGod = g === 'm' ? ['í¸ê´€', 'ì •ê´€'] : ['ì‹ì‹ ', 'ìƒê´€'];
    const childCount = (result.counts[childGod[0]] || 0) + (result.counts[childGod[1]] || 0);
    const hourPillar = saju.hour;
    
    let childAnalysis = '';
    if (!hourPillar) {
        childAnalysis = 'ì‹œì£¼ê°€ ì—†ì–´ì„œ ìë…€ ë¶„ì„ì´ ì–´ë ¤ì›Œìš”.';
    } else if (childCount === 0) {
        childAnalysis = 'ìë…€ì„±ì´ ì—†ì–´ìš”. ìë…€ê°€ ëŠ¦ê±°ë‚˜ ì ì„ ìˆ˜ ìˆì–´ìš”.';
    } else if (childCount >= 2) {
        childAnalysis = 'ìë…€ì„±ì´ ë§ì•„ìš”. ìë…€ë³µì´ ìˆê³  ìë…€ê°€ ë§ì„ ìˆ˜ ìˆì–´ìš”.';
    } else {
        childAnalysis = 'ìë…€ ì¸ì—°ì´ ì ë‹¹í•´ìš”.';
    }
    
    result.children = {
        gods: childGod,
        count: childCount,
        analysis: childAnalysis
    };
    
    // ========== ë¶€ëª¨ ë¶„ì„ ==========
    const fatherGod = 'í¸ì¬';
    const motherGod = 'ì •ì¸';
    const fatherCount = result.counts[fatherGod] || 0;
    const motherCount = result.counts[motherGod] || 0;
    
    result.parents = {
        father: {god: fatherGod, count: fatherCount, analysis: fatherCount > 0 ? 'ì•„ë²„ì§€ì™€ ì¸ì—°ì´ ìˆì–´ìš”.' : 'ì•„ë²„ì§€ ì¸ì—°ì´ ì•½í•´ìš”.'},
        mother: {god: motherGod, count: motherCount, analysis: motherCount > 0 ? 'ì–´ë¨¸ë‹ˆì™€ ì¸ì—°ì´ ê¹Šì–´ìš”.' : 'ì–´ë¨¸ë‹ˆ ì¸ì—°ì´ ë‹¤ì†Œ ì•½í•´ìš”.'}
    };
    
    // ========== ì¢…í•© ë¶„ì„ ==========
    // ìœ¡ì¹œ ë‹¤ê³¼(å¤šå¯¡) ë¶„ì„
    for (let [god, count] of Object.entries(result.counts)) {
        if (count >= 2) {
            const info = yukData[god];
            if (info) {
                result.analysis.push({
                    type: 'many',
                    god,
                    count,
                    meaning: `${god}ì´ ë§ì•„ì„œ ${info.detailed} ê´€ë ¨ ì¼ì´ ë§ì•„ìš”.`
                });
            }
        }
    }
    
    // ì—†ëŠ” ìœ¡ì¹œ ì²´í¬
    const allGods = ['ë¹„ê²¬','ê²ì¬','ì‹ì‹ ','ìƒê´€','í¸ì¬','ì •ì¬','í¸ê´€','ì •ê´€','í¸ì¸','ì •ì¸'];
    allGods.forEach(god => {
        if (!result.counts[god]) {
            const info = yukData[god];
            if (info) {
                result.analysis.push({
                    type: 'none',
                    god,
                    meaning: `${god}ì´ ì—†ì–´ì„œ ${info.detailed} ì¸ì—°ì´ ì•½í•´ìš”.`
                });
            }
        }
    });
    
    return result;
}

/* ========================================
   10. ê²©êµ­(æ ¼å±€) ì •ë°€ íŒì •
   ======================================== */
   
// ë‚´ê²©(å…§æ ¼) 8ê²© ë°ì´í„°
const FORMATS_INNER = {
    'ë¹„ê²¬':{n:'ë¹„ê²¬ê²©(æ¯”è‚©æ ¼)',d:'ë…ë¦½ì‹¬ê³¼ ê²½ìŸì‹¬ì´ ê°•í•œ ììˆ˜ì„±ê°€í˜•ì…ë‹ˆë‹¤. ë‚¨ì—ê²Œ ì§€ê¸° ì‹«ì–´í•˜ê³  ìì¡´ì‹¬ì´ ì…‰ë‹ˆë‹¤. í˜•ì œ, ë™ë£Œì™€ì˜ ì¸ì—°ì´ ê¹Šìœ¼ë©°, ë™ì—…ì´ë‚˜ í˜‘ë ¥ ì‚¬ì—…ì—ì„œ ì„±ê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ê³ ì§‘ì´ ì„¸ê³  ë…ë‹¨ì ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ í˜‘ì¡°í•˜ëŠ” ìì„¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.',b:'ë…ë¦½ ì‚¬ì—…, í”„ë¦¬ëœì„œ, ìŠ¤í¬ì¸ , ê²½ìŸ ë¶„ì•¼',lv:'ì¤‘'},
    'ê²ì¬':{n:'ê²ì¬ê²©(åŠ«è²¡æ ¼)',d:'ë„ì „ì ì´ê³  ìŠ¹ë¶€ìš•ì´ ê°•í•©ë‹ˆë‹¤. ë°°ì§±ì´ ìˆì–´ í°ì¼ì„ ë²Œì´ì§€ë§Œ, ë•Œë¡œëŠ” ë¬´ëª¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¬ë¬¼ì— ëŒ€í•œ ìš•ì‹¬ì´ ìˆê³  íˆ¬ê¸°ì„±ì´ ìˆì–´ í•œíƒ•ì£¼ì˜ì— ë¹ ì§€ê¸° ì‰½ìŠµë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê¸°ë¥´ê³  ê¾¸ì¤€íˆ ë…¸ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.',b:'íˆ¬ì, ë„ë°•, ëª¨í—˜ ì‚¬ì—…, ì˜ì—…',lv:'í•˜'},
    'ì‹ì‹ ':{n:'ì‹ì‹ ê²©(é£Ÿç¥æ ¼)',d:'íƒ€ê³ ë‚œ ì¬ëŠ¥ì´ ë§ê³  ì˜ì‹ì£¼ê°€ í’ì¡±í•©ë‹ˆë‹¤. ë¨¹ëŠ” ë³µì´ ìˆê³  ì„±ê²©ì´ ë‚™ì²œì ì…ë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ì´ ë›°ì–´ë‚˜ê³  í‘œí˜„ë ¥ì´ ì¢‹ìŠµë‹ˆë‹¤. ìì‹ìš´ì´ ì¢‹ê³  ìˆ˜ëª…ë„ ê¸´ í¸ì…ë‹ˆë‹¤. ë‹¤ë§Œ ê²Œì„ëŸ¬ì§€ê¸° ì‰¬ìš°ë‹ˆ ë¶€ì§€ëŸ°í•¨ì´ í•„ìš”í•©ë‹ˆë‹¤.',b:'ìš”ì‹ì—…, ì˜ˆìˆ , êµìœ¡, ì—°ì˜ˆ, ì°½ì‘',lv:'ìƒ'},
    'ìƒê´€':{n:'ìƒê´€ê²©(å‚·å®˜æ ¼)',d:'ì°½ì˜ì ì´ê³  ì˜ˆìˆ ì  ê°ì„±ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë¨¸ë¦¬ê°€ ì´ëª…í•˜ê³  ì–¸ë³€ì´ ì¢‹ìŠµë‹ˆë‹¤. ê·œì¹™ì— ì–½ë§¤ì´ê¸° ì‹«ì–´í•˜ê³  ììœ ë¡œìš´ ì˜í˜¼ì…ë‹ˆë‹¤. ë‹¤ë§Œ ì…ì´ ê±°ì¹ ê³  ê¶Œìœ„ì— ë°˜í•­í•˜ëŠ” ê²½í–¥ì´ ìˆì–´ ìƒì‚¬ì™€ ì¶©ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',b:'ì—°ì˜ˆ, ì˜ˆìˆ , ê°•ì—°, ë¹„í‰, ê¸°íš',lv:'ì¤‘'},
    'í¸ì¬':{n:'í¸ì¬ê²©(åè²¡æ ¼)',d:'ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ê³  íˆ¬ì ê°ê°ì´ íƒì›”í•©ë‹ˆë‹¤. íš¡ì¬ìˆ˜ê°€ ìˆê³  ëˆì´ í¬ê²Œ ë“¤ì–´ì™”ë‹¤ ë‚˜ê°€ëŠ” íƒ€ì…ì…ë‹ˆë‹¤. ì‚¬êµì„±ì´ ì¢‹ì•„ ì¸ë§¥ì´ ë„“ê³ , ì•„ë²„ì§€ì™€ì˜ ì¸ì—°ì´ ê¹ŠìŠµë‹ˆë‹¤. ì´ì„±ìš´ì´ ì¢‹ì§€ë§Œ ë°”ëŒê¸° ì£¼ì˜!',b:'ë¬´ì—­, ìœ í†µ, íˆ¬ì, ì˜ì—…, ì¤‘ê°œì—…',lv:'ìƒ'},
    'ì •ì¬':{n:'ì •ì¬ê²©(æ­£è²¡æ ¼)',d:'ì„±ì‹¤í•˜ê³  ì €ì¶•ì„ ì˜í•©ë‹ˆë‹¤. ì •ì§í•˜ê³  ì°©ì‹¤í•œ ì„±ê²©ìœ¼ë¡œ ì‹ ìš©ì´ ì¢‹ìŠµë‹ˆë‹¤. ê¾¸ì¤€íˆ ëª¨ì•„ì„œ ë¶€ì ë˜ëŠ” íƒ€ì…ì…ë‹ˆë‹¤. ê°€ì •ì ì´ê³  ë°°ìš°ìì™€ì˜ ì¸ì—°ì´ ì¢‹ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì†Œì‹¬í•˜ê³  ì¸ìƒ‰í•´ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',b:'íšŒê³„, ê¸ˆìœµ, ê³µë¬´ì›, ê´€ë¦¬ì§',lv:'ìƒ'},
    'í¸ê´€':{n:'í¸ê´€ê²©(ä¸ƒæ®ºæ ¼)',d:'ê¶Œìœ„ì™€ ì¶”ì§„ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì¹´ë¦¬ìŠ¤ë§ˆ ìˆê³  ê²°ë‹¨ë ¥ì´ ë¹ ë¦…ë‹ˆë‹¤. ê²½ìŸì—ì„œ ì´ê¸°ê³  ì¶œì„¸í•˜ë ¤ëŠ” ìš•êµ¬ê°€ ê°•í•©ë‹ˆë‹¤. ì˜ ë‹¤ìŠ¤ë¦¬ë©´ ì¥êµ° ì¬ëª©ì´ì§€ë§Œ, ì˜ëª»í•˜ë©´ ë‹¤í˜ˆì§ˆë¡œ ì ì„ ë§ì´ ë§Œë“­ë‹ˆë‹¤.',b:'êµ°ê²½, ë²•ì¡°, ì •ì¹˜, ë¬´ìˆ , ìŠ¤í¬ì¸ ',lv:'ì¤‘'},
    'ì •ê´€':{n:'ì •ê´€ê²©(æ­£å®˜æ ¼)',d:'í’ˆìœ„ ìˆê³  ëª…ì˜ˆë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤. ê·œë²”ì„ ì˜ ì§€í‚¤ê³  ì±…ì„ê°ì´ ê°•í•©ë‹ˆë‹¤. ì¡°ì§ì—ì„œ ì¸ì •ë°›ê³  ìŠ¹ì§„ì´ ë¹ ë¦…ë‹ˆë‹¤. ê´€ì§ìš´ì´ ìˆì–´ ê³µì§ì´ë‚˜ ëŒ€ê¸°ì—…ì—ì„œ ì„±ê³µí•©ë‹ˆë‹¤. ë‹¤ë§Œ ìœµí†µì„±ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',b:'ê³µë¬´ì›, ëŒ€ê¸°ì—…, ë²•ì¡°, êµìœ¡ê³„',lv:'ìµœìƒ'},
    'í¸ì¸':{n:'í¸ì¸ê²©(åå°æ ¼/æ¢Ÿç¥æ ¼)',d:'í•™êµ¬ì ì´ê³  íƒêµ¬ì‹¬ì´ ê°•í•©ë‹ˆë‹¤. ë…íŠ¹í•œ ì‚¬ê³ ë°©ì‹ìœ¼ë¡œ ë¹„ë²”í•œ ì•„ì´ë””ì–´ë¥¼ ëƒ…ë‹ˆë‹¤. ì¢…êµ, ì² í•™, ì‹ ë¹„í•™ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤. ë‹¤ë§Œ í•œ ê°€ì§€ì— ì§‘ì¤‘ ëª»í•˜ê³  ëì„ ëª» ë§ºëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.',b:'ì—°êµ¬, ê¸°ìˆ , IT, ì¢…êµ, ì˜ë£Œ',lv:'ì¤‘'},
    'ì •ì¸':{n:'ì •ì¸ê²©(æ­£å°æ ¼)',d:'ì¸ë•ì´ ìˆê³  í•™ë¬¸ì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì–´ë¨¸ë‹ˆì™€ì˜ ì¸ì—°ì´ ê¹Šê³  ë¶€ëª¨ë•ì´ ìˆìŠµë‹ˆë‹¤. ë°°ì›€ì— ëŒ€í•œ ì—´ì •ì´ ìˆì–´ í•™ì, êµìœ¡ìì— ì í•©í•©ë‹ˆë‹¤. ì„±í’ˆì´ ì–´ì§ˆê³  ë‚¨ì„ ì˜ ëŒë´…ë‹ˆë‹¤.',b:'êµìœ¡, ì¶œíŒ, í•™ìˆ , ì¢…êµ, ë³µì§€',lv:'ìƒ'}
};

// ì™¸ê²©(å¤–æ ¼) - íŠ¹ìˆ˜ê²©êµ­ ë°ì´í„°
const FORMATS_SPECIAL = {
    'jongwang': {n:'ì¢…ì™•ê²©(å¾æ—ºæ ¼)', d:'ì¼ê°„ì˜ ê¸°ìš´ì´ ê·¹ë„ë¡œ ê°•í•˜ì—¬ ë¹„ê²ìœ¼ë¡œ ì¢…(å¾)í•˜ëŠ” ê²©ì…ë‹ˆë‹¤. ìê¸° ëœ»ëŒ€ë¡œ ì‚´ì•„ì•¼ í•˜ê³ , ë‚¨ ë°‘ì—ì„œ ì¼í•˜ë©´ ë‹µë‹µí•©ë‹ˆë‹¤. ììˆ˜ì„±ê°€í•˜ëŠ” ì‚¬ì—…ê°€, CEO, ë…ë¦½ ì „ë¬¸ê°€ì— ì í•©í•©ë‹ˆë‹¤. ê°•í•œ ìì¡´ì‹¬ê³¼ ì¶”ì§„ë ¥ìœ¼ë¡œ ì„±ê³µí•©ë‹ˆë‹¤.', b:'CEO, ì‚¬ì—…ê°€, ì •ì¹˜ì¸, ë…ë¦½ ì „ë¬¸ê°€', lv:'íŠ¹ìˆ˜'},
    'jonggang': {n:'ì¢…ê°•ê²©(å¾å¼·æ ¼)', d:'ì¼ê°„ì´ ê°•í•˜ê³  ì¸ì„±ë„ ì™•ì„±í•˜ì—¬ ì¸ì„±ìœ¼ë¡œ ì¢…í•˜ëŠ” ê²©ì…ë‹ˆë‹¤. í•™ë¬¸ê³¼ ëª…ì˜ˆë¥¼ ì¤‘ì‹œí•˜ê³  ê¶Œìœ„ìˆëŠ” ìë¦¬ì— ì˜¤ë¦…ë‹ˆë‹¤. êµìˆ˜, ì—°êµ¬ì›, ê³ ìœ„ ê³µë¬´ì›ì— ì í•©í•©ë‹ˆë‹¤.', b:'êµìˆ˜, ì—°êµ¬ì›, ê³ ìœ„ ê³µì§', lv:'íŠ¹ìˆ˜'},
    'jonga': {n:'ì¢…ì•„ê²©(å¾å…’æ ¼)', d:'ì‹ìƒì´ ê·¹ë„ë¡œ ì™•ì„±í•˜ì—¬ ì‹ìƒìœ¼ë¡œ ì¢…í•˜ëŠ” ê²©ì…ë‹ˆë‹¤. ì¬ëŠ¥ê³¼ í‘œí˜„ë ¥ì´ ë›°ì–´ë‚˜ê³  ì˜ˆìˆ , ì—°ì˜ˆ, ì°½ì‘ì—ì„œ í¬ê²Œ ì„±ê³µí•©ë‹ˆë‹¤. ììœ ë¡œìš´ ì˜í˜¼ìœ¼ë¡œ ì‚´ì•„ì•¼ í•©ë‹ˆë‹¤.', b:'ì˜ˆìˆ ê°€, ì—°ì˜ˆì¸, ì‘ê°€, í¬ë¦¬ì—ì´í„°', lv:'íŠ¹ìˆ˜'},
    'jongjae': {n:'ì¢…ì¬ê²©(å¾è²¡æ ¼)', d:'ì¬ì„±ì´ ê·¹ë„ë¡œ ì™•ì„±í•˜ì—¬ ì¬ì„±ìœ¼ë¡œ ì¢…í•˜ëŠ” ê²©ì…ë‹ˆë‹¤. ì¬ë¬¼ì„ ë‹¤ë£¨ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•˜ê³  ì‚¬ì—…ê°€, ê¸ˆìœµì¸ìœ¼ë¡œ í° ë¶€ë¥¼ ì´ë£¹ë‹ˆë‹¤. ëˆê³¼ ì¸ì—°ì´ ê¹ŠìŠµë‹ˆë‹¤.', b:'ê¸ˆìœµì¸, ì‚¬ì—…ê°€, íˆ¬ìì, ë¶€ë™ì‚°', lv:'íŠ¹ìˆ˜'},
    'jongsal': {n:'ì¢…ì‚´ê²©(å¾æ®ºæ ¼)', d:'ê´€ì‚´ì´ ê·¹ë„ë¡œ ì™•ì„±í•˜ì—¬ ê´€ì‚´ë¡œ ì¢…í•˜ëŠ” ê²©ì…ë‹ˆë‹¤. ê¶Œë ¥ê³¼ ëª…ì˜ˆë¥¼ ì¶”êµ¬í•˜ê³  ì¡°ì§ì—ì„œ ë†’ì€ ìë¦¬ì— ì˜¤ë¦…ë‹ˆë‹¤. êµ°ê²½, ì •ì¹˜ì¸, ê³ ìœ„ ì„ì›ì— ì í•©í•©ë‹ˆë‹¤.', b:'êµ°ê²½, ì •ì¹˜ì¸, ì„ì›, ë²•ì¡°ì¸', lv:'íŠ¹ìˆ˜'},
    'yangin': {n:'ì–‘ì¸ê²©(ç¾Šåˆƒæ ¼)', d:'ì¼ì§€ì— ì–‘ì¸(ç¾Šåˆƒ)ì´ ìˆì–´ ê·¹ê°•í•œ ê¸°ìš´ì„ ê°€ì§„ ê²©ì…ë‹ˆë‹¤. ê²°ë‹¨ë ¥ê³¼ ì¶”ì§„ë ¥ì´ ëŒ€ë‹¨í•˜ê³  ìœ„ê¸°ì— ê°•í•©ë‹ˆë‹¤. ì¹¼ë‚  ê°™ì€ ì„±ê²©ìœ¼ë¡œ ì ì„ ë§Œë“¤ê¸°ë„ í•˜ì§€ë§Œ, ì˜ ì“°ë©´ ì˜ì›…ì´ ë©ë‹ˆë‹¤.', b:'êµ°ì¸, ì™¸ê³¼ì˜, ë²•ì¡°ì¸, ìŠ¤í¬ì¸  ì„ ìˆ˜', lv:'íŠ¹ìˆ˜'},
    'geonrok': {n:'ê±´ë¡ê²©(å»ºç¥¿æ ¼)', d:'ì›”ì§€ê°€ ì¼ê°„ì˜ ê±´ë¡ì§€ì—¬ì„œ ê¸°ìš´ì´ ì™•ì„±í•©ë‹ˆë‹¤. ìŠ¤ìŠ¤ë¡œ ì¼ì–´ì„œëŠ” ììˆ˜ì„±ê°€í˜•ì´ê³ , ì§ì—… ì•ˆì •ì„±ì´ ì¢‹ìŠµë‹ˆë‹¤. ê¾¸ì¤€í•œ ë…¸ë ¥ìœ¼ë¡œ ì¤‘ë…„ ì´í›„ ë°œë³µí•©ë‹ˆë‹¤.', b:'ê³µë¬´ì›, ì „ë¬¸ì§, ìì˜ì—…', lv:'ìƒ'},
    'woldeok': {n:'ì›”ë•ê²©(æœˆå¾·æ ¼)', d:'ì›”ë•ê·€ì¸ì´ ìˆì–´ ë•ì´ ìˆê³  ì–´ë ¤ìš¸ ë•Œ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤. ì¸í’ˆì´ ì¢‹ê³  ì‹ ë¢°ë°›ìœ¼ë©° ê´€ì§ìš´ì´ ìˆìŠµë‹ˆë‹¤.', b:'ê³µì§, êµìœ¡, ì¢…êµ', lv:'ìƒ'}
};

// ê²©êµ­ ì„±íŒ¨(æˆæ•—) íŒë‹¨
function isFormatBroken(saju, formatGod) {
    const dm = saju.day.s;
    const dmEl = dm.e;
    const breakReasons = [];
    
    // ì •ê´€ê²© íŒŒê²© ì¡°ê±´: ìƒê´€ì´ ìˆìœ¼ë©´ íŒŒê²© (ìƒê´€ê²¬ê´€)
    if (formatGod === 'ì •ê´€') {
        const allPillars = [saju.year, saju.month, saju.day, saju.hour].filter(p => p);
        for (let p of allPillars) {
            const god = getTenGod(p.s, dm);
            if (god.k === 'ìƒê´€') {
                breakReasons.push('ìƒê´€ê²¬ê´€(å‚·å®˜è¦‹å®˜): ìƒê´€ì´ ì •ê´€ì„ ê·¹í•˜ì—¬ íŒŒê²©');
            }
        }
    }
    
    // ì‹ì‹ ê²© íŒŒê²© ì¡°ê±´: í¸ì¸ì´ ìˆìœ¼ë©´ íŒŒê²© (íš¨ì‹ íƒˆì‹)
    if (formatGod === 'ì‹ì‹ ') {
        const allPillars = [saju.year, saju.month, saju.day, saju.hour].filter(p => p);
        for (let p of allPillars) {
            const god = getTenGod(p.s, dm);
            if (god.k === 'í¸ì¸') {
                breakReasons.push('íš¨ì‹ íƒˆì‹(æ¢Ÿç¥å¥ªé£Ÿ): í¸ì¸ì´ ì‹ì‹ ì„ ê·¹í•˜ì—¬ íŒŒê²©');
            }
        }
    }
    
    // ì¬ê²© íŒŒê²© ì¡°ê±´: ë¹„ê²ì´ ë§ìœ¼ë©´ íŒŒê²© (êµ°ê²ìŸì¬)
    if (formatGod === 'ì •ì¬' || formatGod === 'í¸ì¬') {
        let biCount = 0;
        const allPillars = [saju.year, saju.month, saju.day, saju.hour].filter(p => p);
        for (let p of allPillars) {
            const god = getTenGod(p.s, dm);
            if (god.k === 'ë¹„ê²¬' || god.k === 'ê²ì¬') biCount++;
        }
        if (biCount >= 2) {
            breakReasons.push('êµ°ê²ìŸì¬(ç¾¤åŠ«çˆ­è²¡): ë¹„ê²ì´ ë§ì•„ ì¬ë¥¼ ë¹¼ì•—ê¹€');
        }
    }
    
    return breakReasons;
}

// íŠ¹ìˆ˜ê²© (ì¢…ê²©) íŒì •
function checkSpecialFormat(saju, strength) {
    if (!strength.extreme) return null;
    
    const dm = saju.day.s;
    const ec = countElements(saju);
    const allPillars = [saju.year, saju.month, saju.day, saju.hour].filter(p => p);
    
    // ì˜¤í–‰ë³„ ì‹­ì‹  ê°œìˆ˜ ì„¸ê¸°
    const godCounts = {bigeop:0, sikSang:0, jae:0, gwan:0, in:0};
    
    allPillars.forEach(p => {
        const god = getTenGod(p.s, dm);
        if (['ë¹„ê²¬','ê²ì¬'].includes(god.k)) godCounts.bigeop++;
        if (['ì‹ì‹ ','ìƒê´€'].includes(god.k)) godCounts.sikSang++;
        if (['í¸ì¬','ì •ì¬'].includes(god.k)) godCounts.jae++;
        if (['í¸ê´€','ì •ê´€'].includes(god.k)) godCounts.gwan++;
        if (['í¸ì¸','ì •ì¸'].includes(god.k)) godCounts.in++;
    });
    
    if (strength.extreme === 'ê·¹ì‹ ê°•') {
        // ì¢…ì™•ê²©: ë¹„ê²ì´ ë§¤ìš° ë§ìŒ
        if (godCounts.bigeop >= 3) return FORMATS_SPECIAL.jongwang;
        // ì¢…ê°•ê²©: ì¸ì„±ì´ ë§¤ìš° ë§ìŒ
        if (godCounts.in >= 2 && godCounts.bigeop >= 2) return FORMATS_SPECIAL.jonggang;
    }
    
    if (strength.extreme === 'ê·¹ì‹ ì•½') {
        // ì¢…ì•„ê²©: ì‹ìƒì´ ë§¤ìš° ë§ìŒ
        if (godCounts.sikSang >= 3) return FORMATS_SPECIAL.jonga;
        // ì¢…ì¬ê²©: ì¬ì„±ì´ ë§¤ìš° ë§ìŒ
        if (godCounts.jae >= 3) return FORMATS_SPECIAL.jongjae;
        // ì¢…ì‚´ê²©: ê´€ì‚´ì´ ë§¤ìš° ë§ìŒ
        if (godCounts.gwan >= 3) return FORMATS_SPECIAL.jongsal;
    }
    
    return null;
}

// ì–‘ì¸ê²©, ê±´ë¡ê²© ì²´í¬
function checkYangInGeonRok(saju) {
    const dm = saju.day.s;
    const dsi = STEM.indexOf(dm);
    const mbi = BRANCH.indexOf(saju.month.b);
    
    // ê±´ë¡ ìœ„ì¹˜ (ì¼ê°„ë³„ ê±´ë¡ì§€)
    const geonrokMap = {0:2, 1:3, 2:5, 3:6, 4:5, 5:6, 6:8, 7:9, 8:11, 9:0}; // ê°‘-ì¸, ì„-ë¬˜...
    // ì–‘ì¸ ìœ„ì¹˜ (ê±´ë¡ ë‹¤ìŒ)
    const yanginMap = {0:3, 1:2, 2:6, 3:5, 4:6, 5:5, 6:9, 7:8, 8:0, 9:11}; // ê°‘-ë¬˜, ì„-ì¸...
    
    // ì›”ì§€ê°€ ê±´ë¡ì§€ë©´ ê±´ë¡ê²©
    if (mbi === geonrokMap[dsi]) {
        return FORMATS_SPECIAL.geonrok;
    }
    
    // ì¼ì§€ê°€ ì–‘ì¸ì´ë©´ ì–‘ì¸ê²©
    const dbi = BRANCH.indexOf(saju.day.b);
    if (dbi === yanginMap[dsi]) {
        return {...FORMATS_SPECIAL.yangin, hasYangIn: true};
    }
    
    return null;
}

// í†µí•© ê²©êµ­ íŒì •
function calcFormat(saju, strength) {
    const str = strength || calcStrength(saju);
    
    // 1. íŠ¹ìˆ˜ê²© ì²´í¬
    const specialFormat = checkSpecialFormat(saju, str);
    if (specialFormat) {
        return {...specialFormat, type:'special', god:'íŠ¹ìˆ˜'};
    }
    
    // 2. ì–‘ì¸ê²©/ê±´ë¡ê²© ì²´í¬
    const yangInGeonRok = checkYangInGeonRok(saju);
    if (yangInGeonRok && yangInGeonRok.n.includes('ì–‘ì¸')) {
        return {...yangInGeonRok, type:'special', god:'ì–‘ì¸'};
    }
    
    // 3. ë‚´ê²© íŒì • (ì›”ì§€ ì§€ì¥ê°„ ì •ê¸°ì˜ ì‹­ì‹ )
    const mbi = BRANCH.indexOf(saju.month.b);
    const jj = JIJANGGAN[mbi];
    
    // ì •ê¸°(ë³¸ê¸°) ì°¾ê¸°
    const mainJj = jj.find(j => j.days >= 16) || jj[jj.length - 1];
    const mainStem = STEM[mainJj.stem];
    const god = getTenGod(mainStem, saju.day.s);
    
    // ì›”ê°„ ì‹­ì‹ ë„ ì²´í¬ (íˆ¬ì¶œ ì—¬ë¶€)
    const monthGod = getTenGod(saju.month.s, saju.day.s);
    
    // íˆ¬ì¶œëœ ì‹­ì‹ ì´ ìˆìœ¼ë©´ ê·¸ê±¸ ê²©êµ­ìœ¼ë¡œ
    let finalGod = god.k;
    if (['ì‹ì‹ ','ìƒê´€','í¸ì¬','ì •ì¬','í¸ê´€','ì •ê´€','í¸ì¸','ì •ì¸'].includes(monthGod.k)) {
        // ì›”ê°„ì´ ì›”ì§€ ì§€ì¥ê°„ì— í†µê·¼í•˜ëŠ”ì§€ í™•ì¸
        const monthStemIdx = STEM.indexOf(saju.month.s);
        if (jj.some(j => j.stem === monthStemIdx)) {
            finalGod = monthGod.k; // íˆ¬ì¶œëœ ì‹­ì‹ ì´ ê²©êµ­
        }
    }
    
    // ê±´ë¡ê²© ì²´í¬
    if (yangInGeonRok && yangInGeonRok.n.includes('ê±´ë¡')) {
        return {...yangInGeonRok, type:'inner', god:'ê±´ë¡'};
    }
    
    // 4. íŒŒê²© ì—¬ë¶€ ì²´í¬
    const breakReasons = isFormatBroken(saju, finalGod);
    
    const f = FORMATS_INNER[finalGod] || FORMATS_INNER['ì •ê´€'];
    return {
        ...f,
        god: finalGod,
        type: 'inner',
        broken: breakReasons.length > 0,
        breakReasons,
        tougan: monthGod.k !== god.k ? monthGod.k : null
    };
}

// ê¸°ì¡´ ë‹¨ìˆœ ë²„ì „ (í˜¸í™˜ìš©)
function calcFormatSimple(saju) {
    const god = getTenGod(saju.month.s, saju.day.s);
    const f = FORMATS_INNER[god.k] || FORMATS_INNER['ì •ê´€'];
    f.god = god.k;
    return f;
}

function getIljuDesc(ds, db) {
    // 60ê°‘ì ì¼ì£¼ ìƒì„¸ í•´ì„¤
    const iljuData = {
        'ç”²å­':{t:'ç”²å­(ê°‘ì)ì¼ì£¼ - ë°”ë‹¤ ìœ„ì˜ í° ë‚˜ë¬´',d:'å­æ°´ê°€ ç”²æœ¨ì„ ìƒí•´ì£¼ë‹ˆ ì´ëª…í•˜ê³  í•™ë¬¸ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ë¨¸ë¦¬ê°€ ì¢‹ê³  ê³„íšì„±ì´ ìˆìœ¼ë‚˜ ë•Œë¡œëŠ” ê±±ì •ì´ ë§ìŠµë‹ˆë‹¤. ë°¤ì— íƒœì–´ë‚˜ë©´ ë”ìš± ì¢‹ê³ , ë°°ìš°ìì™€ ì •ì´ ê¹ŠìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ë‚´ì¡°ë¥¼ ì˜í•©ë‹ˆë‹¤. ì—°í•˜ì™€ ì˜ ë§ìœ¼ë©° ë¬¼ê°€ì—ì„œ ì¸ì—°ì„ ë§Œë‚˜ê¸° ì‰½ìŠµë‹ˆë‹¤.'},
        'ç”²å¯…':{t:'ç”²å¯…(ê°‘ì¸)ì¼ì£¼ - í˜¸ë‘ì´ ë“±ì— íƒ„ ë‚˜ë¬´',d:'ì¼ê°„ê³¼ ì¼ì§€ê°€ ê°™ì€ ì˜¤í–‰ìœ¼ë¡œ ìì¡´ì‹¬ì´ ì„¸ê³  ë…ë¦½ì‹¬ì´ ê°•í•©ë‹ˆë‹¤. ì¥ë‚¨ì¥ë…€ ê¸°ì§ˆì´ ìˆê³  ë¦¬ë”ì‹­ì´ ìˆìŠµë‹ˆë‹¤. ê³ ì§‘ì´ ì„¸ê³  ë‚¨ì—ê²Œ ì§€ê¸° ì‹«ì–´í•©ë‹ˆë‹¤.',s:'ë°°ìš°ìë„ ìì¡´ì‹¬ì´ ì„¸ì„œ ë¶€ë”ªí ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œ ì–‘ë³´í•˜ëŠ” ìì„¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.'},
        'ç”²è¾°':{t:'ç”²è¾°(ê°‘ì§„)ì¼ì£¼ - ìš©ì„ íƒ€ê³  ì˜¤ë¥´ëŠ” ë‚˜ë¬´',d:'ì§„í† ê°€ ëª©ì˜ ë¿Œë¦¬ê°€ ë˜ì–´ ì¬ëŠ¥ì´ í’ë¶€í•©ë‹ˆë‹¤. ì•¼ë§ì´ í¬ê³  ì¶œì„¸ìš•ì´ ìˆìŠµë‹ˆë‹¤. ë¬¸ì°½ì˜ ê¸°ìš´ì´ ìˆì–´ í•™ë¬¸ì— ëŠ¥í•˜ë©°, ì‚¬íšŒì ìœ¼ë¡œ ì¸ì •ë°›ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ì¬ë¬¼ë³µì´ ìˆìŠµë‹ˆë‹¤. í† ë¼, ë‹­ë ì™€ ê¶í•©ì´ ì¢‹ìŠµë‹ˆë‹¤.'},
        'ç”²åˆ':{t:'ç”²åˆ(ê°‘ì˜¤)ì¼ì£¼ - íƒœì–‘ ì•„ë˜ ìš°ëš ì„  ë‚˜ë¬´',d:'ëª©ìƒí™”ë¡œ ì¬ëŠ¥ì„ ë°œíœ˜í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. í™”ë ¤í•˜ê³  ì˜ˆìˆ ì  ê°ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì„±ê²©ì´ ê¸‰í•˜ê³  ì—´ì •ì ì´ë©° ì¸ê¸°ê°€ ë§ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ í™œë°œí•˜ê³  ì‚¬êµì ì…ë‹ˆë‹¤. ë¶ˆê°™ì€ ì„±ê²©ìœ¼ë¡œ ë‹¤íˆ¼ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ì„œë¡œ ì¡´ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤.'},
        'ç”²ç”³':{t:'ç”²ç”³(ê°‘ì‹ )ì¼ì£¼ - ë„ë¼ë¥¼ ë§ëŠ” ë‚˜ë¬´',d:'ê¸ˆê·¹ëª©ìœ¼ë¡œ ì¸ìƒì— ì‹œë ¨ì´ ìˆì§€ë§Œ ì´ë¥¼ ê·¹ë³µí•˜ë©´ ê°•í•´ì§‘ë‹ˆë‹¤. ê²°ë‹¨ë ¥ê³¼ ì¶”ì§„ë ¥ì´ ìƒê¸°ë©° ì—­ê²½ì— ê°•í•©ë‹ˆë‹¤. ì§ì¥ìš´ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ê°ˆë“±ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì„±ê²©ì„ ì¸ì •í•˜ê³  ë°°ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.'},
        'ç”²æˆŒ':{t:'ç”²æˆŒ(ê°‘ìˆ )ì¼ì£¼ - ê°€ì„ ì‚°ì˜ ë‚˜ë¬´',d:'ìˆ í†  ì†ì˜ ê¸ˆê¸°ìš´ì´ ëª©ì„ ê·¹í•˜ì—¬ ê³ ë…í•´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ìˆê³  ì¢…êµ, ì² í•™ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤. ëŠ¦ê²Œ í•„ íƒ€ì…ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ì˜ ì¸ì—°ì´ ëŠ¦ê±°ë‚˜ ì‚¬ë³„, ì´ë³„ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤.'},
        'ä¹™ä¸‘':{t:'ä¹™ä¸‘(ì„ì¶•)ì¼ì£¼ - ê²¨ìš¸ ë•…ì˜ ì‘ì€ í’€',d:'ì¶•í† ê°€ ì„ëª©ì˜ ë¿Œë¦¬ê°€ ë˜ì–´ ëˆê¸°ê°€ ìˆìŠµë‹ˆë‹¤. ì„±ì‹¤í•˜ê³  í˜„ì‹¤ì ì´ë©° ì°©ì‹¤í•˜ê²Œ ì¬ë¬¼ì„ ëª¨ìë‹ˆë‹¤. ë‹¤ë§Œ ë‚´ì„±ì ì´ê³  ì†Œê·¹ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ê²½ì œì ìœ¼ë¡œ ì•ˆì •ì ì…ë‹ˆë‹¤.'},
        'ä¹™å¯':{t:'ä¹™å¯(ì„ë¬˜)ì¼ì£¼ - ë´„ë‚ ì˜ ê½ƒ',d:'ì¼ê°„ê³¼ ì¼ì§€ê°€ ê°™ì•„ ìê¸° ì£¼ê´€ì´ ëšœë ·í•©ë‹ˆë‹¤. ì„¬ì„¸í•˜ê³  ì˜ˆìˆ ì ì´ë©° ì¸ê¸°ê°€ ë§ìŠµë‹ˆë‹¤. ë¶€ë“œëŸ¬ìš´ ì™¸ëª¨ì™€ ë‹¬ë¦¬ ê³ ì§‘ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìì‹ ê³¼ ë¹„ìŠ·í•œ ì„±í–¥ì…ë‹ˆë‹¤. ì„œë¡œ ì¡´ì¤‘í•˜ë©´ ì¢‹ì€ ì¸ì—°ì…ë‹ˆë‹¤.'},
        'ä¹™å·³':{t:'ä¹™å·³(ì„ì‚¬)ì¼ì£¼ - íƒœì–‘ì„ ë°›ëŠ” ê½ƒ',d:'ëª©ìƒí™”ë¡œ ì¬ëŠ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤. ì´ëª…í•˜ê³  ì–¸ë³€ì´ ì¢‹ìœ¼ë©° ì‚¬êµì„±ì´ ìˆìŠµë‹ˆë‹¤. ì´ì„±ì—ê²Œ ì¸ê¸°ê°€ ë§ê³  ì—°ì• ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ í™”ëˆí•˜ê³  ì—´ì •ì ì…ë‹ˆë‹¤. ë°”ëŒê¸° ì£¼ì˜!'},
        'ä¹™æœª':{t:'ä¹™æœª(ì„ë¯¸)ì¼ì£¼ - ì—¬ë¦„ ì •ì›ì˜ í™”ì´ˆ',d:'ëª©ê·¹í† ë¡œ ì¬ë¬¼ì„ ì·¨í•˜ë‹ˆ ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ìŠµë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ê³¼ ì¬í…Œí¬ ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì—¬ì„±ì—ê²Œ íŠ¹íˆ ì¢‹ì€ ì¼ì£¼ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìˆœí•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤. ê²°í˜¼ í›„ ì¬ë¬¼ì´ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.'},
        'ä¹™é…‰':{t:'ä¹™é…‰(ì„ìœ )ì¼ì£¼ - ê°€ì„ ì„œë¦¬ ë§ëŠ” ê½ƒ',d:'ê¸ˆê·¹ëª©ìœ¼ë¡œ ì‹œë ¨ì´ ìˆì§€ë§Œ ì¸ë‚´í•˜ë©´ ì„±ê³µí•©ë‹ˆë‹¤. ì˜ˆë¦¬í•˜ê³  ë¹„íŒì ì´ë©° ì§ì—…ì¸ìœ¼ë¡œ ì„±ê³µí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ê°ˆë“±ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œ ë§ì¶°ê°€ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.'},
        'ä¹™äº¥':{t:'ä¹™äº¥(ì„í•´)ì¼ì£¼ - ë¬¼ ìœ„ì— ëœ¬ ë¶€í‰ì´ˆ',d:'ìˆ˜ìƒëª©ìœ¼ë¡œ ì¬ëŠ¥ì´ í’ë¶€í•©ë‹ˆë‹¤. ì§€í˜œë¡­ê³  í•™ë¬¸ì— ëŠ¥í•˜ë©° ê·€ì¸ì˜ ë„ì›€ì„ ë°›ê¸° ì‰½ìŠµë‹ˆë‹¤. ìœ ì—°í•˜ê³  ì ì‘ë ¥ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ìƒí™œë ¥ì´ ê°•í•©ë‹ˆë‹¤.'},
        'ä¸™å­':{t:'ä¸™å­(ë³‘ì)ì¼ì£¼ - ë°¤í•˜ëŠ˜ì˜ íƒœì–‘',d:'ìˆ˜ê·¹í™”ë¡œ ì‹œë ¨ì´ ìˆì§€ë§Œ ì´ë¥¼ ê·¹ë³µí•˜ëŠ” í˜ì´ ìˆìŠµë‹ˆë‹¤. ì°¨ê°€ìš´ ë¬¼ì— ë¹„ì¹œ ë”°ëœ»í•œ íƒœì–‘ì²˜ëŸ¼ ì´ì¤‘ì„±ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ì„±ê²© ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œ ë³´ì™„í•˜ë©´ ì¢‹ì€ ì¸ì—°ì…ë‹ˆë‹¤.'},
        'ä¸™å¯…':{t:'ä¸™å¯…(ë³‘ì¸)ì¼ì£¼ - ë™ìª½ì—ì„œ ë– ì˜¤ë¥´ëŠ” íƒœì–‘',d:'ëª©ìƒí™”ë¡œ ì¬ëŠ¥ì´ ë¹›ë‚˜ëŠ” ì¼ì£¼ì…ë‹ˆë‹¤. ë°ê³  í™œê¸°ì°¨ë©° ë¦¬ë”ì‹­ì´ ìˆìŠµë‹ˆë‹¤. ì´ë¥¸ ì•„ì¹¨ íƒœì–‘ì²˜ëŸ¼ í¬ë§ê³¼ ì—ë„ˆì§€ë¥¼ ì¤ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ë“ ë“ í•©ë‹ˆë‹¤. ì¢‹ì€ ë‚´ì¡°ë¥¼ ë°›ìŠµë‹ˆë‹¤.'},
        'ä¸™è¾°':{t:'ä¸™è¾°(ë³‘ì§„)ì¼ì£¼ - êµ¬ë¦„ ìœ„ì˜ íƒœì–‘',d:'ì§„í† ê°€ í™”ì˜ ê¸°ìš´ì„ ì„¤ê¸°í•˜ì—¬ ì¬ëŠ¥ì„ í¼ì¹˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. ì•¼ë§ì´ í¬ê³  ì‚¬íšŒì  ì„±ê³µì„ ì´ë£¨ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì•ˆì •ì ì´ê³  ì¬ë¬¼ë³µì´ ìˆìŠµë‹ˆë‹¤.'},
        'ä¸™åˆ':{t:'ä¸™åˆ(ë³‘ì˜¤)ì¼ì£¼ - í•œë‚®ì˜ íƒœì–‘',d:'í™”ì˜ ê¸°ìš´ì´ ê·¹ì— ë‹¬í•´ ì—´ì •ì ì´ê³  í™œë°œí•©ë‹ˆë‹¤. ì„±ê²©ì´ ê¸‰í•˜ê³  ìŠ¹ë¶€ìš•ì´ ê°•í•©ë‹ˆë‹¤. ë¦¬ë” ìì§ˆì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìë„ í™”ëˆí•œ ì„±ê²©ì…ë‹ˆë‹¤. ë‹¤íˆ¼ë„ ìˆì§€ë§Œ ì—´ì •ì ì¸ ì‚¬ë‘ì…ë‹ˆë‹¤.'},
        'ä¸™ç”³':{t:'ä¸™ç”³(ë³‘ì‹ )ì¼ì£¼ - ì €ë…ë…¸ì„',d:'í™”ê·¹ê¸ˆìœ¼ë¡œ ëˆì„ ë²Œ ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ê³  ì¬ë¬¼ìš´ì´ ìˆìŠµë‹ˆë‹¤. ë§ë…„ì— ì¢‹ì•„ì§€ëŠ” íƒ€ì…ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì¬ëŠ¥ì´ ìˆê³  ëˆì„ ì˜ ë²•ë‹ˆë‹¤.'},
        'ä¸™æˆŒ':{t:'ä¸™æˆŒ(ë³‘ìˆ )ì¼ì£¼ - ì‚° ìœ„ì˜ ë´‰í™”ë¶ˆ',d:'ìˆ í† ê°€ í™”ë¥¼ ì„¤ê¸°í•˜ì—¬ ì•ˆì •ì ì…ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê³  ì±…ì„ê°ì´ ìˆìœ¼ë©° ì‹ ë¢°ë°›ìŠµë‹ˆë‹¤. ì¢…êµ, ì² í•™ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ë¯¿ìŒì§í•©ë‹ˆë‹¤. ëŠ¦ì€ ê²°í˜¼ì´ ì¢‹ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'ä¸ä¸‘':{t:'ä¸ä¸‘(ì •ì¶•)ì¼ì£¼ - ë“±ë¶ˆ',d:'ì¶•í† ê°€ í™”ë¥¼ ì„¤ê¸°í•˜ì—¬ ì°¨ë¶„í•©ë‹ˆë‹¤. ë‚´ì„±ì ì´ì§€ë§Œ ë”°ëœ»í•œ ë§ˆìŒì„ ê°€ì¡ŒìŠµë‹ˆë‹¤. ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ëŠ” íƒ€ì…ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì„±ì‹¤í•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤. ì•ˆì •ì ì¸ ê²°í˜¼ìƒí™œì…ë‹ˆë‹¤.'},
        'ä¸å¯':{t:'ä¸å¯(ì •ë¬˜)ì¼ì£¼ - ìˆ²ì†ì˜ ë°˜ë”§ë¶ˆ',d:'ëª©ìƒí™”ë¡œ ì¬ëŠ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ì´ ìˆê³  ì„¬ì„¸í•©ë‹ˆë‹¤. ê·€ì¸ì˜ ë„ì›€ì„ ë°›ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë‹¤ì •í•˜ê³  ì˜ˆìˆ ì ì…ë‹ˆë‹¤.'},
        'ä¸å·³':{t:'ä¸å·³(ì •ì‚¬)ì¼ì£¼ - íƒ€ì˜¤ë¥´ëŠ” ì´›ë¶ˆ',d:'í™”ì˜ ê¸°ìš´ì´ ê°•í•´ ì—´ì •ì ì…ë‹ˆë‹¤. ì§‘ì¤‘ë ¥ì´ ì¢‹ê³  í•œ ë¶„ì•¼ì—ì„œ ì„±ê³µí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ì„±ê²©ì´ ê¸‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì—´ì •ì ì´ê³  í™œë™ì ì…ë‹ˆë‹¤.'},
        'ä¸æœª':{t:'ä¸æœª(ì •ë¯¸)ì¼ì£¼ - ì €ë…ë…¸ì„',d:'í™”ìƒí† ë¡œ ìì‹ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤. ë”°ëœ»í•˜ê³  í¬ìš©ë ¥ì´ ìˆìœ¼ë©° ë‚¨ì„ ì˜ ëŒë´…ë‹ˆë‹¤. ì¢…êµ, ë´‰ì‚¬ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìˆœí•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'ä¸é…‰':{t:'ä¸é…‰(ì •ìœ )ì¼ì£¼ - ë³´ì„ì„ ë…¹ì´ëŠ” ë¶ˆê½ƒ',d:'í™”ê·¹ê¸ˆìœ¼ë¡œ ì¬ë¬¼ì„ ë‹¤ë£¨ëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì†ì¬ì£¼ê°€ ì¢‹ê³  ê¸°ìˆ ì§ì— ì í•©í•©ë‹ˆë‹¤. ê¹Œë‹¤ë¡­ê³  ì™„ë²½ì£¼ì˜ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì¬ëŠ¥ì´ ìˆì§€ë§Œ ì„±ê²© ë§ì¶”ê¸°ê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'ä¸äº¥':{t:'ä¸äº¥(ì •í•´)ì¼ì£¼ - ë°”ë‹¤ ìœ„ì˜ ë“±ëŒ€',d:'ìˆ˜ê·¹í™”ë¡œ ì‹œë ¨ì´ ìˆì§€ë§Œ ì‚¬ëŒë“¤ì—ê²Œ í¬ë§ì„ ì£¼ëŠ” ì¡´ì¬ì…ë‹ˆë‹¤. ì§€í˜œë¡­ê³  ê¹Šì€ ìƒê°ì„ í•©ë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ì„±ê²© ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'æˆŠå­':{t:'æˆŠå­(ë¬´ì)ì¼ì£¼ - ë¬¼ê°€ì˜ ë‘‘',d:'í† ê·¹ìˆ˜ë¡œ ì¬ë¬¼ì„ ì·¨í•©ë‹ˆë‹¤. ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ê³  ì¬ë¬¼ìš´ì´ ìˆìŠµë‹ˆë‹¤. í˜„ì‹¤ì ì´ê³  ê³„ì‚°ì´ ë¹ ë¦…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ìƒí™œë ¥ì´ ìˆìŠµë‹ˆë‹¤.'},
        'æˆŠå¯…':{t:'æˆŠå¯…(ë¬´ì¸)ì¼ì£¼ - ìˆ²ì†ì˜ ì‚°',d:'ëª©ê·¹í† ì´ì§€ë§Œ ë¿Œë¦¬ê°€ ì‚°ì„ ê°ì‹¸ì•ˆìŠµë‹ˆë‹¤. ì¸ë•ì´ ìˆê³  ê·€ì¸ì˜ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤. í•™ë¬¸ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë˜‘ë˜‘í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'æˆŠè¾°':{t:'æˆŠè¾°(ë¬´ì§„)ì¼ì£¼ - ìš©ì´ ê¹ƒë“  ì‚°',d:'í† ì˜ ê¸°ìš´ì´ ê°•í•´ ë“¬ì§í•˜ê³  ì‹ ë¢°ë°›ìŠµë‹ˆë‹¤. ì•¼ë§ì´ í¬ê³  ì¶œì„¸ìš•ì´ ìˆìŠµë‹ˆë‹¤. ì¬ë¬¼ìš´ê³¼ ê´€ì§ìš´ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë¯¿ìŒì§í•˜ê³  ì•ˆì •ì ì…ë‹ˆë‹¤.'},
        'æˆŠåˆ':{t:'æˆŠåˆ(ë¬´ì˜¤)ì¼ì£¼ - íƒœì–‘ ë¹› ë°›ëŠ” ëŒ€ì§€',d:'í™”ìƒí† ë¡œ ì—ë„ˆì§€ê°€ ë„˜ì¹©ë‹ˆë‹¤. í™œë°œí•˜ê³  ì‚¬êµì ì´ë©° ì¸ê¸°ê°€ ë§ìŠµë‹ˆë‹¤. ì¼ì° ì„±ê³µí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë°ê³  í™œê¸°ì°¹ë‹ˆë‹¤.'},
        'æˆŠç”³':{t:'æˆŠç”³(ë¬´ì‹ )ì¼ì£¼ - ê´‘ì‚°ì˜ ì‚°',d:'í† ìƒê¸ˆìœ¼ë¡œ ì¬ë¬¼ì„ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤. ì‚¬ì—… ìˆ˜ì™„ì´ ì¢‹ê³  ì¬í…Œí¬ ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì‹¤ìš©ì ì´ê³  í˜„ì‹¤ì ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì´ëª…í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'æˆŠæˆŒ':{t:'æˆŠæˆŒ(ë¬´ìˆ )ì¼ì£¼ - ë†’ì€ ì‚°',d:'í† ì˜ ê¸°ìš´ì´ ê·¹ì— ë‹¬í•´ ê³ ì§‘ì´ ì„¸ê³  ëšì‹¬ì´ ìˆìŠµë‹ˆë‹¤. í•œë²ˆ ê²°ì‹¬í•˜ë©´ ëê¹Œì§€ ë°€ê³  ë‚˜ê°‘ë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ê³ ì§‘ ì‹¸ì›€ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–‘ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.'},
        'å·±ä¸‘':{t:'å·±ä¸‘(ê¸°ì¶•)ì¼ì£¼ - ë¹„ì˜¥í•œ ì „ë‹µ',d:'í† ì˜ ê¸°ìš´ì´ ë‘ ë°°ë¡œ ì•ˆì •ì ì´ê³  ì°©ì‹¤í•©ë‹ˆë‹¤. ë¶€ë™ì‚°ìš´ì´ ìˆê³  ì €ì¶•ì„ ì˜í•©ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì„±ì‹¤í•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'å·±å¯':{t:'å·±å¯(ê¸°ë¬˜)ì¼ì£¼ - ì •ì›ì˜ í™',d:'ëª©ê·¹í† ì´ì§€ë§Œ í™”ì´ˆë¥¼ ê¸°ë¥´ëŠ” ì¢‹ì€ í™ì…ë‹ˆë‹¤. ìì‹ìš´ì´ ì¢‹ê³  ì¸ë•ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë˜‘ë˜‘í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'å·±å·³':{t:'å·±å·³(ê¸°ì‚¬)ì¼ì£¼ - ë”°ëœ»í•œ ëŒ€ì§€',d:'í™”ìƒí† ë¡œ ê·€ì¸ì˜ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤. ì´ëª…í•˜ê³  ì¬ëŠ¥ì´ ë§ìŠµë‹ˆë‹¤. ì¸ê¸°ê°€ ìˆê³  ì‚¬êµì„±ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë°ê³  í™œë°œí•©ë‹ˆë‹¤.'},
        'å·±æœª':{t:'å·±æœª(ê¸°ë¯¸)ì¼ì£¼ - ì—¬ë¦„ ì •ì›',d:'í† ì˜ ê¸°ìš´ì´ ë‘ ë°°ë¡œ ì°©ì‹¤í•©ë‹ˆë‹¤. ë¶€ë™ì‚°ìš´ì´ ì¢‹ê³  ë§ë…„ì´ í¸ì•ˆí•©ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìˆœí•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'å·±é…‰':{t:'å·±é…‰(ê¸°ìœ )ì¼ì£¼ - ê°€ì„ ë“¤íŒ',d:'í† ìƒê¸ˆìœ¼ë¡œ ì¬ë¬¼ì„ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤. ì¬ëŠ¥ì´ ìˆê³  ì˜ˆìˆ ì  ê°ê°ì´ ìˆìŠµë‹ˆë‹¤. ê²°ì‹¤ì„ ë§ºê¸° ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì´ëª…í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'å·±äº¥':{t:'å·±äº¥(ê¸°í•´)ì¼ì£¼ - ë¬¼ê°€ì˜ ë‘‘',d:'í† ê·¹ìˆ˜ë¡œ ì¬ë¬¼ì„ ì·¨í•©ë‹ˆë‹¤. ì§€í˜œë¡­ê³  ê³„ì‚°ì´ ë¹ ë¦…ë‹ˆë‹¤. ì¥ì‚¬ ìˆ˜ì™„ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìƒí™œë ¥ì´ ê°•í•©ë‹ˆë‹¤.'},
        'åºšå­':{t:'åºšå­(ê²½ì)ì¼ì£¼ - ê²¨ìš¸ ë°”ë‹¤ì˜ ë°”ìœ„',d:'ê¸ˆìƒìˆ˜ë¡œ ì§€í˜œê°€ ë›°ì–´ë‚©ë‹ˆë‹¤. ë¨¸ë¦¬ê°€ ì¢‹ê³  í•™ë¬¸ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ëƒ‰ì² í•˜ê³  ë¶„ì„ì ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ì´ëª…í•©ë‹ˆë‹¤.'},
        'åºšå¯…':{t:'åºšå¯…(ê²½ì¸)ì¼ì£¼ - ìˆ²ì†ì˜ ë°”ìœ„',d:'ê¸ˆê·¹ëª©ìœ¼ë¡œ ëˆì„ ë²„ëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ê²°ë‹¨ë ¥ì´ ìˆê³  ì¶”ì§„ë ¥ì´ ê°•í•©ë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ë¶€ë”ªí ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë¡œ ì–‘ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.'},
        'åºšè¾°':{t:'åºšè¾°(ê²½ì§„)ì¼ì£¼ - ìš©ì„ íƒ„ ê²€ê°',d:'í† ìƒê¸ˆìœ¼ë¡œ ê·€ì¸ì˜ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤. ì¶œì„¸ìš´ì´ ìˆê³  ì‚¬íšŒì ìœ¼ë¡œ ì„±ê³µí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë¯¿ìŒì§í•˜ê³  ë“ ë“ í•©ë‹ˆë‹¤.'},
        'åºšåˆ':{t:'åºšåˆ(ê²½ì˜¤)ì¼ì£¼ - ë¶ˆì— ë‹¬êµ° ì‡ ',d:'í™”ê·¹ê¸ˆìœ¼ë¡œ ì—°ë‹¨ì„ ê±°ì¹˜ë©´ ê°•í•´ì§‘ë‹ˆë‹¤. ì‹œë ¨ì„ ê·¹ë³µí•˜ë©´ í° ì„±ê³µì„ ì´ë£¹ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ í™œë°œí•˜ì§€ë§Œ ì¶©ëŒì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'åºšç”³':{t:'åºšç”³(ê²½ì‹ )ì¼ì£¼ - ê°•ì² ',d:'ê¸ˆì˜ ê¸°ìš´ì´ ê·¹ì— ë‹¬í•´ ê°•ì¸í•©ë‹ˆë‹¤. ê²°ë‹¨ë ¥ê³¼ ì‹¤í–‰ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë¬´ì¸ ê¸°ì§ˆì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìë„ ê°•í•œ ì„±ê²©ì…ë‹ˆë‹¤. ì„œë¡œ ì¡´ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤.'},
        'åºšæˆŒ':{t:'åºšæˆŒ(ê²½ìˆ )ì¼ì£¼ - ì‚°ì†ì˜ ê´‘ì„',d:'í† ìƒê¸ˆìœ¼ë¡œ ë¿Œë¦¬ê°€ ê¹ŠìŠµë‹ˆë‹¤. ëŠ¦ê²Œ í”¼ì§€ë§Œ í° ì„±ê³µì„ ì´ë£¹ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ì•ˆì •ì ì…ë‹ˆë‹¤.'},
        'è¾›ä¸‘':{t:'è¾›ä¸‘(ì‹ ì¶•)ì¼ì£¼ - ë•…ì†ì˜ ë³´ì„',d:'í† ìƒê¸ˆìœ¼ë¡œ ê·€í•œ ì¬ëŠ¥ì´ ë¬»í˜€ ìˆìŠµë‹ˆë‹¤. ëŠ¦ê²Œ ì¸ì •ë°›ì§€ë§Œ ëì— ë¹›ë‚©ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì„±ì‹¤í•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'è¾›å¯':{t:'è¾›å¯(ì‹ ë¬˜)ì¼ì£¼ - ë‚˜ë¬´ì— ê±¸ë¦° ë³´ì„',d:'ê¸ˆê·¹ëª©ìœ¼ë¡œ ëˆì„ ë²„ëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì„¬ì„¸í•˜ê³  ì˜ˆìˆ ì  ê°ê°ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë‹¤ì •í•˜ì§€ë§Œ ê°ˆë“±ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'è¾›å·³':{t:'è¾›å·³(ì‹ ì‚¬)ì¼ì£¼ - ìš©ê´‘ë¡œì˜ ê¸ˆ',d:'í™”ê·¹ê¸ˆìœ¼ë¡œ ì—°ë‹¨ì„ ê±°ì¹©ë‹ˆë‹¤. ì‹œë ¨ì„ ê·¹ë³µí•˜ë©´ ë¹›ë‚˜ëŠ” ë³´ì„ì´ ë©ë‹ˆë‹¤. ê·€ì¸ì˜ ë„ì›€ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì—´ì •ì ì´ì§€ë§Œ ì¶©ëŒì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'è¾›æœª':{t:'è¾›æœª(ì‹ ë¯¸)ì¼ì£¼ - ì—¬ë¦„ í’€ë°­ì˜ ì´ìŠ¬',d:'í† ìƒê¸ˆìœ¼ë¡œ ì•ˆì •ì ì…ë‹ˆë‹¤. ì˜ˆìˆ ì  ê°ê°ì´ ìˆê³  ê°ì„±ì´ í’ë¶€í•©ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìˆœí•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'è¾›é…‰':{t:'è¾›é…‰(ì‹ ìœ )ì¼ì£¼ - ì™„ë²½í•œ ë³´ì„',d:'ê¸ˆì˜ ê¸°ìš´ì´ ë‘ ë°°ë¡œ ì˜ˆë¦¬í•©ë‹ˆë‹¤. ì™„ë²½ì£¼ì˜ìì´ê³  ì‹¬ë¯¸ì•ˆì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì˜ˆìˆ , ê¸°ìˆ ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìë„ ê¹Œë‹¤ë¡œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ì¶°ê°€ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.'},
        'è¾›äº¥':{t:'è¾›äº¥(ì‹ í•´)ì¼ì£¼ - ë°”ë‹¤ ì† ì§„ì£¼',d:'ê¸ˆìƒìˆ˜ë¡œ ì§€í˜œê°€ ìƒ˜ì†ŸìŠµë‹ˆë‹¤. ì´ëª…í•˜ê³  ê°ì„±ì´ í’ë¶€í•©ë‹ˆë‹¤. ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ê°ì„±ì ì…ë‹ˆë‹¤.'},
        'å£¬å­':{t:'å£¬å­(ì„ì)ì¼ì£¼ - ê¹Šì€ ë°”ë‹¤',d:'ìˆ˜ì˜ ê¸°ìš´ì´ ê·¹ì— ë‹¬í•´ ì§€í˜œê°€ ê¹ŠìŠµë‹ˆë‹¤. ë¨¸ë¦¬ê°€ ë¹„ìƒí•˜ê³  í•™ë¬¸ì— ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì´ëª…í•©ë‹ˆë‹¤. ê¹Šì€ ëŒ€í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.'},
        'å£¬å¯…':{t:'å£¬å¯…(ì„ì¸)ì¼ì£¼ - ë´„ë¹„',d:'ìˆ˜ìƒëª©ìœ¼ë¡œ ë§Œë¬¼ì„ ì†Œìƒì‹œí‚µë‹ˆë‹¤. ì¸ë•ì´ ìˆê³  ë² í‘¸ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ê·€ì¸ì˜ ë„ì›€ì„ ë°›ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“ ë“ í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'å£¬è¾°':{t:'å£¬è¾°(ì„ì§„)ì¼ì£¼ - ìš©ì´ ê¹ƒë“  ë¬¼',d:'í† ê·¹ìˆ˜ì´ì§€ë§Œ ìš©ì´ ë¬¼ì„ íƒ€ê³  ìŠ¹ì²œí•©ë‹ˆë‹¤. ì•¼ë§ì´ í¬ê³  ì¶œì„¸ìš´ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë“¬ì§í•˜ê³  ì¬ë¬¼ìš´ì´ ìˆìŠµë‹ˆë‹¤.'},
        'å£¬åˆ':{t:'å£¬åˆ(ì„ì˜¤)ì¼ì£¼ - ì—¬ë¦„ ì†Œë‚˜ê¸°',d:'ìˆ˜ê·¹í™”ë¡œ ì‹œë ¨ì´ ìˆì§€ë§Œ ì´ë¥¼ ê·¹ë³µí•˜ëŠ” í˜ì´ ìˆìŠµë‹ˆë‹¤. ê°ì • ê¸°ë³µì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ì„±ê²© ì°¨ì´ê°€ ìˆì§€ë§Œ ë³´ì™„í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.'},
        'å£¬ç”³':{t:'å£¬ç”³(ì„ì‹ )ì¼ì£¼ - ê³„ê³¡ì˜ ë¬¼',d:'ê¸ˆìƒìˆ˜ë¡œ ë§‘ê³  ì´ëª…í•©ë‹ˆë‹¤. ë¨¸ë¦¬ê°€ ì¢‹ê³  ê¸°ìˆ ì  ì¬ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ì–¸ë³€ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì´ëª…í•˜ê³  ëŠ¥ë ¥ìˆìŠµë‹ˆë‹¤.'},
        'å£¬æˆŒ':{t:'å£¬æˆŒ(ì„ìˆ )ì¼ì£¼ - ì œë°©ì— ë§‰íŒ ë¬¼',d:'í† ê·¹ìˆ˜ë¡œ ë§‰íˆëŠ” ë“¯í•˜ì§€ë§Œ ê²°êµ­ í„°ì§‘ë‹ˆë‹¤. ì¸ë‚´í•˜ë©´ í° ì„±ê³µì„ ì´ë£¹ë‹ˆë‹¤.',s:'ë°°ìš°ìì™€ ê°ˆë“±ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'},
        'ç™¸ä¸‘':{t:'ç™¸ä¸‘(ê³„ì¶•)ì¼ì£¼ - ì–¼ì–´ë¶™ì€ ìƒ˜',d:'ì¶•í†  ì†ì— ìˆ˜ê¸°ê°€ ìˆ¨ì–´ ìˆìŠµë‹ˆë‹¤. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ ìƒê°ì„ í•©ë‹ˆë‹¤. ëŠ¦ê²Œ í”¼ëŠ” íƒ€ì…ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì„±ì‹¤í•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'ç™¸å¯':{t:'ç™¸å¯(ê³„ë¬˜)ì¼ì£¼ - ìƒˆë²½ì´ìŠ¬',d:'ìˆ˜ìƒëª©ìœ¼ë¡œ ë§Œë¬¼ì„ í‚¤ì›ë‹ˆë‹¤. ì¸ë•ì´ ìˆê³  ìì‹ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤. ì„¬ì„¸í•˜ê³  ê°ì„±ì ì…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ë‹¤ì •í•˜ê³  ì˜ˆìˆ ì ì…ë‹ˆë‹¤.'},
        'ç™¸å·³':{t:'ç™¸å·³(ê³„ì‚¬)ì¼ì£¼ - ëœ¨ê±°ìš´ ì¦ê¸°',d:'ìˆ˜ê·¹í™”ë¡œ ë³€í™”ê°€ ë§ìŠµë‹ˆë‹¤. ì ì‘ë ¥ì´ ì¢‹ê³  ìƒí™© íŒë‹¨ì´ ë¹ ë¦…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ í™œë°œí•˜ê³  ì—´ì •ì ì…ë‹ˆë‹¤.'},
        'ç™¸æœª':{t:'ç™¸æœª(ê³„ë¯¸)ì¼ì£¼ - ì—¬ë¦„ ì €ë…ë¹„',d:'í† ê·¹ìˆ˜ì´ì§€ë§Œ ëŒ€ì§€ë¥¼ ì´‰ì´‰ì´ ì ì‹­ë‹ˆë‹¤. í¬ìš©ë ¥ì´ ìˆê³  ë‚¨ì„ ì˜ ëŒë´…ë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ìˆœí•˜ê³  ê°€ì •ì ì…ë‹ˆë‹¤.'},
        'ç™¸é…‰':{t:'ç™¸é…‰(ê³„ìœ )ì¼ì£¼ - ë§‘ì€ ìƒ˜ë¬¼',d:'ê¸ˆìƒìˆ˜ë¡œ ì´ëª…í•˜ê³  ì˜ˆìˆ ì ì…ë‹ˆë‹¤. ì‹¬ë¯¸ì•ˆì´ ë›°ì–´ë‚˜ê³  ê°ê°ì´ ì¢‹ìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì„¬ì„¸í•˜ê³  ì˜ˆìˆ ì ì…ë‹ˆë‹¤.'},
        'ç™¸äº¥':{t:'ç™¸äº¥(ê³„í•´)ì¼ì£¼ - ê¹Šì€ ë°”ë‹¤',d:'ìˆ˜ì˜ ê¸°ìš´ì´ ê·¹ì— ë‹¬í•´ ì§€í˜œê°€ ê¹ŠìŠµë‹ˆë‹¤. ì§ê´€ë ¥ì´ ë›°ì–´ë‚˜ê³  ì˜ì ì¸ ë©´ì´ ìˆìŠµë‹ˆë‹¤.',s:'ë°°ìš°ìê°€ ì§€ì ì´ê³  ê¹Šì€ ëŒ€í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.'}
    };
    
    const key = ds.c + db.c;
    if (iljuData[key]) {
        return { title: iljuData[key].t, desc: iljuData[key].d, spouse: iljuData[key].s };
    }
    
    // ê¸°ë³¸ í•´ì„¤ (ë°ì´í„° ì—†ì„ ê²½ìš°)
    const stemDesc = {'ç”²':'ì§„ì·¨ì ì´ê³  ë¦¬ë”ì‹­ ìˆëŠ”','ä¹™':'ìœ ì—°í•˜ê³  ì ì‘ë ¥ ì¢‹ì€','ä¸™':'ë°ê³  ì—´ì •ì ì¸','ä¸':'ë”°ëœ»í•˜ê³  ì„¬ì„¸í•œ','æˆŠ':'ë“¬ì§í•˜ê³  ì•ˆì •ì ì¸','å·±':'í¬ìš©ë ¥ ìˆê³  í˜„ì‹¤ì ì¸','åºš':'ê²°ë‹¨ë ¥ ìˆê³  ê°•ì¸í•œ','è¾›':'ì„¬ì„¸í•˜ê³  ì˜ˆë¯¼í•œ','å£¬':'ì§€í˜œë¡­ê³  ìœ ë™ì ì¸','ç™¸':'ì§ê´€ì ì´ê³  ê°ì„±ì ì¸'};
    const branchTrait = ['í™œë°œ','ì„±ì‹¤','ì§„ì·¨ì ','ì„¬ì„¸','ìœµí†µì„±','ì˜ë¦¬','ì—´ì •ì ','í—Œì‹ ì ','ë‹¹ë‹¹','ê°ê°ì ','ì¶©ì§','í˜„ëª…'];
    return { 
        title: `${ds.c}${db.c}ì¼ì£¼`, 
        desc: `${stemDesc[ds.c]} ì„±ê²©ì…ë‹ˆë‹¤. ${ELEMENT[ds.e].k}(${ds.c}) ì¼ê°„ì´ ${db.c}(${db.a}ë )ì— ì•‰ì•„ ìˆì–´ ${branchTrait[BRANCH.indexOf(db)]}í•œ ì„±í–¥ì´ ë‚´ì¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.`, 
        spouse: `ë°°ìš°ìê°€ ${db.a}ë ì²˜ëŸ¼ ${branchTrait[BRANCH.indexOf(db)]}í•©ë‹ˆë‹¤. ${db.a}ë  í•´ì— ì¢‹ì€ ì¸ì—°ì„ ë§Œë‚  ìˆ˜ ìˆì–´ìš”.` 
    };
}

/* ========================================
   11. ëŒ€ìš´
   ======================================== */
function calcLuck(saju, birthYear, gender, gods) {
    const isYang = saju.year.s.y;
    const isMale = gender === 'm';
    const forward = (isYang && isMale) || (!isYang && !isMale);
    const periods = [];
    const msi = STEM.indexOf(saju.month.s);
    const mbi = BRANCH.indexOf(saju.month.b);
    const curYear = new Date().getFullYear();
    const curAge = curYear - birthYear;
    
    for (let i = 0; i < 10; i++) {
        const si = forward ? (msi + i + 1) % 10 : (msi - i - 1 + 10) % 10;
        const bi = forward ? (mbi + i + 1) % 12 : (mbi - i - 1 + 12) % 12;
        const age = 3 + i * 10;
        const isCur = curAge >= age && curAge < age + 10;
        const s = STEM[si], b = BRANCH[bi];
        
        let score = 0;
        if ([s.e, b.e].includes(gods.yong)) score += 2;
        if ([s.e, b.e].includes(gods.hee)) score += 1;
        if ([s.e, b.e].includes(gods.gi)) score -= 2;
        
        periods.push({ s, b, startAge: age, endAge: age + 9, isCur, rating: score >= 2 ? 'good' : score <= -1 ? 'bad' : 'neutral', score });
    }
    return periods;
}

/* ========================================
   11-2. ëŒ€ìš´/ì„¸ìš´/ì›”ìš´ êµì°¨ ë¶„ì„
   ======================================== */
   
// íŠ¹ì • ì—°ë„ì˜ ì„¸ìš´(æ­²é‹) ê³„ì‚°
function calcYearLuck(year, saju, gods) {
    const yp = calcYearPillar(year, 6, 1);
    const dm = saju.day.s;
    const god = getTenGod(yp.s, dm);
    const state = getTwelveState(dm, yp.b);
    
    let score = 0;
    if ([yp.s.e, yp.b.e].includes(gods.yong)) score += 3;
    if ([yp.s.e, yp.b.e].includes(gods.hee)) score += 2;
    if ([yp.s.e, yp.b.e].includes(gods.gi)) score -= 3;
    
    // 12ìš´ì„± ê°€ì‚°
    if (state.l >= 10) score += 1;
    else if (state.l <= 3) score -= 1;
    
    return {
        year,
        pillar: yp,
        god,
        state,
        score,
        rating: score >= 3 ? 'great' : score >= 1 ? 'good' : score <= -2 ? 'bad' : 'neutral'
    };
}

// ëŒ€ìš´ + ì„¸ìš´ êµì°¨ ë¶„ì„
function analyzeLuckCross(saju, birthYear, gender, gods, targetYear) {
    const luck = calcLuck(saju, birthYear, gender, gods);
    const curAge = targetYear - birthYear;
    const curDaeun = luck.find(l => curAge >= l.startAge && curAge < l.endAge) || luck[0];
    const yearLuck = calcYearLuck(targetYear, saju, gods);
    
    const result = {
        daeun: curDaeun,
        saeun: yearLuck,
        analysis: []
    };
    
    // ëŒ€ìš´-ì„¸ìš´ ê´€ê³„ ë¶„ì„
    const dEl = [curDaeun.s.e, curDaeun.b.e];
    const sEl = [yearLuck.pillar.s.e, yearLuck.pillar.b.e];
    
    // ëŒ€ìš´-ì„¸ìš´ í•©
    const ganHap = [[0,5],[1,6],[2,7],[3,8],[4,9]];
    const dsi = STEM.indexOf(curDaeun.s), ssi = STEM.indexOf(yearLuck.pillar.s);
    for (let [a,b] of ganHap) {
        if ((dsi===a && ssi===b) || (dsi===b && ssi===a)) {
            result.analysis.push({type:'good', text:'ëŒ€ìš´-ì„¸ìš´ ì²œê°„í•©! ìš´ì´ ì¡°í™”ë¡­ê²Œ í˜ëŸ¬ìš”.'});
        }
    }
    
    // ëŒ€ìš´-ì„¸ìš´ ì¶©
    const dbi = BRANCH.indexOf(curDaeun.b), sbi = BRANCH.indexOf(yearLuck.pillar.b);
    if (Math.abs(dbi - sbi) === 6 || Math.abs(dbi - sbi) === 6) {
        result.analysis.push({type:'bad', text:'ëŒ€ìš´-ì„¸ìš´ ì§€ì§€ì¶©! ë³€í™”ì™€ ì‹œë ¨ì´ ìˆì„ ìˆ˜ ìˆì–´ìš”.'});
    }
    
    // ëŒ€ìš´-ì›êµ­ ê´€ê³„
    const allBi = [BRANCH.indexOf(saju.year.b), BRANCH.indexOf(saju.month.b), BRANCH.indexOf(saju.day.b)];
    if (saju.hour) allBi.push(BRANCH.indexOf(saju.hour.b));
    
    allBi.forEach((bi, idx) => {
        const positions = ['ë…„ì§€','ì›”ì§€','ì¼ì§€','ì‹œì§€'];
        // ì„¸ìš´ê³¼ ì›êµ­ ì¶©
        if (Math.abs(bi - sbi) === 6) {
            result.analysis.push({type:'warning', text:`ì„¸ìš´ì´ ${positions[idx]}ì™€ ì¶©! ${idx===2 ? 'ë°°ìš°ìë‚˜ ê±´ê°• ì£¼ì˜!' : idx===0 ? 'ì§‘ì•ˆ ì–´ë¥¸ ê´€ë ¨ ì¼ ìˆì„ ìˆ˜ ìˆì–´ìš”.' : idx===1 ? 'ì§ì¥ì´ë‚˜ ì‚¬ì—…ì— ë³€í™” ìˆì„ ìˆ˜ ìˆì–´ìš”.' : 'ìë…€ë‚˜ í›„ë°° ê´€ë ¨ ì¼ ìˆì„ ìˆ˜ ìˆì–´ìš”.'}`});
        }
    });
    
    // ì¢…í•© ì ìˆ˜
    result.totalScore = curDaeun.score + yearLuck.score;
    result.totalRating = result.totalScore >= 4 ? 'excellent' : 
                         result.totalScore >= 2 ? 'good' : 
                         result.totalScore >= 0 ? 'neutral' : 
                         result.totalScore >= -2 ? 'caution' : 'difficult';
    
    return result;
}

// ëŒ€ìš´ ì²œê°„/ì§€ì§€ 5ë…„ì”© ë¶„ë¦¬ í•´ì„
function analyzeDaeunDetail(daeun, saju, gods, startYear) {
    const dm = saju.day.s;
    
    // ì „ë°˜ 5ë…„: ì²œê°„ ìœ„ì£¼
    const stemGod = getTenGod(daeun.s, dm);
    const stemAnalysis = {
        period: 'ì „ë°˜ 5ë…„',
        dominant: 'ì²œê°„',
        pillar: daeun.s.c,
        god: stemGod.k,
        element: daeun.s.e,
        isYong: daeun.s.e === gods.yong,
        isGi: daeun.s.e === gods.gi,
        desc: `${stemGod.k}ì˜ ê¸°ìš´ì´ ì§€ë°°í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.`
    };
    
    // í›„ë°˜ 5ë…„: ì§€ì§€ ìœ„ì£¼
    const branchGod = getTenGod({e: daeun.b.e, y: true, c: '', k: ''}, dm); // ì„ì‹œ ê°ì²´
    const branchAnalysis = {
        period: 'í›„ë°˜ 5ë…„',
        dominant: 'ì§€ì§€',
        pillar: daeun.b.c,
        element: daeun.b.e,
        isYong: daeun.b.e === gods.yong,
        isGi: daeun.b.e === gods.gi,
        state: getTwelveState(dm, daeun.b),
        desc: `${ELEMENT[daeun.b.e].k}(${daeun.b.c}) ê¸°ìš´ê³¼ ${getTwelveState(dm, daeun.b).k}ì˜ ì—ë„ˆì§€ê°€ ì‘ìš©í•©ë‹ˆë‹¤.`
    };
    
    return { stem: stemAnalysis, branch: branchAnalysis };
}

// 10ë…„ ìš´ì„¸ ë¯¸ë¦¬ë³´ê¸°
function getNext10Years(saju, birthYear, gender, gods) {
    const curYear = new Date().getFullYear();
    const years = [];
    
    for (let i = 0; i < 10; i++) {
        const year = curYear + i;
        const cross = analyzeLuckCross(saju, birthYear, gender, gods, year);
        years.push({
            year,
            age: year - birthYear,
            rating: cross.totalRating,
            score: cross.totalScore,
            daeun: cross.daeun,
            saeun: cross.saeun
        });
    }
    
    // ê°€ì¥ ì¢‹ì€ í•´, ì¡°ì‹¬í•  í•´ ì°¾ê¸°
    const bestYear = years.reduce((a, b) => a.score > b.score ? a : b);
    const worstYear = years.reduce((a, b) => a.score < b.score ? a : b);
    
    return { years, bestYear, worstYear };
}

// ì›”ìš´(æœˆé‹) ê³„ì‚°
function calcMonthLuck(year, month, saju, gods) {
    const mp = calcMonthPillar(year, month, 15);
    const dm = saju.day.s;
    const god = getTenGod(mp.s, dm);
    
    let score = 0;
    if ([mp.s.e, mp.b.e].includes(gods.yong)) score += 2;
    if ([mp.s.e, mp.b.e].includes(gods.hee)) score += 1;
    if ([mp.s.e, mp.b.e].includes(gods.gi)) score -= 2;
    
    return {
        month,
        pillar: mp,
        god,
        score,
        rating: score >= 2 ? 'good' : score <= -1 ? 'bad' : 'neutral'
    };
}

// 12ê°œì›” ì›”ìš´ ë¶„ì„
function getYearlyMonthLuck(year, saju, gods) {
    const months = [];
    for (let m = 1; m <= 12; m++) {
        months.push(calcMonthLuck(year, m, saju, gods));
    }
    
    // ê°€ì¥ ì¢‹ì€ ë‹¬, ë‚˜ìœ ë‹¬
    const best = months.reduce((a, b) => a.score > b.score ? a : b);
    const worst = months.reduce((a, b) => a.score < b.score ? a : b);
    
    return { months, best, worst };
}

/* ========================================
   12. ì‹ ì‚´ ì™„ì „íŒ (30ê°œ+)
   ======================================== */
function calcSinsal(saju) {
    const ss = [];
    const dmi = STEM.indexOf(saju.day.s);
    const ybi = BRANCH.indexOf(saju.year.b);
    const dbi = BRANCH.indexOf(saju.day.b);
    const mbi = BRANCH.indexOf(saju.month.b);
    const hbi = saju.hour ? BRANCH.indexOf(saju.hour.b) : -1;
    const brs = [ybi, mbi, dbi];
    if (hbi >= 0) brs.push(hbi);
    
    // ì²œê°„ ì¸ë±ìŠ¤ë“¤
    const ysi = STEM.indexOf(saju.year.s);
    const msi = STEM.indexOf(saju.month.s);
    const hsi = saju.hour ? STEM.indexOf(saju.hour.s) : -1;
    
    // ========== ê¸¸ì‹ (å‰ç¥) ==========
    
    // 1. ì²œì„ê·€ì¸ (å¤©ä¹™è²´äºº) - ìµœê³  ê¸¸ì‹ 
    const guiren = {0:[1,7],1:[0,8],2:[11,9],3:[11,9],4:[1,7],5:[0,8],6:[7,1],7:[6,2],8:[5,3],9:[5,3]};
    if (guiren[dmi] && brs.some(b => guiren[dmi].includes(b))) ss.push({n:'ì²œì„ê·€ì¸(å¤©ä¹™è²´äºº)',t:'good',d:'ìµœê³ ì˜ ê¸¸ì‹ ! ìœ„ê¸°ì— ê¼­ ê·€ì¸ì´ ë‚˜íƒ€ë‚˜ìš”. ê´€ì§ìš´, ì‹œí—˜ìš´ì´ ì¢‹ê³  ìœ„í—˜ì„ í”¼í•´ê°€ìš”.',i:'ğŸ‘¼',lv:'ìµœìƒ'});
    
    // 2. ì²œë•ê·€ì¸ (å¤©å¾·è²´äºº)
    const tiande = [9,8,7,6,5,4,3,2,1,0,9,8]; // ì›”ë³„
    if (mbi < 12 && (dmi === tiande[mbi] || brs.some(b => b === tiande[mbi]))) ss.push({n:'ì²œë•ê·€ì¸(å¤©å¾·è²´äºº)',t:'good',d:'í•˜ëŠ˜ì˜ ë•ì´ ìˆì–´ìš”! ì°©í•˜ê²Œ ì‚´ë©´ ë³µì´ ì™€ìš”. í‰í•œ ì¼ë„ ê¸¸í•˜ê²Œ ë°”ë€Œì–´ìš”.',i:'ğŸŒŸ',lv:'ìƒ'});
    
    // 3. ì›”ë•ê·€ì¸ (æœˆå¾·è²´äºº)
    const yuede = [2,6,2,6,4,8,4,8,0,6,0,6]; // ì›”ë³„ ì²œê°„
    if (mbi < 12 && dmi === yuede[mbi]) ss.push({n:'ì›”ë•ê·€ì¸(æœˆå¾·è²´äºº)',t:'good',d:'ë‹¬ì˜ ë•ì´ ìˆì–´ìš”! ì¸ê¸°ê°€ ë§ê³  ì‚¬ëŒë“¤ì—ê²Œ ì‹ ë¢°ë°›ì•„ìš”. ê³µì§ì— ìœ ë¦¬í•´ìš”.',i:'ğŸŒ™',lv:'ìƒ'});
    
    // 4. ë¬¸ì°½ê·€ì¸ (æ–‡æ˜Œè²´äºº)
    const munchang = {0:5,1:6,2:8,3:9,4:8,5:9,6:11,7:0,8:2,9:3};
    if (brs.includes(munchang[dmi])) ss.push({n:'ë¬¸ì°½ê·€ì¸(æ–‡æ˜Œè²´äºº)',t:'good',d:'ê³µë¶€ ë¨¸ë¦¬ ìµœê³ ! ì‹œí—˜ìš´, ìê²©ì¦ìš´, í•™ìœ„ìš´ì´ ì¢‹ì•„ìš”. ê¸€ì“°ê¸°ë„ ì˜í•´ìš”.',i:'ğŸ“š',lv:'ìƒ'});
    
    // 5. í•™ë‹¹ê·€ì¸ (å­¸å ‚è²´äºº)
    const xuetang = {0:11,1:6,2:2,3:9,4:2,5:9,6:5,7:0,8:8,9:3};
    if (brs.includes(xuetang[dmi])) ss.push({n:'í•™ë‹¹ê·€ì¸(å­¸å ‚è²´äºº)',t:'good',d:'í•™ì ê¸°ì§ˆ! ì—°êµ¬, êµìœ¡ ë¶„ì•¼ì—ì„œ ì„±ê³µí•´ìš”. êµìˆ˜, ë°•ì‚¬, ì „ë¬¸ê°€ì— ë”±!',i:'ğŸ“',lv:'ìƒ'});
    
    // 6. ì¥ì„±ê·€ì¸ (å°‡æ˜Ÿè²´äºº)
    const jiangx = {0:0,1:9,2:6,3:3,4:0,5:9,6:6,7:3,8:0,9:9,10:6,11:3}; // ë…„ì§€ë³„
    if (brs.includes(jiangx[ybi])) ss.push({n:'ì¥ì„±(å°‡æ˜Ÿ)',t:'good',d:'ì¥êµ° ê¸°ì§ˆ! ë¦¬ë”ì‹­ì´ ë›°ì–´ë‚˜ê³  ì‚¬ëŒë“¤ì´ ë”°ë¼ìš”. ì¡°ì§ì˜ ìˆ˜ì¥ì´ ë  ìˆ˜ ìˆì–´ìš”.',i:'ğŸ–ï¸',lv:'ìƒ'});
    
    // 7. ê¸ˆì—¬(é‡‘è¼¿) - ë°°ìš°ì ë³µ
    const jinyu = {0:4,1:5,2:7,3:8,4:7,5:8,6:10,7:11,8:1,9:2};
    if (brs.includes(jinyu[dmi])) ss.push({n:'ê¸ˆì—¬(é‡‘è¼¿)',t:'good',d:'ë°°ìš°ìë³µ ìµœê³ ! ê²°í˜¼í•˜ë©´ ìš´ì´ íŠ¸ì´ê³ , ì¢‹ì€ ì§ì„ ë§Œë‚˜ìš”.',i:'ğŸ’',lv:'ìƒ'});
    
    // 8. ë³µì„±ê·€ì¸ (ç¦æ˜Ÿè²´äºº)
    const fuxing = {0:2,1:3,2:5,3:6,4:5,5:6,6:8,7:9,8:11,9:0};
    if (brs.includes(fuxing[dmi])) ss.push({n:'ë³µì„±ê·€ì¸(ç¦æ˜Ÿè²´äºº)',t:'good',d:'ë³µì´ ë§ì€ ì‚¬ì£¼! ì˜ì‹ì£¼ ê±±ì • ì—†ê³  í‰ìƒ ë¨¹ê³  ì‚´ ë³µì´ ìˆì–´ìš”.',i:'ğŸ€',lv:'ìƒ'});
    
    // 9. ì•”ë¡ (æš—ç¥¿) - ìˆ¨ì€ ë…¹
    const anlu = {0:11,1:10,2:1,3:0,4:1,5:0,6:3,7:2,8:5,9:4};
    if (brs.includes(anlu[dmi])) ss.push({n:'ì•”ë¡(æš—ç¥¿)',t:'good',d:'ìˆ¨ì€ ë³µì´ ìˆì–´ìš”! ëˆˆì— ì•ˆ ë³´ì´ëŠ” ê³³ì—ì„œ ë„ì›€ì„ ë°›ì•„ìš”.',i:'ğŸ',lv:'ì¤‘'});
    
    // 10. ê±´ë¡ (å»ºç¥¿)
    const jianlu = {0:2,1:3,2:5,3:6,4:5,5:6,6:8,7:9,8:11,9:0};
    if (brs.includes(jianlu[dmi])) ss.push({n:'ê±´ë¡(å»ºç¥¿)',t:'good',d:'ììˆ˜ì„±ê°€í˜•! ìŠ¤ìŠ¤ë¡œ ì¼ì–´ì„œì„œ ì„±ê³µí•˜ëŠ” íƒ€ì…. ì§ì—… ì•ˆì •ì ì´ì—ìš”.',i:'ğŸ ',lv:'ìƒ'});
    
    // 11. ì²œì˜ì„± (å¤©é†«æ˜Ÿ)
    const tianyi = [11,0,1,2,3,4,5,6,7,8,9,10]; // ì›”ë³„
    if (mbi < 12 && brs.includes(tianyi[mbi])) ss.push({n:'ì²œì˜ì„±(å¤©é†«æ˜Ÿ)',t:'good',d:'ì˜ë£Œ ì ì„±! ì˜ì‚¬, ê°„í˜¸ì‚¬, ì•½ì‚¬ì— ë”± ë§ì•„ìš”. ê±´ê°• ê´€ë ¨ ì§ì—… ëŒ€ê¸¸!',i:'ğŸ’Š',lv:'ì¤‘'});
    
    // ========== ì¤‘ì„±(ä¸­æ€§) ==========
    
    // 12. ì—­ë§ˆì‚´ (é©›é¦¬æ®º)
    const yima = {0:2,1:11,2:8,3:5,4:2,5:11,6:8,7:5,8:2,9:11,10:8,11:5};
    if (brs.includes(yima[ybi])) ss.push({n:'ì—­ë§ˆì‚´(é©›é¦¬æ®º)',t:'neutral',d:'ì›€ì§ì—¬ì•¼ ìš´ì´ íŠ¸ì—¬ìš”! ì—¬í–‰, ì¶œì¥, ì´ì‚¬, í•´ì™¸ ë°œë ¹... ê°€ë§Œíˆ ìˆìœ¼ë©´ ë‹µë‹µí•´ìš”.',i:'ğŸ',lv:'ì¤‘'});
    
    // 13. ë„í™”ì‚´ (æ¡ƒèŠ±æ®º)
    const taohua = {0:9,1:6,2:3,3:0,4:9,5:6,6:3,7:0,8:9,9:6,10:3,11:0};
    if (brs.includes(taohua[ybi])) ss.push({n:'ë„í™”ì‚´(æ¡ƒèŠ±æ®º)',t:'neutral',d:'ë§¤ë ¥ í­ë°œ! ì´ì„±ì—ê²Œ ì¸ê¸° ë§ì•„ìš”. ì—°ì˜ˆì¸ ê¸°ì§ˆ! ë‹¨, ë°”ëŒê¸° ì¡°ì‹¬.',i:'ğŸŒ¸',lv:'ì¤‘'});
    
    // 14. í™”ê°œì‚´ (è¯è“‹æ®º)
    const huagai = {0:4,1:1,2:10,3:7,4:4,5:1,6:10,7:7,8:4,9:1,10:10,11:7};
    if (brs.includes(huagai[ybi])) ss.push({n:'í™”ê°œì‚´(è¯è“‹æ®º)',t:'neutral',d:'ì˜ˆìˆ ê°€ ê¸°ì§ˆ! ìŒì•…, ê·¸ë¦¼, ê¸€ì“°ê¸° ì¬ëŠ¥. ì¢…êµ, ì² í•™ì— ê´€ì‹¬ ë§ì•„ìš”.',i:'ğŸ¨',lv:'ì¤‘'});
    
    // 15. í™ì—¼ì‚´ (ç´…è‰¶æ®º) - ì´ì„± ì¸ê¸°
    const hongyan = {0:6,1:5,2:8,3:7,4:8,5:7,6:9,7:8,8:11,9:10};
    if (brs.includes(hongyan[dmi])) ss.push({n:'í™ì—¼ì‚´(ç´…è‰¶æ®º)',t:'neutral',d:'ì„¹ì‹œí•œ ë§¤ë ¥! ì´ì„±ì„ ë„ëŠ” í˜ì´ ìˆì–´ìš”. ì—°ì˜ˆê³„ ì ì„±, ë°”ëŒê¸° ì£¼ì˜!',i:'ğŸ’‹',lv:'ì¤‘'});
    
    // ========== í‰ì‹ (å‡¶ç¥) ==========
    
    // 16. ê´´ê°•ì‚´ (é­ç½¡æ®º)
    const kuigang = [[6,4],[],[6,4],[],[6,10],[],[6,10],[],[],[]]; // ì¼ê°„ë³„ ì¼ì§€
    if (kuigang[dmi] && kuigang[dmi].includes(dbi)) ss.push({n:'ê´´ê°•ì‚´(é­ç½¡æ®º)',t:'bad',d:'ì„±ê²©ì´ ë¶ˆ ê°™ì•„ìš”! ì¹´ë¦¬ìŠ¤ë§ˆ ìˆê³  ë¦¬ë” ìì§ˆ, í•˜ì§€ë§Œ ë…ë‹¨ì ì¼ ìˆ˜ ìˆì–´ìš”.',i:'âš¡',lv:'ìƒ'});
    
    // 17. ì–‘ì¸ì‚´ (ç¾Šåˆƒæ®º)
    const yangren = {0:3,1:2,2:6,3:5,4:6,5:5,6:9,7:8,8:0,9:11};
    if (dbi === yangren[dmi]) ss.push({n:'ì–‘ì¸ì‚´(ç¾Šåˆƒæ®º)',t:'bad',d:'ì¹¼ë‚  ê°™ì€ ê¸°ìš´! ê²°ë‹¨ë ¥ ìˆì§€ë§Œ ë‚ ì¹´ë¡œì›Œìš”. êµ°ì¸, ì™¸ê³¼ì˜, ë²•ì¡°ì¸ì— ì í•©.',i:'ğŸ—¡ï¸',lv:'ìƒ'});
    
    // 18. ë°±í˜¸ì‚´ (ç™½è™æ®º) - ì›”ì§€ ê¸°ì¤€
    const baihu = [6,7,8,9,10,11,0,1,2,3,4,5]; // ì›”ë³„
    if (mbi < 12 && brs.includes(baihu[mbi])) ss.push({n:'ë°±í˜¸ì‚´(ç™½è™æ®º)',t:'bad',d:'ì‚¬ê³ , ìˆ˜ìˆ  ì£¼ì˜! í•˜ì§€ë§Œ ì˜ë£Œì¸, ìš”ë¦¬ì‚¬ ë“± í”¼ ë³´ëŠ” ì§ì—…ì€ ì˜¤íˆë ¤ ì¢‹ì•„ìš”.',i:'ğŸ¯',lv:'ì¤‘'});
    
    // 18-1. ë°±í˜¸ëŒ€ì‚´ (ç™½è™å¤§æ®º) - ì¼ì£¼ ê¸°ì¤€ â˜…ì¤‘ìš”â˜…
    // ê°‘ì§„, ì„ë¯¸, ë³‘ìˆ , ì •ì¶•, ë¬´ì§„, ê¸°ì¶•, ê²½ìˆ , ì‹ ë¯¸, ì„ì§„, ê³„ì¶•
    const baihuDaeSal = [
        [0, 4],  // ê°‘ì§„
        [1, 7],  // ì„ë¯¸ â† ì£¼ì˜!
        [2, 10], // ë³‘ìˆ 
        [3, 1],  // ì •ì¶•
        [4, 4],  // ë¬´ì§„
        [5, 1],  // ê¸°ì¶•
        [6, 10], // ê²½ìˆ 
        [7, 7],  // ì‹ ë¯¸
        [8, 4],  // ì„ì§„
        [9, 1]   // ê³„ì¶•
    ];
    const isBaihuDaeSal = baihuDaeSal.some(([s, b]) => s === dmi && b === dbi);
    if (isBaihuDaeSal) {
        ss.push({n:'ë°±í˜¸ëŒ€ì‚´(ç™½è™å¤§æ®º)',t:'bad',d:'ì¼ì£¼ì— ë°±í˜¸ê°€ ìˆì–´ìš”! ê²‰ìœ¼ë¡œëŠ” ì˜¨ìˆœí•´ ë³´ì—¬ë„ ì†ì— ê°•í•œ ê¸°ìš´ì´ ìˆìŠµë‹ˆë‹¤. ë°°ìš°ìê¶ì— ë°±í˜¸ê°€ ìˆìœ¼ë‹ˆ ë°°ìš°ìì˜ ê¸°ê°€ ì„¸ê±°ë‚˜, ê±´ê°• ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. ì˜ë£Œ, êµ°ê²½, ìš”ë¦¬ ë“± í”¼ë¥¼ ë‹¤ë£¨ëŠ” ì§ì—…ì´ ì˜¤íˆë ¤ ì¢‹ì•„ìš”.',i:'ğŸ…',lv:'ìƒ'});
    }
    
    // 19. ê²ì‚´ (åŠ«æ®º)
    const jiesha = {0:5,1:2,2:11,3:8,4:5,5:2,6:11,7:8,8:5,9:2,10:11,11:8};
    if (brs.includes(jiesha[ybi])) ss.push({n:'ê²ì‚´(åŠ«æ®º)',t:'bad',d:'ëˆ ìƒê¸° ì‰¬ì›Œìš”! ë„ë‚œ, ì‚¬ê¸°, íˆ¬ì ì‹¤íŒ¨ ì£¼ì˜. ë³´ì¦ ì ˆëŒ€ ì•ˆ ë¼ìš”!',i:'ğŸ’¸',lv:'ì¤‘'});
    
    // 20. ë§ì‹ ì‚´ (äº¡ç¥æ®º)
    const wangshen = {0:9,1:6,2:3,3:0,4:9,5:6,6:3,7:0,8:9,9:6,10:3,11:0};
    if (brs.includes(wangshen[ybi]) && wangshen[ybi] !== taohua[ybi]) ss.push({n:'ë§ì‹ ì‚´(äº¡ç¥æ®º)',t:'bad',d:'ë§ì‹ ë‹¹í•˜ê¸° ì‰¬ì›Œìš”! SNS ì¡°ì‹¬, ìˆ ìë¦¬ ì‹¤ìˆ˜ ì£¼ì˜í•˜ì„¸ìš”.',i:'ğŸ˜°',lv:'ì¤‘'});
    
    // 21. ì›ì§„ì‚´ (æ€¨å—”æ®º)
    const yuanchen = [[7],[6],[5],[4],[3],[2],[1],[0],[11],[10],[9],[8]];
    if (yuanchen[ybi] && brs.some(b => yuanchen[ybi].includes(b))) ss.push({n:'ì›ì§„ì‚´(æ€¨å—”æ®º)',t:'bad',d:'ë¯¸ì›Œë„ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ì¸ì—°ì´ ìˆì–´ìš”. ê°€ê¹Œìš´ ì‚¬ëŒê³¼ ê°ˆë“± ì¡°ì‹¬.',i:'ğŸ’”',lv:'ì¤‘'});
    
    // 22. ê·€ë¬¸ê´€ì‚´ (é¬¼é–€é—œæ®º)
    const guimen = [[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,0],[0,1],[1,2],[2,3],[3,4],[4,5]];
    if (guimen[ybi] && brs.some(b => guimen[ybi].includes(b))) ss.push({n:'ê·€ë¬¸ê´€ì‚´(é¬¼é–€é—œæ®º)',t:'bad',d:'ì •ì‹ ì  ê³ í†µì´ ìˆì„ ìˆ˜ ìˆì–´ìš”. ìš°ìš¸, ë¶ˆì•ˆ ì¡°ì‹¬. ëª…ìƒ, ì¢…êµê°€ ë„ì›€ ë¼ìš”.',i:'ğŸ‘»',lv:'ì¤‘'});
    
    // 23. í˜„ì¹¨ì‚´ (æ‡¸é‡æ®º) - ç”², ç”³, è¾›ì— ì„¸ë¡œíš
    if ([0,7].includes(dmi)) ss.push({n:'í˜„ì¹¨ì‚´(æ‡¸é‡æ®º)',t:'bad',d:'ë°”ëŠ˜ì²˜ëŸ¼ ë‚ ì¹´ë¡œìš´ ê¸°ìš´! ë¹„íŒì ì´ê³  ì™„ë²½ì£¼ì˜. ì¹¨ìˆ , ë´‰ì œì— ì¬ëŠ¥.',i:'ğŸ“',lv:'í•˜'});
    
    // 24. ìœ¡í•´ì‚´ (å…­å®³æ®º)
    const liuhai = [[7],[6],[5],[4],[3],[2],[1],[0],[11],[10],[9],[8]];
    if (liuhai[dbi] && brs.some(b => liuhai[dbi].includes(b) && b !== dbi)) ss.push({n:'ìœ¡í•´ì‚´(å…­å®³æ®º)',t:'bad',d:'ê°€ê¹Œìš´ ì‚¬ëŒì—ê²Œ í•´ë¥¼ ì…ì„ ìˆ˜ ìˆì–´ìš”. ë°°ìš°ì, í˜•ì œ ê´€ê³„ ì£¼ì˜.',i:'âš ï¸',lv:'ì¤‘'});
    
    // 25. ì²œë¼ì§€ë§ (å¤©ç¾…åœ°ç¶²)
    const tianluodiwang = (dbi === 10 && [5,6].includes(mbi)) || (dbi === 11 && [9,10].includes(mbi));
    if (tianluodiwang) ss.push({n:'ì²œë¼ì§€ë§(å¤©ç¾…åœ°ç¶²)',t:'bad',d:'í•˜ëŠ˜ ê·¸ë¬¼ì— ê±¸ë¦° í˜•ìƒ. êµ¬ì„¤, ì†Œì†¡ ì£¼ì˜. ê°‡íŒ ëŠë‚Œì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”.',i:'ğŸ•¸ï¸',lv:'ì¤‘'});
    
    // 26. ê³ ë€ì‚´ (å­¤é¸æ®º) - í˜¼ì ìˆëŠ” ê¸°ëŸ¬ê¸°
    const guluanM = [[0,2],[1,3],[2,5],[3,6],[4,5],[5,6],[6,8],[7,9],[8,11],[9,0]]; // ì¼ê°„+ì¼ì§€ ì¡°í•© (ë‚¨ì)
    const guluanF = [[1,3],[0,2],[3,6],[2,5],[3,6],[2,5],[7,9],[6,8],[9,0],[8,11]]; // ì—¬ì
    const guluanCheck = GENDER === 'm' ? guluanM : guluanF;
    if (guluanCheck[dmi] && guluanCheck[dmi][1] === dbi) ss.push({n:'ê³ ë€ì‚´(å­¤é¸æ®º)',t:'bad',d:'ì™¸ë¡œìš´ ê¸°ìš´ì´ ìˆì–´ìš”. ê²°í˜¼ì´ ëŠ¦ê±°ë‚˜ ë…ì‹  ê²½í–¥. í˜¼ì ìˆëŠ” ì‹œê°„ì´ ë§ì•„ìš”.',i:'ğŸ¦¢',lv:'í•˜'});
    
    // 27. ì‚¼ì¬ (ä¸‰ç½) - ë…„ì§€ ê¸°ì¤€ (ì •í™•í•œ ì‚¼í•© ê¸°ë°˜)
    // ì‹ ìì§„(8,0,4) ì‚¼êµ­ â†’ ì¸ë¬˜ì§„(2,3,4)ë…„ ì‚¼ì¬
    // í•´ë¬˜ë¯¸(11,3,7) ì‚¼êµ­ â†’ ì‚¬ì˜¤ë¯¸(5,6,7)ë…„ ì‚¼ì¬
    // ì¸ì˜¤ìˆ (2,6,10) ì‚¼êµ­ â†’ ì‹ ìœ ìˆ (8,9,10)ë…„ ì‚¼ì¬
    // ì‚¬ìœ ì¶•(5,9,1) ì‚¼êµ­ â†’ í•´ìì¶•(11,0,1)ë…„ ì‚¼ì¬
    const sanzai = {
        0:[2,3,4],   // ì(ì¥) - ì‹ ìì§„ ì‚¼êµ­ â†’ ì¸ë¬˜ì§„ë…„ ì‚¼ì¬
        1:[11,0,1],  // ì¶•(ì†Œ) - ì‚¬ìœ ì¶• ì‚¼êµ­ â†’ í•´ìì¶•ë…„ ì‚¼ì¬
        2:[8,9,10],  // ì¸(í˜¸ë‘ì´) - ì¸ì˜¤ìˆ  ì‚¼êµ­ â†’ ì‹ ìœ ìˆ ë…„ ì‚¼ì¬
        3:[5,6,7],   // ë¬˜(í† ë¼) - í•´ë¬˜ë¯¸ ì‚¼êµ­ â†’ ì‚¬ì˜¤ë¯¸ë…„ ì‚¼ì¬
        4:[2,3,4],   // ì§„(ìš©) - ì‹ ìì§„ ì‚¼êµ­ â†’ ì¸ë¬˜ì§„ë…„ ì‚¼ì¬
        5:[11,0,1],  // ì‚¬(ë±€) - ì‚¬ìœ ì¶• ì‚¼êµ­ â†’ í•´ìì¶•ë…„ ì‚¼ì¬
        6:[8,9,10],  // ì˜¤(ë§) - ì¸ì˜¤ìˆ  ì‚¼êµ­ â†’ ì‹ ìœ ìˆ ë…„ ì‚¼ì¬
        7:[5,6,7],   // ë¯¸(ì–‘) - í•´ë¬˜ë¯¸ ì‚¼êµ­ â†’ ì‚¬ì˜¤ë¯¸ë…„ ì‚¼ì¬
        8:[2,3,4],   // ì‹ (ì›ìˆ­ì´) - ì‹ ìì§„ ì‚¼êµ­ â†’ ì¸ë¬˜ì§„ë…„ ì‚¼ì¬
        9:[11,0,1],  // ìœ (ë‹­) - ì‚¬ìœ ì¶• ì‚¼êµ­ â†’ í•´ìì¶•ë…„ ì‚¼ì¬
        10:[8,9,10], // ìˆ (ê°œ) - ì¸ì˜¤ìˆ  ì‚¼êµ­ â†’ ì‹ ìœ ìˆ ë…„ ì‚¼ì¬
        11:[5,6,7]   // í•´(ë¼ì§€) - í•´ë¬˜ë¯¸ ì‚¼êµ­ â†’ ì‚¬ì˜¤ë¯¸ë…„ ì‚¼ì¬
    };
    const curYear = new Date().getFullYear();
    const curYearBranch = (curYear - 4) % 12;
    if (sanzai[ybi] && sanzai[ybi].includes(curYearBranch)) ss.push({n:'ì‚¼ì¬(ä¸‰ç½) ê¸°ê°„',t:'bad',d:'í˜„ì¬ ì‚¼ì¬ ê¸°ê°„ì´ì—ìš”! 3ë…„ê°„ ì¡°ì‹¬í•˜ì„¸ìš”. ë¬´ë¦¬í•œ í™•ì¥, ì´ì‚¬, ìˆ˜ìˆ  í”¼í•˜ì„¸ìš”.',i:'ğŸ”¥',lv:'ì¤‘'});
    
    // 28. ë°˜ì•ˆì‚´ (æ”€éæ®º)
    const panan = {0:2,1:3,2:5,3:6,4:5,5:6,6:8,7:9,8:11,9:0};
    if (brs.includes(panan[dmi])) ss.push({n:'ë°˜ì•ˆì‚´(æ”€éæ®º)',t:'good',d:'ì§ì¥ìš´ ì¢‹ì•„ìš”! ì•ˆì •ì ì¸ ì¡°ì§ì—ì„œ ìŠ¹ì§„í•˜ëŠ” íƒ€ì…. ê³µê¸°ì—…, ëŒ€ê¸°ì—…ì— ì í•©.',i:'ğŸ’º',lv:'ì¤‘'});
    
    // 29. ì²œì£¼ê·€ì¸ (å¤©å»šè²´äºº) - ì‹ë³µ
    const tianchu = {0:5,1:6,2:8,3:9,4:8,5:9,6:11,7:0,8:2,9:3};
    if (brs.includes(tianchu[dmi])) ss.push({n:'ì²œì£¼ê·€ì¸(å¤©å»šè²´äºº)',t:'good',d:'ë¨¹ëŠ” ë³µì´ ìˆì–´ìš”! í‰ìƒ êµ¶ì„ ì¼ ì—†ì–´ìš”. ìš”ì‹ì—…ì—ë„ ì¬ëŠ¥!',i:'ğŸ½ï¸',lv:'ì¤‘'});
    
    // 30. ì²œì‚¬(å¤©èµ¦) - í•˜ëŠ˜ì´ ìš©ì„œí•˜ëŠ” ë‚ 
    const tiansha = [[2,0],[3,1],[5,2],[6,3],[8,4],[9,5],[11,6],[0,7],[2,8],[3,9]]; // [ì§€ì§€,ì²œê°„] ì¡°í•©
    if (tiansha.some(ts => dbi === ts[0] && dmi === ts[1])) ss.push({n:'ì²œì‚¬ì¼(å¤©èµ¦æ—¥) ì¶œìƒ',t:'good',d:'í•˜ëŠ˜ì´ ìš©ì„œí•˜ëŠ” ë‚ ì— íƒœì–´ë‚¬ì–´ìš”! ì£„ë¥¼ ì§€ì–´ë„ í’€ë¦¬ê³ , í‰ì´ ê¸¸ë¡œ ë°”ë€Œì–´ìš”.',i:'ğŸ•Šï¸',lv:'ìƒ'});
    
    // 31. íƒ•í™”ì‚´ (æ¹¯ç«æ®º) - í™”ìƒ, ì•½ë¬¼, í™”ë³‘ ì£¼ì˜
    // ì¶•ì˜¤(1,6), ì¸ì‚¬(2,5) ì¡°í•©
    const tanghuaPairs = [[1,6],[6,1],[2,5],[5,2]]; // [ì§€ì§€1, ì§€ì§€2] ì¡°í•©
    for (let i = 0; i < brs.length; i++) {
        for (let j = i + 1; j < brs.length; j++) {
            if (tanghuaPairs.some(p => (brs[i] === p[0] && brs[j] === p[1]))) {
                ss.push({n:'íƒ•í™”ì‚´(æ¹¯ç«æ®º)',t:'bad',d:'í™”ìƒ, ì—´ë³‘, ì•½ë¬¼ ë¶€ì‘ìš© ì£¼ì˜! í™”ë³‘ì´ë‚˜ ì •ì‹ ì  ìŠ¤íŠ¸ë ˆìŠ¤ì—ë„ ì·¨ì•½í•´ìš”. ëœ¨ê±°ìš´ ìŒì‹, í™”ê¸°ë¥¼ ë‹¤ë£° ë•Œ ì¡°ì‹¬í•˜ì„¸ìš”.',i:'ğŸ”¥',lv:'ìƒ'});
                break;
            }
        }
    }
    
    // 32. ì •í¸ì¬ í˜¼ì¡ (æ­£åè²¡æ··é›œ) - ì´ì„± ë¬¸ì œ ê²½ê³ 
    const stemIdxs = [STEM.indexOf(saju.year.s), STEM.indexOf(saju.month.s), STEM.indexOf(saju.day.s)];
    if (saju.hour) stemIdxs.push(STEM.indexOf(saju.hour.s));
    const stemGods = stemIdxs.map(s => getTenGod(STEM[s], saju.day.s));
    const hasJungJae = stemGods.some(g => g && g.k === 'ì •ì¬');
    const hasPyunJae = stemGods.some(g => g && g.k === 'í¸ì¬');
    if (hasJungJae && hasPyunJae) {
        ss.push({n:'ì •í¸ì¬ í˜¼ì¡(è²¡æ··)',t:'bad',d:'ì •ì¬ì™€ í¸ì¬ê°€ ëª¨ë‘ ì²œê°„ì— ìˆì–´ìš”. ì´ì„± ê´€ê³„ê°€ ë³µì¡í•´ì§€ê¸° ì‰¬ì›Œìš”. ì¬ë¬¼ì˜ ì…ì¶œë„ ë¹ˆë²ˆí•©ë‹ˆë‹¤. í•œ ìš°ë¬¼ì„ íŒŒëŠ” ê²Œ ì¢‹ì•„ìš”.',i:'ğŸ’”',lv:'ì¤‘'});
    }
    
    // 33. ìƒê´€í•©ì‚´ (å‚·å®˜åˆæ®º) - ìœ„ê¸°ë¥¼ ê¸°íšŒë¡œ ë°”ê¾¸ëŠ” ëŠ¥ë ¥
    // ìƒê´€ê³¼ í¸ê´€ì´ ì²œê°„í•©ì„ ì´ë£¨ë©´
    const hasShangGuan = stemGods.some(g => g && g.k === 'ìƒê´€');
    const hasPyunGwan = stemGods.some(g => g && g.k === 'í¸ê´€');
    const tianganHap = [[0,5],[1,6],[2,7],[3,8],[4,9]]; // ì²œê°„í•© ì¡°í•©
    let hasShangGuanHapSal = false;
    for (let i = 0; i < stemIdxs.length; i++) {
        for (let j = i+1; j < stemIdxs.length; j++) {
            const godI = stemGods[i];
            const godJ = stemGods[j];
            if (godI && godJ) {
                const isHap = tianganHap.some(([a,b]) => 
                    (stemIdxs[i] === a && stemIdxs[j] === b) || (stemIdxs[i] === b && stemIdxs[j] === a)
                );
                if (isHap && 
                    ((godI.k === 'ìƒê´€' && godJ.k === 'í¸ê´€') || (godI.k === 'í¸ê´€' && godJ.k === 'ìƒê´€'))) {
                    hasShangGuanHapSal = true;
                }
            }
        }
    }
    if (hasShangGuanHapSal) {
        ss.push({n:'ìƒê´€í•©ì‚´(å‚·å®˜åˆæ®º)',t:'good',d:'ìœ„ê¸°ë¥¼ ê¸°íšŒë¡œ ë°”ê¾¸ëŠ” í˜‘ìƒê°€ ì¬ëŠ¥! ìƒê´€(ì–¸ë³€/ê¸°ìˆ )ì´ í¸ê´€(ìœ„í—˜/ì )ì„ í•©ìœ¼ë¡œ ì œì–´í•´ìš”. ë¡œë¹„ìŠ¤íŠ¸, í˜‘ìƒê°€, ì¤‘ì¬ì, í•´ê²°ì‚¬ì— íƒì›”í•´ìš”.',i:'ğŸ¤',lv:'ìƒ'});
    }
    
    return ss.length ? ss : [{n:'íŠ¹ì´ì‹ ì‚´ ì—†ìŒ',t:'neutral',d:'íŠ¹ë³„í•œ ì‹ ì‚´ì´ ì—†ì–´ìš”. í‰ì˜¨í•˜ê³  ì•ˆì •ì ì¸ ì‚¬ì£¼ì˜ˆìš”!',i:'â˜¯ï¸',lv:'ì¤‘'}];
}

/* ========================================
   13. í•©ì¶©í˜•íŒŒí•´ (í™•ì¥íŒ)
   ======================================== */
function calcInteractions(saju) {
    const res = [];
    const stems = [STEM.indexOf(saju.year.s), STEM.indexOf(saju.month.s), STEM.indexOf(saju.day.s)];
    const brs = [BRANCH.indexOf(saju.year.b), BRANCH.indexOf(saju.month.b), BRANCH.indexOf(saju.day.b)];
    if (saju.hour) { stems.push(STEM.indexOf(saju.hour.s)); brs.push(BRANCH.indexOf(saju.hour.b)); }
    
    // ì²œê°„í•©
    const stComb = [[0,5,'ê°‘ê¸°í•©í† '],[1,6,'ì„ê²½í•©ê¸ˆ'],[2,7,'ë³‘ì‹ í•©ìˆ˜'],[3,8,'ì •ì„í•©ëª©'],[4,9,'ë¬´ê³„í•©í™”']];
    for (let [a,b,n] of stComb) {
        for (let i = 0; i < stems.length; i++) {
            for (let j = i+1; j < stems.length; j++) {
                if ((stems[i]===a && stems[j]===b) || (stems[i]===b && stems[j]===a)) {
                    res.push({t:'å¤©åˆ',c:`${STEM[a].c}+${STEM[b].c}`,m:n,d:'ì²œê°„ì´ í•©í•˜ì—¬ ìƒˆë¡œìš´ ê¸°ìš´ì„ ë§Œë“¤ì–´ìš”!'});
                }
            }
        }
    }
    
    // ì²œê°„ì¶© (å¤©å¹²æ²–) - ìƒˆë¡œ ì¶”ê°€
    const stClash = [
        [0,6,'ê°‘ê²½ì¶©','ê°•í•œ ê²°ë‹¨ë ¥ì´ì§€ë§Œ ì¶©ëŒì´ ë§ì•„ìš”. ë¦¬ë”ì‹­ê³¼ ê¶Œìœ„ì˜ ê°ˆë“±!'],
        [1,7,'ì„ì‹ ì¶©','ë‚´ë©´ì˜ ê°ˆë“±. ìœ ì—°í•¨ê³¼ ê°•í•¨ì´ ë¶€ë”ªí˜€ìš”.'],
        [2,8,'ë³‘ì„ì¶©','ì—´ì •ê³¼ ì§€í˜œê°€ ì¶©ëŒ. ì„±ê¸‰í•¨ ì¡°ì‹¬!'],
        [3,9,'ì •ê³„ì¶©','ê°ì„±ê³¼ ì´ì„±ì´ ì¶©ëŒ. ê°ì • ê¸°ë³µì´ ìˆì–´ìš”.'],
        [4,4,'ë¬´ë¬´ë¹„ê²¬','ê³ ì§‘ì´ ì„¸ê³  ìê¸°ì£¼ì¥ì´ ê°•í•´ìš”.'],
        [5,5,'ê¸°ê¸°ë¹„ê²¬','ìˆœìˆ˜í•˜ì§€ë§Œ ìš°ìœ ë¶€ë‹¨í•  ìˆ˜ ìˆì–´ìš”.']
    ];
    for (let [a,b,n,desc] of stClash) {
        for (let i = 0; i < stems.length; i++) {
            for (let j = i+1; j < stems.length; j++) {
                if ((stems[i]===a && stems[j]===b) || (stems[i]===b && stems[j]===a)) {
                    res.push({t:'å¤©æ²–',c:`${STEM[a].c}â†”${STEM[b].c}`,m:n,d:desc});
                }
            }
        }
    }
    
    // ì§€ì§€ ìœ¡í•©
    const hap = [[0,1,'ìì¶•í•©í† '],[2,11,'ì¸í•´í•©ëª©'],[3,10,'ë¬˜ìˆ í•©í™”'],[4,9,'ì§„ìœ í•©ê¸ˆ'],[5,8,'ì‚¬ì‹ í•©ìˆ˜'],[6,7,'ì˜¤ë¯¸í•©í™”']];
    for (let [a,b,n] of hap) {
        if (brs.includes(a) && brs.includes(b)) res.push({t:'å…­åˆ',c:`${BRANCH[a].c}+${BRANCH[b].c}`,m:n,d:'ì§€ì§€ê°€ í•©í•˜ì—¬ í™”í•©í•˜ëŠ” ê¸°ìš´! ì¢‹ì€ ì¸ì—°!'});
    }
    
    // ì‚¼í•©
    const samhap = [[2,6,10,'ì¸ì˜¤ìˆ  í™”êµ­'],[5,9,1,'ì‚¬ìœ ì¶• ê¸ˆêµ­'],[8,0,4,'ì‹ ìì§„ ìˆ˜êµ­'],[11,3,7,'í•´ë¬˜ë¯¸ ëª©êµ­']];
    for (let [a,b,c,n] of samhap) {
        const has = [brs.includes(a), brs.includes(b), brs.includes(c)];
        if (has.filter(x=>x).length === 3) res.push({t:'ä¸‰åˆ',c:`${BRANCH[a].c}${BRANCH[b].c}${BRANCH[c].c}`,m:n,d:'ì™„ì „í•œ ì‚¼í•©! ê°•ë ¥í•œ ê¸°ìš´ì´ í˜•ì„±ë¼ìš”!'});
        else if (has.filter(x=>x).length === 2 && has[1]) res.push({t:'åŠåˆ',c:has[0]?`${BRANCH[a].c}${BRANCH[b].c}`:has[2]?`${BRANCH[b].c}${BRANCH[c].c}`:'',m:n.split(' ')[0]+' ë°˜í•©',d:'ë°˜ìª½ ì‚¼í•©. ë¶€ë¶„ì ìœ¼ë¡œ ê¸°ìš´ì´ í˜•ì„±ë¼ìš”.'});
    }
    
    // ì¶©
    const clash = [[0,6,'ìì˜¤ì¶©','ë‚¨ë¶ ì¶©ëŒ! ë§ˆìŒê³¼ í˜„ì‹¤ì´ ê°ˆë“±í•´ìš”.'],[1,7,'ì¶•ë¯¸ì¶©','ì¬ë¬¼ ê´€ë ¨ ë³€ë™ì´ ìˆì–´ìš”.'],[2,8,'ì¸ì‹ ì¶©','í™œë™ëŸ‰ ë§ì•„ì§€ê³  ë°”ë¹ ì ¸ìš”. êµí†µì‚¬ê³  ì£¼ì˜!'],[3,9,'ë¬˜ìœ ì¶©','ë¬¸ì„œ, ê³„ì•½ ë¬¸ì œ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”.'],[4,10,'ì§„ìˆ ì¶©','ê³ ì§‘ ë•Œë¬¸ì— ì¶©ëŒí•´ìš”.'],[5,11,'ì‚¬í•´ì¶©','ê³„íšëŒ€ë¡œ ì•ˆ ë  ìˆ˜ ìˆì–´ìš”.']];
    for (let [a,b,n,desc] of clash) {
        const ia = brs.indexOf(a), ib = brs.indexOf(b);
        if (ia >= 0 && ib >= 0) {
            const dist = Math.abs(ia - ib);
            const strength = dist === 1 ? 'âš¡ê°•í•œ ì¶©' : dist === 2 ? 'ë³´í†µ ì¶©' : 'ì•½í•œ ì¶©';
            res.push({t:'æ²–',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:`${n} (${strength})`,d:desc});
        }
    }
    
    // í˜• (ì„¸ë¶„í™”) - ì‚¼í˜•, ìƒí˜•, ìí˜•
    // 1. ì‚¼í˜• (ä¸‰åˆ‘) - ì¸ì‚¬ì‹ 
    if (brs.includes(2) && brs.includes(5) && brs.includes(8)) {
        res.push({t:'ä¸‰åˆ‘',c:'å¯…å·³ç”³',m:'ë¬´ì€ì§€í˜•(ç„¡æ©ä¹‹åˆ‘)',d:'ì€í˜œë¥¼ ëª¨ë¥´ëŠ” í˜•! ë°°ì€ë§ë• ì¡°ì‹¬. í° ì‚¬ê³ , ê´€ì¬ ì£¼ì˜!'});
    }
    // 2. ì¶•ìˆ ë¯¸ ì‚¼í˜•
    if (brs.includes(1) && brs.includes(10) && brs.includes(7)) {
        res.push({t:'ä¸‰åˆ‘',c:'ä¸‘æˆŒæœª',m:'ë¬´ë¡€ì§€í˜•(ç„¡ç¦®ä¹‹åˆ‘)',d:'ì˜ˆì˜ ì—†ëŠ” í˜•! ê³ ì§‘ ì„¸ê³  ë¶ˆí™”. ëŒ€ì¸ê´€ê³„ ì¡°ì‹¬!'});
    }
    // 3. ìƒí˜• (ç›¸åˆ‘) - ë‘ ê¸€ì
    const brHyung = [
        [2,5,'ì¸ì‚¬í˜•(å¯…å·³åˆ‘)','ë¬´ì€ì§€í˜• ë¶€ë¶„. ë°°ì‹ , êµ¬ì„¤ ì¡°ì‹¬!'],
        [5,8,'ì‚¬ì‹ í˜•(å·³ç”³åˆ‘)','ë¬´ì€ì§€í˜• ë¶€ë¶„. ëƒ‰ì •í•˜ê³  ê°ˆë“± ë§ì•„ìš”.'],
        [2,8,'ì¸ì‹ í˜•(å¯…ç”³åˆ‘)','ì¶©ëŒí•˜ë©´ì„œë„ ëŒë¦¬ëŠ” ê´€ê³„. êµí†µì‚¬ê³  ì£¼ì˜!'],
        [1,10,'ì¶•ìˆ í˜•(ä¸‘æˆŒåˆ‘)','ë¬´ë¡€ì§€í˜• ë¶€ë¶„. ê³ ì§‘ìœ¼ë¡œ ì¶©ëŒ!'],
        [10,7,'ìˆ ë¯¸í˜•(æˆŒæœªåˆ‘)','ë¬´ë¡€ì§€í˜• ë¶€ë¶„. í† ë¼ë¦¬ ë‹¤íˆ¼!'],
        [1,7,'ì¶•ë¯¸í˜•(ä¸‘æœªåˆ‘)','ë¬´ë¡€ì§€í˜• ë¶€ë¶„. ì¬ë¬¼ ë‹¤íˆ¼!'],
        [0,3,'ìë¬˜í˜•(å­å¯åˆ‘)','ë¬´ë¡€ì§€í˜•. ì˜ˆì˜ ìƒê¸° ì‰¬ì›Œìš”. ë§ì‹¤ìˆ˜ ì¡°ì‹¬!']
    ];
    for (let [a,b,n,desc] of brHyung) {
        const ia = brs.indexOf(a), ib = brs.indexOf(b);
        if (ia >= 0 && ib >= 0) {
            // ì‚¼í˜•ì— ì´ë¯¸ í¬í•¨ëœ ê²½ìš° ì¤‘ë³µ ì œì™¸
            if (!(brs.includes(2) && brs.includes(5) && brs.includes(8) && [2,5,8].includes(a) && [2,5,8].includes(b)) &&
                !(brs.includes(1) && brs.includes(10) && brs.includes(7) && [1,10,7].includes(a) && [1,10,7].includes(b))) {
                res.push({t:'åˆ‘',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:n,d:desc});
            }
        }
    }
    // 4. ìí˜• (è‡ªåˆ‘) - ê°™ì€ ê¸€ìë¼ë¦¬
    const selfPunish = {4:'ì§„ì§„ìí˜•(è¾°è¾°è‡ªåˆ‘)',6:'ì˜¤ì˜¤ìí˜•(åˆåˆè‡ªåˆ‘)',9:'ìœ ìœ ìí˜•(é…‰é…‰è‡ªåˆ‘)',11:'í•´í•´ìí˜•(äº¥äº¥è‡ªåˆ‘)'};
    for (let i = 0; i < brs.length; i++) {
        for (let j = i+1; j < brs.length; j++) {
            if (brs[i] === brs[j] && selfPunish[brs[i]]) {
                res.push({t:'è‡ªåˆ‘',c:`${BRANCH[brs[i]].c}+${BRANCH[brs[j]].c}`,m:selfPunish[brs[i]],d:'ìê¸° ìì‹ ì„ í•´ì¹˜ëŠ” í˜•. ìì±…, ìš°ìš¸ ì¡°ì‹¬! ìŠ¤ìŠ¤ë¡œë¥¼ ì‚¬ë‘í•˜ì„¸ìš”.'});
            }
        }
    }
    
    // íŒŒ
    const brPa = [[0,9,'ììœ íŒŒ','ê´€ê³„ ê¹¨ì§€ê¸° ì‰¬ì›Œìš”.'],[3,6,'ë¬˜ì˜¤íŒŒ','ê³„íš í‹€ì–´ì ¸ìš”.'],[2,11,'ì¸í•´íŒŒ','ë§ˆë¬´ë¦¬ ì˜ í•˜ì„¸ìš”.'],[4,1,'ì§„ì¶•íŒŒ','ê¸°ë°˜ í”ë“¤ë ¤ìš”.']];
    for (let [a,b,n,desc] of brPa) {
        if (brs.includes(a) && brs.includes(b)) res.push({t:'ç ´',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:n,d:desc});
    }
    
    // í•´
    const brHae = [[0,7,'ìë¯¸í•´','ê°€ê¹Œìš´ ì‚¬ëŒì´ ë°œëª© ì¡ì•„ìš”.'],[1,6,'ì¶•ì˜¤í•´','ë™ì—… ì¡°ì‹¬!'],[2,5,'ì¸ì‚¬í•´','ì‹œê¸°ë°›ì•„ìš”. ë„ˆë¬´ ë“œëŸ¬ë‚´ì§€ ë§ˆì„¸ìš”.'],[3,4,'ë¬˜ì§„í•´','ì‚¬ì†Œí•œ ì¼ë¡œ í° ì‹¸ì›€ ë‚˜ìš”.']];
    for (let [a,b,n,desc] of brHae) {
        if (brs.includes(a) && brs.includes(b)) res.push({t:'å®³',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:n,d:desc});
    }
    
    // ì›ì§„ (æ€¨å—”) - ê¶í•©ì—ì„œ ì¤‘ìš”
    const wonJin = [[0,7,'ìë¯¸ì›ì§„'],[1,6,'ì¶•ì˜¤ì›ì§„'],[2,5,'ì¸ì‚¬ì›ì§„'],[3,4,'ë¬˜ì§„ì›ì§„'],[4,3,'ì§„ë¬˜ì›ì§„'],[5,2,'ì‚¬ì¸ì›ì§„'],[6,1,'ì˜¤ì¶•ì›ì§„'],[7,0,'ë¯¸ìì›ì§„'],[8,11,'ì‹ í•´ì›ì§„'],[9,10,'ìœ ìˆ ì›ì§„'],[10,9,'ìˆ ìœ ì›ì§„'],[11,8,'í•´ì‹ ì›ì§„']];
    for (let [a,b,n] of wonJin) {
        if (brs.includes(a) && brs.includes(b)) {
            res.push({t:'æ€¨å—”',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:n,d:'ë¯¸ì›Œë„ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ì•…ì—°. ë¶€ë¶€ ì‚¬ì´ë©´ ê°ˆë“±ì´ ê¹Šì–´ìš”.'});
        }
    }
    
    // ê·€ë¬¸ (é¬¼é–€)
    const guiMen = [[2,7,'ì¸ë¯¸ê·€ë¬¸'],[3,8,'ë¬˜ì‹ ê·€ë¬¸'],[4,9,'ì§„ìœ ê·€ë¬¸'],[5,10,'ì‚¬ìˆ ê·€ë¬¸'],[6,11,'ì˜¤í•´ê·€ë¬¸'],[1,6,'ì¶•ì˜¤ê·€ë¬¸']];
    for (let [a,b,n] of guiMen) {
        if (brs.includes(a) && brs.includes(b)) {
            res.push({t:'é¬¼é–€',c:`${BRANCH[a].c}â†”${BRANCH[b].c}`,m:n,d:'ê·€ì‹ ì˜ ë¬¸. ì •ì‹ ì  ë¶ˆì•ˆ, ìš°ìš¸ì¦ ì£¼ì˜. ëª…ìƒê³¼ íœ´ì‹ì´ í•„ìš”í•´ìš”.'});
        }
    }
    
    return res.length ? res : [{t:'-',c:'ì—†ìŒ',m:'íŠ¹ë³„í•œ í•©ì¶©í˜•íŒŒí•´ ì—†ìŒ',d:'ì‚¬ì£¼ ë‚´ íŠ¹ë³„í•œ ì‘ìš©ì´ ì—†ì–´ìš”. í‰ì˜¨í•œ ì‚¬ì£¼!'}];
}

/* ========================================
   14. ê³µë§
   ======================================== */
function calcGongmang(saju) {
    // ì¼ì£¼ì˜ 60ê°‘ì ì¸ë±ìŠ¤ ê³„ì‚°
    const stemIdx = STEM.indexOf(saju.day.s);
    const branchIdx = BRANCH.indexOf(saju.day.b);
    
    // 60ê°‘ì ì¸ë±ìŠ¤ = (ì²œê°„ì¸ë±ìŠ¤ * 12 + ì§€ì§€ì¸ë±ìŠ¤) ë°©ì‹ì´ ì•„ë‹ˆë¼
    // ì²œê°„ê³¼ ì§€ì§€ì˜ ìŒì–‘ì´ ë§ì•„ì•¼ í•¨. ì˜¬ë°”ë¥¸ ê³µì‹:
    // 60ê°‘ì ìˆœì„œ: ê°‘ì(0), ì„ì¶•(1), ë³‘ì¸(2)... 
    // ì¸ë±ìŠ¤ = (ì²œê°„ì¸ë±ìŠ¤ - ì§€ì§€ì¸ë±ìŠ¤ + 12) % 12 ê°€ 0ì´ë©´ ê°™ì€ ìŒì–‘
    // ì‹¤ì œ 60ê°‘ì ì¸ë±ìŠ¤ ê³„ì‚°: stemIdx * 6 + (branchIdxê°€ stemIdxì™€ ê°™ì€ ìŒì–‘ì¼ ë•Œì˜ ìˆœì„œ)
    
    // ë” ê°„ë‹¨í•œ ë°©ë²•: ì¼ì£¼ê°€ ì†í•œ ìˆœ(æ—¬) ì°¾ê¸°
    // ê° ìˆœì€ ê°‘(ç”²)ìœ¼ë¡œ ì‹œì‘í•˜ë¯€ë¡œ, ì¼ê°„ì—ì„œ ê°‘ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ êµ¬í•˜ê³ 
    // ê·¸ë§Œí¼ ì§€ì§€ì—ì„œ ë¹¼ë©´ ìˆœë‘(æ—¬é ­)ì˜ ì§€ì§€ê°€ ë‚˜ì˜´
    const distFromGap = stemIdx; // ê°‘(0)ì—ì„œ ì¼ê°„ê¹Œì§€ì˜ ê±°ë¦¬
    const xunHeadBranch = (branchIdx - distFromGap + 12) % 12; // ìˆœë‘ì˜ ì§€ì§€
    
    // ìˆœë‘ ì§€ì§€ì— ë”°ë¥¸ ê³µë§
    // ê°‘ììˆœ(ì=0) â†’ ê³µë§: ìˆ (10), í•´(11)
    // ê°‘ìˆ ìˆœ(ìˆ =10) â†’ ê³µë§: ì‹ (8), ìœ (9)  
    // ê°‘ì‹ ìˆœ(ì‹ =8) â†’ ê³µë§: ì˜¤(6), ë¯¸(7)
    // ê°‘ì˜¤ìˆœ(ì˜¤=6) â†’ ê³µë§: ì§„(4), ì‚¬(5)
    // ê°‘ì§„ìˆœ(ì§„=4) â†’ ê³µë§: ì¸(2), ë¬˜(3)
    // ê°‘ì¸ìˆœ(ì¸=2) â†’ ê³µë§: ì(0), ì¶•(1)
    
    const GONGMANG_MAP = {
        0: [10, 11],  // ê°‘ììˆœ â†’ ìˆ í•´ ê³µë§
        10: [8, 9],   // ê°‘ìˆ ìˆœ â†’ ì‹ ìœ  ê³µë§
        8: [6, 7],    // ê°‘ì‹ ìˆœ â†’ ì˜¤ë¯¸ ê³µë§
        6: [4, 5],    // ê°‘ì˜¤ìˆœ â†’ ì§„ì‚¬ ê³µë§
        4: [2, 3],    // ê°‘ì§„ìˆœ â†’ ì¸ë¬˜ ê³µë§
        2: [0, 1]     // ê°‘ì¸ìˆœ â†’ ìì¶• ê³µë§
    };
    
    const gm = GONGMANG_MAP[xunHeadBranch] || [10, 11];
    const names = [BRANCH[gm[0]].c, BRANCH[gm[1]].c];
    const affected = [];
    const pillars = ['ë…„ì§€','ì›”ì§€','ì¼ì§€','ì‹œì§€'];
    const brs = [BRANCH.indexOf(saju.year.b), BRANCH.indexOf(saju.month.b), BRANCH.indexOf(saju.day.b)];
    if (saju.hour) brs.push(BRANCH.indexOf(saju.hour.b));
    
    brs.forEach((b, i) => { if (gm.includes(b)) affected.push(pillars[i]); });
    
    return { gm, names, affected };
}

/* ========================================
   14-0-1. ìœ¡ì¹œë¡ (å…­è¦ªè«–) - ë¶€ëª¨/í˜•ì œ/ìë…€/ë°°ìš°ì ìš´
   ======================================== */
function analyzeYukChinRon(saju, gender) {
    const dm = saju.day.s;
    const result = {
        father: null,    // ë¶€ì¹œ (í¸ì¬)
        mother: null,    // ëª¨ì¹œ (ì •ì¸/í¸ì¸)
        sibling: null,   // í˜•ì œ (ë¹„ê²¬/ê²ì¬)
        spouse: null,    // ë°°ìš°ì (ë‚¨:ì¬ì„±, ì—¬:ê´€ì„±)
        children: null   // ìë…€ (ë‚¨:ê´€ì„±, ì—¬:ì‹ìƒ)
    };
    
    // ì‹­ì‹  ë¶„í¬ ë¶„ì„
    const godCount = {};
    const godPositions = {};
    const pillars = [
        {name: 'ë…„ì£¼', pillar: saju.year},
        {name: 'ì›”ì£¼', pillar: saju.month},
        {name: 'ì¼ì£¼', pillar: saju.day},
    ];
    if (saju.hour) pillars.push({name: 'ì‹œì£¼', pillar: saju.hour});
    
    pillars.forEach(p => {
        if (p.name === 'ì¼ì£¼') return; // ì¼ê°„ì€ ì œì™¸
        const sGod = getTenGod(p.pillar.s, dm);
        const bGod = getTenGod(p.pillar.b, dm); // ì§€ì§€ì˜ ë³¸ê¸° ê¸°ì¤€
        
        [sGod, bGod].forEach(god => {
            if (god) {
                if (!godCount[god.k]) godCount[god.k] = 0;
                if (!godPositions[god.k]) godPositions[god.k] = [];
                godCount[god.k]++;
                godPositions[god.k].push(p.name);
            }
        });
    });
    
    // 1. ë¶€ì¹œìš´ (í¸ì¬)
    const fatherGod = 'í¸ì¬';
    const fatherCount = godCount[fatherGod] || 0;
    if (fatherCount >= 2) {
        result.father = {status: 'strong', desc: 'ì•„ë²„ì§€ì™€ ì¸ì—°ì´ ê¹Šì–´ìš”. ì•„ë²„ì§€ì˜ ë„ì›€ì„ ë°›ì•„ìš”.', icon: 'ğŸ‘¨â€ğŸ‘¦'};
    } else if (fatherCount === 1) {
        result.father = {status: 'normal', desc: 'ì•„ë²„ì§€ì™€ í‰ë²”í•œ ê´€ê³„ì˜ˆìš”. ì ë‹¹í•œ ê±°ë¦¬ê°ì´ ì¢‹ì•„ìš”.', icon: 'ğŸ‘¨'};
    } else {
        result.father = {status: 'weak', desc: 'ì•„ë²„ì§€ì™€ ì¸ì—°ì´ ì•½í•˜ê±°ë‚˜ ì¼ì° ë–¨ì–´ì ¸ ì‚´ ìˆ˜ ìˆì–´ìš”.', icon: 'ğŸ‘¤'};
    }
    
    // 2. ëª¨ì¹œìš´ (ì •ì¸/í¸ì¸)
    const motherCount = (godCount['ì •ì¸'] || 0) + (godCount['í¸ì¸'] || 0);
    if (motherCount >= 2) {
        result.mother = {status: 'strong', desc: 'ì–´ë¨¸ë‹ˆì™€ ì¸ì—°ì´ ê¹Šì–´ìš”. ì–´ë¨¸ë‹ˆì˜ ì‚¬ë‘ì„ ë§ì´ ë°›ì•„ìš”.', icon: 'ğŸ‘©â€ğŸ‘¦'};
    } else if (motherCount === 1) {
        result.mother = {status: 'normal', desc: 'ì–´ë¨¸ë‹ˆì™€ í‰ë²”í•œ ê´€ê³„ì˜ˆìš”.', icon: 'ğŸ‘©'};
    } else {
        result.mother = {status: 'weak', desc: 'ì–´ë¨¸ë‹ˆì™€ ì¸ì—°ì´ ì•½í•˜ê±°ë‚˜ ë…ë¦½ì´ ë¹ ë¥¼ ìˆ˜ ìˆì–´ìš”.', icon: 'ğŸ‘¤'};
    }
    
    // 3. í˜•ì œìš´ (ë¹„ê²¬/ê²ì¬)
    const siblingCount = (godCount['ë¹„ê²¬'] || 0) + (godCount['ê²ì¬'] || 0);
    if (siblingCount >= 2) {
        result.sibling = {status: 'strong', desc: 'í˜•ì œ ìë§¤ê°€ ë§ê±°ë‚˜ ì¸ì—°ì´ ê¹Šì–´ìš”. ê²½ìŸë„ ìˆì„ ìˆ˜ ìˆì–´ìš”.', icon: 'ğŸ‘«'};
    } else if (siblingCount === 1) {
        result.sibling = {status: 'normal', desc: 'í˜•ì œ ìë§¤ì™€ í‰ë²”í•œ ê´€ê³„ì˜ˆìš”.', icon: 'ğŸ§‘â€ğŸ¤â€ğŸ§‘'};
    } else {
        result.sibling = {status: 'weak', desc: 'í˜•ì œ ìë§¤ê°€ ì ê±°ë‚˜ ì¸ì—°ì´ ì•½í•´ìš”. ë…ë¦½ì‹¬ì´ ê°•í•´ìš”.', icon: 'ğŸ§'};
    }
    
    // 4. ë°°ìš°ììš´ (ë‚¨:ì¬ì„±, ì—¬:ê´€ì„±)
    let spouseCount, spouseGods;
    if (gender === 'm') {
        spouseCount = (godCount['ì •ì¬'] || 0) + (godCount['í¸ì¬'] || 0);
        spouseGods = ['ì •ì¬', 'í¸ì¬'];
    } else {
        spouseCount = (godCount['ì •ê´€'] || 0) + (godCount['í¸ê´€'] || 0);
        spouseGods = ['ì •ê´€', 'í¸ê´€'];
    }
    
    // ì¼ì§€(ë°°ìš°ìê¶) ë¶„ì„
    const spouseGod = getTenGod(saju.day.b, dm);
    const spouseGodMatch = spouseGod && spouseGods.includes(spouseGod.k);
    
    if (spouseCount >= 2 && spouseGodMatch) {
        result.spouse = {status: 'excellent', desc: 'ë°°ìš°ì ë³µì´ ì•„ì£¼ ì¢‹ì•„ìš”! ì¢‹ì€ ì§ì„ ë§Œë‚˜ìš”.', icon: 'ğŸ’‘'};
    } else if (spouseCount >= 1 || spouseGodMatch) {
        result.spouse = {status: 'good', desc: 'ë°°ìš°ì ìš´ì´ ì¢‹ì€ í¸ì´ì—ìš”. ê²°í˜¼í•˜ë©´ ì•ˆì •ë¼ìš”.', icon: 'ğŸ’'};
    } else {
        result.spouse = {status: 'normal', desc: 'ë°°ìš°ì ì¸ì—°ì€ í‰ë²”í•´ìš”. ëŠ¦ê²Œ ë§Œë‚˜ë„ ê´œì°®ì•„ìš”.', icon: 'ğŸ’’'};
    }
    
    // 5. ìë…€ìš´ (ë‚¨:ê´€ì„±, ì—¬:ì‹ìƒ)
    let childCount;
    if (gender === 'm') {
        childCount = (godCount['ì •ê´€'] || 0) + (godCount['í¸ê´€'] || 0);
    } else {
        childCount = (godCount['ì‹ì‹ '] || 0) + (godCount['ìƒê´€'] || 0);
    }
    
    // ì‹œì£¼(ìë…€ê¶) ë¶„ì„
    const hasHour = !!saju.hour;
    if (childCount >= 2) {
        result.children = {status: 'strong', desc: 'ìë…€ ë³µì´ ì¢‹ì•„ìš”! ìë…€ê°€ ë¶€ëª¨ë¥¼ ë¹›ë‚´ì¤˜ìš”.', icon: 'ğŸ‘¶ğŸ‘¶'};
    } else if (childCount === 1) {
        result.children = {status: 'normal', desc: 'ìë…€ì™€ í‰ë²”í•œ ì¸ì—°ì´ì—ìš”. 1-2ëª… ì •ë„ê°€ ì¢‹ì•„ìš”.', icon: 'ğŸ‘¶'};
    } else {
        result.children = {status: 'weak', desc: 'ìë…€ ì¸ì—°ì´ ì•½í•˜ê±°ë‚˜ ëŠ¦ì„ ìˆ˜ ìˆì–´ìš”. ë…¸ë ¥ì´ í•„ìš”í•´ìš”.', icon: 'ğŸ¼'};
    }
    
    return result;
}

/* ========================================
   14-0-2. ì§ˆë³‘ë¡ (ç–¾ç—…è«–) - ì˜¤í–‰ë³„ ê±´ê°•
   ======================================== */
function analyzeHealth(saju, gods) {
    const result = {
        strong: [],  // ê°•í•œ ì˜¤í–‰ (ê³¼ì‰)
        weak: [],    // ì•½í•œ ì˜¤í–‰ (ë¶€ì¡±)
        advice: []   // ê±´ê°• ì¡°ì–¸
    };
    
    // ì˜¤í–‰ ë¶„í¬ ê³„ì‚°
    const elCount = {wood:0, fire:0, earth:0, metal:0, water:0};
    [saju.year, saju.month, saju.day, saju.hour].forEach(p => {
        if (p && p.s) elCount[p.s.e]++;
        if (p && p.b) elCount[p.b.e]++;
    });
    
    // ì˜¤í–‰ë³„ ì¥ê¸°/ì§ˆë³‘ ë§¤í•‘
    const healthMap = {
        wood: {
            organ: 'ê°„ì¥(è‚), ë‹´ë‚­, ëˆˆ, ê·¼ìœ¡, ì†í†±',
            excess: 'ë‘í†µ, ëˆˆ ì¶©í˜ˆ, ê·¼ìœ¡ ê²½ë ¨, í™”ë¥¼ ì˜ ëƒ„',
            deficient: 'ì‹œë ¥ ì €í•˜, í”¼ë¡œ, ê·¼ë ¥ ì•½í™”, ì†í†± ê°ˆë¼ì§',
            advice: 'í‘¸ë¥¸ ì±„ì†Œ ì„­ì·¨, ëˆˆ íœ´ì‹, ìŠ¤íŠ¸ë ˆì¹­'
        },
        fire: {
            organ: 'ì‹¬ì¥(å¿ƒ), ì†Œì¥, í˜€, í˜ˆê´€',
            excess: 'ë¶ˆë©´ì¦, ê°€ìŠ´ ë‘ê·¼ê±°ë¦¼, í˜€ ì—¼ì¦, ê³ í˜ˆì••',
            deficient: 'ì €í˜ˆì••, ì†ë°œ ì°¨ê°€ì›€, ìš°ìš¸ì¦, ë¬´ê¸°ë ¥',
            advice: 'ë¶‰ì€ ìŒì‹(í† ë§ˆí† , ëŒ€ì¶”), ìœ ì‚°ì†Œ ìš´ë™, ëª…ìƒ'
        },
        earth: {
            organ: 'ë¹„ì¥(è„¾), ìœ„ì¥, ì…ìˆ , ì‚´',
            excess: 'ì†Œí™”ë¶ˆëŸ‰, ë¹„ë§Œ, ì…ìˆ  íŠ¸ê¸°, ê±±ì • ê³¼ë‹¤',
            deficient: 'ì‹ìš•ë¶€ì§„, ë§ˆë¦„, ì†Œí™”ë ¥ ì•½í•¨, ë¬´ë ¥ê°',
            advice: 'ë…¸ë€ ìŒì‹(ê³ êµ¬ë§ˆ, í˜¸ë°•), ê·œì¹™ì  ì‹ì‚¬, ê³¼ì‹ ê¸ˆì§€'
        },
        metal: {
            organ: 'í(è‚º), ëŒ€ì¥, ì½”, í”¼ë¶€, í„¸',
            excess: 'í”¼ë¶€ íŠ¸ëŸ¬ë¸”, ë³€ë¹„, í˜¸í¡ê¸° ê³¼ë¯¼',
            deficient: 'ê°ê¸° ì¦ìŒ, í”¼ë¶€ ê±´ì¡°, ëŒ€ì¥ ì•½í•¨, ìŠ¬í”” ë§ìŒ',
            advice: 'í° ìŒì‹(ë¬´, ë°°, ë„ë¼ì§€), í˜¸í¡ ìš´ë™, í”¼ë¶€ ë³´ìŠµ'
        },
        water: {
            organ: 'ì‹ ì¥(è…), ë°©ê´‘, ê·€, ë¼ˆ, ë¨¸ë¦¬ì¹´ë½',
            excess: 'ë¶€ì¢…, ì•¼ë‡¨ì¦, ë‘ë ¤ì›€ ê³¼ë‹¤',
            deficient: 'í—ˆë¦¬ ì•½í•¨, íƒˆëª¨, ì´ëª…, ì •ë ¥ ì €í•˜, ë¼ˆ ì•½í•¨',
            advice: 'ê²€ì€ ìŒì‹(ê²€ì€ì½©, ë¯¸ì—­), ì¶©ë¶„í•œ ìˆ˜ë¶„, í—ˆë¦¬ ìš´ë™'
        }
    };
    
    const elNames = {wood:'ëª©(æœ¨)', fire:'í™”(ç«)', earth:'í† (åœŸ)', metal:'ê¸ˆ(é‡‘)', water:'ìˆ˜(æ°´)'};
    
    // ë¶„ì„
    for (const el in elCount) {
        const count = elCount[el];
        const info = healthMap[el];
        
        if (count >= 3) {
            result.strong.push({
                element: elNames[el],
                count: count,
                organ: info.organ,
                symptom: info.excess,
                icon: 'âš ï¸'
            });
        } else if (count === 0) {
            result.weak.push({
                element: elNames[el],
                count: count,
                organ: info.organ,
                symptom: info.deficient,
                icon: 'â—'
            });
        }
    }
    
    // ìš©ì‹ /ê¸°ì‹  ê¸°ë°˜ ì¡°ì–¸
    if (gods.yong) {
        const yongInfo = healthMap[gods.yong];
        if (yongInfo) {
            result.advice.push({
                title: `ìš©ì‹ (${elNames[gods.yong]}) ë³´ê°•`,
                desc: yongInfo.advice,
                icon: 'ğŸ’ª'
            });
        }
    }
    
    // ê°€ì¥ ì•½í•œ ì˜¤í–‰ ì°¾ê¸°
    let minEl = null, minCount = 10;
    for (const el in elCount) {
        if (elCount[el] < minCount) {
            minCount = elCount[el];
            minEl = el;
        }
    }
    if (minEl && healthMap[minEl]) {
        result.advice.push({
            title: `ë¶€ì¡±í•œ ${elNames[minEl]} ë³´ê°•`,
            desc: healthMap[minEl].advice,
            icon: 'ğŸ©º'
        });
    }
    
    // ê³„ì ˆ ì¡°ì–¸ (ì›”ì§€ ê¸°ì¤€)
    const monthEl = saju.month.b.e;
    if (monthEl === 'water' || monthEl === 'metal') {
        result.advice.push({
            title: 'ì°¨ê°€ìš´ ê¸°ìš´ ì£¼ì˜',
            desc: 'ê°€ì„/ê²¨ìš¸ì— íƒœì–´ë‚˜ ëª¸ì´ ì°° ìˆ˜ ìˆì–´ìš”. ë”°ëœ»í•˜ê²Œ!',
            icon: 'ğŸ”¥'
        });
    } else if (monthEl === 'fire') {
        result.advice.push({
            title: 'ë”ìš´ ê¸°ìš´ ì£¼ì˜',
            desc: 'ì—¬ë¦„ì— íƒœì–´ë‚˜ ì—´ì´ ë§ì„ ìˆ˜ ìˆì–´ìš”. ì‹œì›í•˜ê²Œ!',
            icon: 'â„ï¸'
        });
    }
    
    return result;
}

/* ========================================
   14-0. ê¶ìœ„(å®®ä½) ë¶„ì„
   ======================================== */
function analyzeGungwi(saju, birthYear) {
    const dm = saju.day.s;
    const curAge = new Date().getFullYear() - birthYear;
    
    // ê³µë§ ê³„ì‚°
    const gongmang = calcGongmang(saju);
    const gmBranches = gongmang.gm; // ê³µë§ ì§€ì§€ ì¸ë±ìŠ¤ ë°°ì—´
    
    // ê¶ìœ„ ì •ì˜
    const gungwi = [
        {
            name: 'ë…„ì£¼(å¹´æŸ±)',
            alias: 'ì¡°ìƒê¶Â·ì‚¬íšŒê¶',
            pillar: saju.year,
            ageRange: '1-15ì„¸',
            represents: 'ì¡°ìƒ, ë¶€ëª¨ì˜ ë¶€ëª¨, ì‚¬íšŒì  í™˜ê²½, ì´ˆë…„ìš´',
            bodyPart: 'ë¨¸ë¦¬, ì–¼êµ´',
            relationM: 'ì¡°ë¶€, ì™¸ê°€',
            relationF: 'ì¡°ëª¨, ì™¸ê°€'
        },
        {
            name: 'ì›”ì£¼(æœˆæŸ±)',
            alias: 'ë¶€ëª¨ê¶Â·ì§ì—…ê¶',
            pillar: saju.month,
            ageRange: '16-30ì„¸',
            represents: 'ë¶€ëª¨, í˜•ì œ, ì§ì—…, ì‚¬ì—…, ì²­ë…„ìš´',
            bodyPart: 'ê°€ìŠ´, ì–´ê¹¨',
            relationM: 'ë¶€ì¹œ, í˜•ì œ',
            relationF: 'ëª¨ì¹œ, ìë§¤'
        },
        {
            name: 'ì¼ì£¼(æ—¥æŸ±)',
            alias: 'ë°°ìš°ìê¶Â·ë³¸ì¸ê¶',
            pillar: saju.day,
            ageRange: '31-45ì„¸',
            represents: 'ë³¸ì¸, ë°°ìš°ì, ê°€ì •, ì¤‘ë…„ìš´',
            bodyPart: 'í—ˆë¦¬, ë³µë¶€',
            relationM: 'ì²˜, ìê¸°ìì‹ ',
            relationF: 'ë¶€, ìê¸°ìì‹ '
        },
        {
            name: 'ì‹œì£¼(æ™‚æŸ±)',
            alias: 'ìë…€ê¶Â·ë§ë…„ê¶',
            pillar: saju.hour,
            ageRange: '46ì„¸ ì´í›„',
            represents: 'ìë…€, ì œì, í›„ë°°, ë§ë…„ìš´, ê²°ê³¼',
            bodyPart: 'ë‹¤ë¦¬, ë°œ',
            relationM: 'ìë…€, í›„ë°°',
            relationF: 'ìë…€, í›„ë°°'
        }
    ];
    
    // ê° ê¶ìœ„ ë¶„ì„
    return gungwi.map((g, idx) => {
        if (!g.pillar) return {...g, analysis: 'ì‹œì£¼ ì—†ìŒ', god: null, state: null};
        
        const god = idx !== 2 ? getTenGod(g.pillar.s, dm) : null;
        const state = getTwelveState(dm, g.pillar.b);
        
        // í•´ë‹¹ ê¶ìœ„ì˜ ìƒíƒœ ë¶„ì„
        let analysis = '';
        let rating = 'neutral';
        
        // 12ìš´ì„±ìœ¼ë¡œ í•´ë‹¹ ê¶ìœ„ ì—ë„ˆì§€ íŒë‹¨
        const bi = BRANCH.indexOf(g.pillar.b);
        const isVoid = gmBranches.includes(bi); // ê³µë§ ì—¬ë¶€
        
        if (isVoid) {
            // ê³µë§ì¸ ê²½ìš° ì—ë„ˆì§€ ì„¤ëª… ë³€ê²½
            analysis = 'ê³µë§(ç©ºäº¡)ì´ë¼ ê¸°ìš´ì´ ë¹„ì–´ìˆì–´ìš”. í•´ë‹¹ ì‹œê¸°ì— ìŠ¤ìŠ¤ë¡œ ê°œì²™í•´ì•¼ í•´ìš”.';
            rating = 'neutral';
        } else if (state.l >= 9) {
            analysis = 'ì´ ì‹œê¸°ì— ì—ë„ˆì§€ê°€ ê°•í•´ìš”! í™œë°œí•˜ê²Œ ì›€ì§ì´ëŠ” ì‹œê¸°.';
            rating = 'good';
        } else if (state.l >= 6) {
            analysis = 'ì•ˆì •ì ì¸ ì—ë„ˆì§€ì˜ˆìš”. ìˆœíƒ„í•œ ì‹œê¸°.';
            rating = 'good';
        } else if (state.l >= 3) {
            analysis = 'ë³´í†µì˜ ì—ë„ˆì§€ì˜ˆìš”. ë…¸ë ¥ì´ í•„ìš”í•œ ì‹œê¸°.';
            rating = 'neutral';
        } else {
            analysis = 'ì—ë„ˆì§€ê°€ ì•½í•œ ì‹œê¸°. ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.';
            rating = 'bad';
        }
        
        // ì‹­ì‹ ìœ¼ë¡œ ì¶”ê°€ ë¶„ì„
        if (god) {
            if (['ì •ê´€','ì •ì¬','ì •ì¸'].includes(god.k)) {
                analysis += ` ${god.k}ì´ ìˆì–´ì„œ ì•ˆì •ì ì´ì—ìš”.`;
                rating = 'good';
            } else if (['í¸ê´€','ê²ì¬'].includes(god.k)) {
                analysis += ` ${god.k}ì´ ìˆì–´ì„œ ë³€í™”ì™€ ë„ì „ì´ ìˆì–´ìš”.`;
            }
        }
        
        // í˜„ì¬ ë‚˜ì´ë¡œ í•´ë‹¹ ê¶ìœ„ì¸ì§€ ì²´í¬
        let isCurrent = false;
        if (idx === 0 && curAge <= 15) isCurrent = true;
        else if (idx === 1 && curAge >= 16 && curAge <= 30) isCurrent = true;
        else if (idx === 2 && curAge >= 31 && curAge <= 45) isCurrent = true;
        else if (idx === 3 && curAge >= 46) isCurrent = true;
        
        return {
            ...g,
            god,
            state,
            analysis,
            rating,
            isCurrent
        };
    });
}

/* ========================================
   14-0-2. 12ìš´ì„± ì™„ì „ ë¶„ì„
   ======================================== */
function analyzeTwelveStates(saju) {
    const dm = saju.day.s;
    const result = {
        pillars: [],
        summary: '',
        dominant: null,
        lifeFlow: []
    };
    
    const pillarNames = ['ë…„ì£¼', 'ì›”ì£¼', 'ì¼ì£¼', 'ì‹œì£¼'];
    const pillars = [saju.year, saju.month, saju.day, saju.hour];
    
    // ê° ê¸°ë‘¥ë³„ 12ìš´ì„±
    pillars.forEach((p, idx) => {
        if (!p) return;
        const state = getTwelveState(dm, p.b);
        result.pillars.push({
            name: pillarNames[idx],
            branch: p.b,
            state: state,
            energy: state.l
        });
    });
    
    // ì¸ìƒ íë¦„ ë¶„ì„ (12ìš´ì„± ìˆœì„œëŒ€ë¡œ)
    const lifeStages = [
        {stage: 'ì¥ìƒ(é•·ç”Ÿ)', desc: 'ìƒˆë¡œìš´ ì‹œì‘, í¬ë§ê³¼ ê°€ëŠ¥ì„±', life: 'ìœ ì•„ê¸°'},
        {stage: 'ëª©ìš•(æ²æµ´)', desc: 'ë³€í™”ì™€ ë¶ˆì•ˆì •, ìƒˆë¡œìš´ í™˜ê²½', life: 'ì²­ì†Œë…„ê¸°'},
        {stage: 'ê´€ëŒ€(å† å¸¶)', desc: 'ì„±ì¥ê³¼ ë°œì „, ìë¦½', life: 'ì²­ë…„ê¸°'},
        {stage: 'ê±´ë¡(å»ºç¥¿)', desc: 'ì•ˆì •ê³¼ ë²ˆì˜, ì „ì„±ê¸°', life: 'ì¥ë…„ê¸°'},
        {stage: 'ì œì™•(å¸æ—º)', desc: 'ì •ì , ìµœê³ ì¡°, ê¶Œë ¥', life: 'ì¤‘ë…„ê¸°'},
        {stage: 'ì‡ (è¡°)', desc: 'í•˜ë½ì˜ ì‹œì‘, ì •ë¦¬', life: 'ì¤‘ë…„í›„ê¸°'},
        {stage: 'ë³‘(ç—…)', desc: 'ì•½í™”, ê±´ê°• ì£¼ì˜', life: 'ë…¸ë…„ì´ˆê¸°'},
        {stage: 'ì‚¬(æ­»)', desc: 'ë§ˆë¬´ë¦¬, ë', life: 'ë…¸ë…„ê¸°'},
        {stage: 'ë¬˜(å¢“)', desc: 'ì €ì¥, ì¶•ì , ì€í‡´', life: 'ë…¸ë…„í›„ê¸°'},
        {stage: 'ì ˆ(çµ¶)', desc: 'ê³µë°±, ë‹¨ì ˆ', life: 'ë§ë…„'},
        {stage: 'íƒœ(èƒ)', desc: 'ì‰íƒœ, ì¤€ë¹„', life: 'ìƒˆë¡œìš´ ì¤€ë¹„'},
        {stage: 'ì–‘(é¤Š)', desc: 'ì–‘ìœ¡, ë³´í˜¸', life: 'íšŒë³µê¸°'}
    ];
    
    // ì¼ì§€ 12ìš´ì„±ìœ¼ë¡œ ë³¸ì¸ ê¸°ë³¸ ì—ë„ˆì§€ íŒë‹¨
    const dayState = getTwelveState(dm, saju.day.b);
    if (dayState.l >= 10) {
        result.summary = 'ê¸°ë³¸ ì—ë„ˆì§€ê°€ ë§¤ìš° ê°•í•´ìš”! í™œë ¥ì´ ë„˜ì¹˜ê³  ì¶”ì§„ë ¥ ìˆì–´ìš”.';
        result.dominant = 'strong';
    } else if (dayState.l >= 7) {
        result.summary = 'ê¸°ë³¸ ì—ë„ˆì§€ê°€ ì¢‹ì•„ìš”. ì•ˆì •ì ì´ê³  ê¾¸ì¤€í•´ìš”.';
        result.dominant = 'good';
    } else if (dayState.l >= 4) {
        result.summary = 'ê¸°ë³¸ ì—ë„ˆì§€ê°€ ë³´í†µì´ì—ìš”. ë…¸ë ¥ìœ¼ë¡œ ë³´ì™„í•˜ì„¸ìš”.';
        result.dominant = 'neutral';
    } else {
        result.summary = 'ê¸°ë³¸ ì—ë„ˆì§€ê°€ ì•½í•´ìš”. ì²´ë ¥ ê´€ë¦¬ê°€ ì¤‘ìš”í•´ìš”.';
        result.dominant = 'weak';
    }
    
    // ì¸ìƒ íë¦„ (ë…„â†’ì›”â†’ì¼â†’ì‹œ)
    result.lifeFlow = result.pillars.map((p, idx) => {
        const ageRange = ['ì´ˆë…„(1-15)', 'ì²­ë…„(16-30)', 'ì¤‘ë…„(31-45)', 'ë§ë…„(46+)'][idx];
        return {
            period: ageRange,
            state: p.state.k,
            energy: p.energy,
            advice: p.energy >= 8 ? 'í™œë°œí•œ ì‹œê¸°!' : p.energy >= 5 ? 'ì•ˆì •ì ì¸ ì‹œê¸°' : p.energy >= 3 ? 'ì¸ë‚´ì˜ ì‹œê¸°' : 'íšŒë³µì˜ ì‹œê¸°'
        };
    });
    
    return result;
}

/* ========================================
   14-0-3. í•©ì¶© ê³ ê¸‰ ë¶„ì„ (í•©í™” ì„±ë¦½, ì¶© í•´ì†Œ)
   ======================================== */
function analyzeAdvancedInteractions(saju) {
    const result = {
        hapHwa: [],      // í•©í™”(åˆåŒ–) ë¶„ì„
        chungHaeso: [],  // ì¶© í•´ì†Œ ë¶„ì„
        samhapGuk: [],   // ì‚¼í•©êµ­ ë¶„ì„
        warnings: []
    };
    
    const mbi = BRANCH.indexOf(saju.month.b);
    const season = SEASON[mbi];
    const stems = [saju.year?.s, saju.month?.s, saju.day?.s, saju.hour?.s].filter(s => s);
    const stemIdxs = stems.map(s => STEM.indexOf(s));
    const brs = [BRANCH.indexOf(saju.year.b), BRANCH.indexOf(saju.month.b), BRANCH.indexOf(saju.day.b)];
    if (saju.hour) brs.push(BRANCH.indexOf(saju.hour.b));
    
    // ========== ì²œê°„ í•©í™”(åˆåŒ–) ì„±ë¦½ ì¡°ê±´ ì²´í¬ ==========
    const ganHap = [
        {pair: [0,5], result: 'earth', name: 'ê°‘ê¸°í•©í† (ç”²å·±åˆåœŸ)', condition: 'í† ì›”(è¾°æˆŒä¸‘æœªæœˆ) ë˜ëŠ” í† ê°€ ì™•ì„±í•  ë•Œ'},
        {pair: [1,6], result: 'metal', name: 'ì„ê²½í•©ê¸ˆ(ä¹™åºšåˆé‡‘)', condition: 'ê¸ˆì›”(ç”³é…‰æœˆ) ë˜ëŠ” ê¸ˆì´ ì™•ì„±í•  ë•Œ'},
        {pair: [2,7], result: 'water', name: 'ë³‘ì‹ í•©ìˆ˜(ä¸™è¾›åˆæ°´)', condition: 'ìˆ˜ì›”(äº¥å­æœˆ) ë˜ëŠ” ìˆ˜ê°€ ì™•ì„±í•  ë•Œ'},
        {pair: [3,8], result: 'wood', name: 'ì •ì„í•©ëª©(ä¸å£¬åˆæœ¨)', condition: 'ëª©ì›”(å¯…å¯æœˆ) ë˜ëŠ” ëª©ì´ ì™•ì„±í•  ë•Œ'},
        {pair: [4,9], result: 'fire', name: 'ë¬´ê³„í•©í™”(æˆŠç™¸åˆç«)', condition: 'í™”ì›”(å·³åˆæœˆ) ë˜ëŠ” í™”ê°€ ì™•ì„±í•  ë•Œ'}
    ];
    
    for (let gh of ganHap) {
        if (stemIdxs.includes(gh.pair[0]) && stemIdxs.includes(gh.pair[1])) {
            // í•©ì´ ì¡´ì¬
            const resultEl = gh.result;
            let isHwa = false;
            let reason = '';
            
            // ì›”ë ¹ì´ í•´ë‹¹ ì˜¤í–‰ì¸ì§€ ì²´í¬
            const seasonEl = {spring:'wood', summer:'fire', autumn:'metal', winter:'water'};
            if (seasonEl[season] === resultEl) {
                isHwa = true;
                reason = `ì›”ë ¹ì´ ${ELEMENT[resultEl].k}ì´ë¼ í•©í™” ì„±ë¦½!`;
            }
            // ì§€ì§€ì— í•´ë‹¹ ì˜¤í–‰ì´ ë§ì€ì§€ ì²´í¬
            const resultElCount = brs.filter(b => BRANCH[b].e === resultEl).length;
            if (resultElCount >= 2) {
                isHwa = true;
                reason = `ì§€ì§€ì— ${ELEMENT[resultEl].k}ì´ ${resultElCount}ê°œë¼ í•©í™” ì„±ë¦½!`;
            }
            
            result.hapHwa.push({
                name: gh.name,
                stems: `${STEM[gh.pair[0]].c}+${STEM[gh.pair[1]].c}`,
                result: isHwa ? ELEMENT[resultEl].k : null,
                isHwa,
                reason: isHwa ? reason : 'í•©ì€ ìˆìœ¼ë‚˜ í™”(åŒ–)ë˜ì§€ ì•ŠìŒ - í•©ê±°(åˆå») ìƒíƒœ'
            });
        }
    }
    
    // ========== ì§€ì§€ ì‚¼í•©êµ­(ä¸‰åˆå±€) ì™„ì „ ì„±ë¦½ ì—¬ë¶€ ==========
    const samhap = [
        {branches: [2,6,10], result: 'fire', name: 'ì¸ì˜¤ìˆ  í™”êµ­(å¯…åˆæˆŒ ç«å±€)'},
        {branches: [5,9,1], result: 'metal', name: 'ì‚¬ìœ ì¶• ê¸ˆêµ­(å·³é…‰ä¸‘ é‡‘å±€)'},
        {branches: [8,0,4], result: 'water', name: 'ì‹ ìì§„ ìˆ˜êµ­(ç”³å­è¾° æ°´å±€)'},
        {branches: [11,3,7], result: 'wood', name: 'í•´ë¬˜ë¯¸ ëª©êµ­(äº¥å¯æœª æœ¨å±€)'}
    ];
    
    for (let sh of samhap) {
        const hasCount = sh.branches.filter(b => brs.includes(b)).length;
        if (hasCount >= 2) {
            const hasCenter = brs.includes(sh.branches[1]); // ì¤‘ì‹¬ ì§€ì§€ (ì˜¤í–‰ì˜ ì™•ì§€)
            result.samhapGuk.push({
                name: sh.name,
                complete: hasCount === 3,
                hasCenter,
                result: ELEMENT[sh.result].k,
                desc: hasCount === 3 ? 
                    `ì™„ì „í•œ ${sh.name} ì„±ë¦½! ${ELEMENT[sh.result].k} ê¸°ìš´ì´ ê°•í•´ìš”.` :
                    hasCenter ? 
                    `${sh.name} ë°˜í•©(åŠåˆ). ì™•ì§€(${BRANCH[sh.branches[1]].c})ê°€ ìˆì–´ì„œ í˜ì´ ìˆì–´ìš”.` :
                    `${sh.name} ë°˜í•©ì´ì§€ë§Œ ì™•ì§€ê°€ ì—†ì–´ì„œ í˜ì´ ì•½í•´ìš”.`
            });
        }
    }
    
    // ========== ì¶©(æ²–) í•´ì†Œ ì¡°ê±´ ì²´í¬ ==========
    const clashPairs = [[0,6],[1,7],[2,8],[3,9],[4,10],[5,11]];
    for (let [a,b] of clashPairs) {
        if (brs.includes(a) && brs.includes(b)) {
            // ì¶©ì´ ì¡´ì¬
            let isResolved = false;
            let resolveReason = '';
            
            // í•©ìœ¼ë¡œ í•´ì†Œë˜ëŠ”ì§€ ì²´í¬ (ìœ¡í•©)
            const hapPairs = [[0,1],[2,11],[3,10],[4,9],[5,8],[6,7]];
            for (let [ha, hb] of hapPairs) {
                if ((brs.includes(a) && (brs.includes(ha) && a === hb) || (brs.includes(hb) && a === ha)) ||
                    (brs.includes(b) && (brs.includes(ha) && b === hb) || (brs.includes(hb) && b === ha))) {
                    // ì¶© ë‹¹ì‚¬ì ì¤‘ í•˜ë‚˜ê°€ í•©ì„ ë§Œë‚˜ë©´ ì¶©ì´ ì•½í•´ì§
                    isResolved = true;
                    resolveReason = 'í•©(åˆ)ì´ ìˆì–´ì„œ ì¶©ì´ ì™„í™”ë¨';
                }
            }
            
            result.chungHaeso.push({
                clash: `${BRANCH[a].c}${BRANCH[b].c} ì¶©`,
                isResolved,
                reason: isResolved ? resolveReason : 'ì¶©ì´ í•´ì†Œë˜ì§€ ì•ŠìŒ - ì£¼ì˜ í•„ìš”'
            });
        }
    }
    
    // ========== ê²½ê³  ì‚¬í•­ ==========
    // ìƒê´€ê²¬ê´€ ì²´í¬
    const dm = saju.day.s;
    const godCounts = {};
    stems.forEach((s, idx) => {
        if (idx === 2) return; // ì¼ê°„ ì œì™¸
        const god = getTenGod(s, dm);
        godCounts[god.k] = (godCounts[god.k] || 0) + 1;
    });
    
    if (godCounts['ìƒê´€'] && godCounts['ì •ê´€']) {
        result.warnings.push({
            type: 'ìƒê´€ê²¬ê´€(å‚·å®˜è¦‹å®˜)',
            desc: 'ìƒê´€ì´ ì •ê´€ì„ ê·¹í•©ë‹ˆë‹¤. ì§ì¥, ëª…ì˜ˆì— ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”. ê´€ì§ë³´ë‹¤ ì‚¬ì—…ì´ ì¢‹ì•„ìš”.'
        });
    }
    
    if (godCounts['í¸ì¸'] && godCounts['ì‹ì‹ ']) {
        result.warnings.push({
            type: 'íš¨ì‹ íƒˆì‹(æ¢Ÿç¥å¥ªé£Ÿ)',
            desc: 'í¸ì¸ì´ ì‹ì‹ ì„ ê·¹í•©ë‹ˆë‹¤. ì¬ëŠ¥ ë°œíœ˜ê°€ ë§‰í ìˆ˜ ìˆì–´ìš”. ìš°ìš¸ì¦ ì£¼ì˜!'
        });
    }
    
    return result;
}

/* ========================================
   14-1. ì§€ì¥ê°„(åœ°è—å¹²) ë¶„ì„
   ======================================== */
// íŠ¹ì • ì§€ì§€ì˜ ì§€ì¥ê°„ ì •ë³´ ë°˜í™˜
function getJijanggan(branch) {
    const bi = BRANCH.indexOf(branch);
    return JIJANGGAN[bi] || [];
}

// ì§€ì¥ê°„ì—ì„œ íŠ¹ì • ì²œê°„ì´ ìˆëŠ”ì§€ í™•ì¸ (íˆ¬ì¶œ ì—¬ë¶€)
function hasHiddenStem(branch, stemIdx) {
    const jj = getJijanggan(branch);
    return jj.some(j => j.stem === stemIdx);
}

// ì¼ê°„ì´ ì§€ì§€ì— í†µê·¼(é€šæ ¹)í•˜ëŠ”ì§€ ë¶„ì„
// í†µê·¼: ì¼ê°„ê³¼ ê°™ì€ ì˜¤í–‰ì´ ì§€ì¥ê°„ì— ìˆëŠ” ê²½ìš°
function analyzeRoot(dayStem, branch) {
    const jj = getJijanggan(branch);
    const dsEl = dayStem.e;
    const roots = [];
    
    jj.forEach(j => {
        const hiddenStem = STEM[j.stem];
        if (hiddenStem.e === dsEl) {
            // í†µê·¼ ë°œê²¬
            const strength = j.days >= 16 ? 'strong' : j.days >= 7 ? 'medium' : 'weak';
            roots.push({
                stem: hiddenStem,
                days: j.days,
                type: j.type,
                strength,
                name: j.name
            });
        }
    });
    return roots;
}

// ì²œê°„ì´ ì§€ì§€ì— íˆ¬ê°„(é€å¹²)í–ˆëŠ”ì§€ ë¶„ì„
// íˆ¬ê°„: ì²œê°„ ê¸€ìê°€ ì§€ì¥ê°„ì—ë„ ì¡´ì¬í•˜ëŠ” ê²½ìš°
function analyzeTougan(saju) {
    const result = [];
    const allStems = [
        {pillar: 'ë…„ê°„', stem: saju.year.s},
        {pillar: 'ì›”ê°„', stem: saju.month.s},
        {pillar: 'ì¼ê°„', stem: saju.day.s},
    ];
    if (saju.hour) allStems.push({pillar: 'ì‹œê°„', stem: saju.hour.s});
    
    const allBranches = [
        {pillar: 'ë…„ì§€', branch: saju.year.b},
        {pillar: 'ì›”ì§€', branch: saju.month.b},
        {pillar: 'ì¼ì§€', branch: saju.day.b},
    ];
    if (saju.hour) allBranches.push({pillar: 'ì‹œì§€', branch: saju.hour.b});
    
    allStems.forEach(st => {
        const si = STEM.indexOf(st.stem);
        allBranches.forEach(br => {
            const jj = getJijanggan(br.branch);
            jj.forEach(j => {
                if (j.stem === si) {
                    result.push({
                        stem: st.stem,
                        stemPillar: st.pillar,
                        branch: br.branch,
                        branchPillar: br.pillar,
                        days: j.days,
                        type: j.type,
                        desc: `${st.stem.c}(${st.pillar})ì´ ${br.branch.c}(${br.pillar})ì— ë¿Œë¦¬ë‚´ë¦¼`
                    });
                }
            });
        });
    });
    return result;
}

// ì‚¬ì£¼ ì „ì²´ í†µê·¼ ë¶„ì„
function analyzeAllRoots(saju) {
    const dm = saju.day.s;
    const branches = [
        {name: 'ë…„ì§€', branch: saju.year.b},
        {name: 'ì›”ì§€', branch: saju.month.b},
        {name: 'ì¼ì§€', branch: saju.day.b}
    ];
    if (saju.hour) branches.push({name: 'ì‹œì§€', branch: saju.hour.b});
    
    const allRoots = [];
    let totalScore = 0;
    
    branches.forEach(b => {
        const roots = analyzeRoot(dm, b.branch);
        roots.forEach(r => {
            let score = 0;
            if (r.strength === 'strong') score = 3;
            else if (r.strength === 'medium') score = 2;
            else score = 1;
            
            // ì›”ì§€ í†µê·¼ì€ 2ë°°
            if (b.name === 'ì›”ì§€') score *= 2;
            // ì¼ì§€ í†µê·¼ë„ 1.5ë°°
            if (b.name === 'ì¼ì§€') score *= 1.5;
            
            totalScore += score;
            allRoots.push({
                ...r,
                position: b.name,
                branch: b.branch,
                score
            });
        });
    });
    
    return { roots: allRoots, totalScore };
}

// ì˜¤í–‰ ê°œìˆ˜ ê³„ì‚° (ì§€ì¥ê°„ í¬í•¨ ê³ ê¸‰ ë²„ì „)
function countElementsAdvanced(saju) {
    const ec = {wood:0, fire:0, earth:0, metal:0, water:0};
    const details = {wood:[], fire:[], earth:[], metal:[], water:[]};
    
    // ì²œê°„ (100% ë°˜ì˜)
    const stems = [
        {pos:'ë…„ê°„', s:saju.year.s},
        {pos:'ì›”ê°„', s:saju.month.s},
        {pos:'ì¼ê°„', s:saju.day.s}
    ];
    if (saju.hour) stems.push({pos:'ì‹œê°„', s:saju.hour.s});
    
    stems.forEach(st => {
        ec[st.s.e] += 1;
        details[st.s.e].push(`${st.s.c}(${st.pos}) 1.0`);
    });
    
    // ì§€ì§€ ë³¸ê¸° (100% ë°˜ì˜)
    const branches = [
        {pos:'ë…„ì§€', b:saju.year.b},
        {pos:'ì›”ì§€', b:saju.month.b},
        {pos:'ì¼ì§€', b:saju.day.b}
    ];
    if (saju.hour) branches.push({pos:'ì‹œì§€', b:saju.hour.b});
    
    branches.forEach(br => {
        ec[br.b.e] += 1;
        details[br.b.e].push(`${br.b.c}(${br.pos}) 1.0`);
    });
    
    // ì§€ì¥ê°„ (ë¹„ìœ¨ ë°˜ì˜)
    branches.forEach(br => {
        const bi = BRANCH.indexOf(br.b);
        const jj = JIJANGGAN[bi] || [];
        jj.forEach(j => {
            const hiddenStem = STEM[j.stem];
            const ratio = j.days / 30; // ì¼ìˆ˜ì— ë”°ë¥¸ ë¹„ìœ¨
            ec[hiddenStem.e] += ratio * 0.5; // ì§€ì¥ê°„ì€ 50% ê°€ì¤‘ì¹˜
            details[hiddenStem.e].push(`${hiddenStem.c}(${br.pos}è—) ${(ratio*0.5).toFixed(2)}`);
        });
    });
    
    return { counts: ec, details };
}

/* ========================================
   14-1-2. ì˜¤í–‰ ê°œìˆ˜ ê³„ì‚° (ë‹¨ìˆœ)
   ======================================== */
function countElements(saju) {
    const ec = {wood:0, fire:0, earth:0, metal:0, water:0};
    [saju.year, saju.month, saju.day, saju.hour].forEach(p => {
        if (!p) return;
        ec[p.s.e]++;
        ec[p.b.e]++;
    });
    return ec;
}

/* ========================================
   14-2. ìƒì„¸ í†µë³€ - ì˜¤ëŠ˜ì˜ ìš´ì„¸
   ======================================== */
function genTodayFortune(saju, gods) {
    const now = new Date();
    const ty = now.getFullYear(), tm = now.getMonth() + 1, td = now.getDate();
    const dp = calcDayPillar(ty, tm, td);
    const dm = saju.day.s;
    const god = getTenGod(dp.s, dm);
    const state = getTwelveState(dm, dp.b);
    
    const godMeaning = {
        'ë¹„ê²¬': {r:3, l:'ğŸ¥Š ê²½ìŸì˜ ë‚ ', d:'ì˜¤ëŠ˜ì€ ë‚˜ì™€ ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ì´ ë§ì´ ë³´ì´ëŠ” ë‚ . ê²½ìŸìê°€ ë‚˜íƒ€ë‚˜ê±°ë‚˜ ë‚´ ì˜ê²¬ì„ ê°•í•˜ê²Œ ì£¼ì¥í•˜ê²Œ ë  ìˆ˜ ìˆì–´ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> í˜¼ì í•  ìˆ˜ ìˆëŠ” ì¼ì— ì§‘ì¤‘í•˜ì„¸ìš”.'},
        'ê²ì¬': {r:2, l:'ğŸ’¸ ì§€ì¶œ ì£¼ì˜ë³´', d:'ì˜¤ëŠ˜ì€ ëˆì´ ë¹ ì ¸ë‚˜ê°€ê¸° ì‰¬ìš´ ë‚ ! ì¶©ë™êµ¬ë§¤, ì¹œêµ¬í•œí…Œ ëˆ ë¹Œë ¤ì£¼ê¸° í”¼í•˜ì„¸ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> "ë‚´ì¼ ë‹¤ì‹œ ìƒê°í•´ë³¼ê²Œ"ê°€ ì˜¤ëŠ˜ì˜ ë§ˆë²• ì£¼ë¬¸!'},
        'ì‹ì‹ ': {r:4, l:'ğŸ½ï¸ ë§›ìˆëŠ” í•˜ë£¨', d:'ë­˜ í•´ë„ ì—¬ìœ ë¡­ê³  ê¸°ë¶„ ì¢‹ì€ ë‚ ! ë§›ìˆëŠ” ê±° ë¨¹ê³  ì·¨ë¯¸ í™œë™ë„ ì¢‹ì•„ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> ì¢‹ì•„í•˜ëŠ” ìŒì‹ ë¨¹ìœ¼ë©´ì„œ ì˜ê°ì„ ì–»ì–´ë³´ì„¸ìš”.'},
        'ìƒê´€': {r:3, l:'ğŸ¤ í‘œí˜„ë ¥ UP', d:'ë§ì´ ìˆ ìˆ  ë‚˜ì˜¤ëŠ” ë‚ ! í”„ë ˆì  í…Œì´ì…˜ì´ë‚˜ ë°œí‘œê°€ ìˆë‹¤ë©´ ì˜ ë  ê±°ì˜ˆìš”. ë‹¤ë§Œ ìœ—ì‚¬ëŒí•œí…Œ ëŒ€ë“¤ê³  ì‹¶ì–´ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜!<br><br><strong>ğŸ’¡ íŒ:</strong> ë§í•˜ê¸° ì „ì— 3ì´ˆë§Œ ìƒê°í•˜ì„¸ìš”.'},
        'í¸ì¬': {r:4, l:'ğŸ’° ëœ»ë°–ì˜ í–‰ìš´', d:'ì˜ˆìƒ ëª» í•œ ëˆì´ ë“¤ì–´ì˜¤ê±°ë‚˜ ì¢‹ì€ ê¸°íšŒê°€ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”!<br><br><strong>ğŸ’¡ íŒ:</strong> ì ê·¹ì ìœ¼ë¡œ ì›€ì§ì´ì„¸ìš”. ì§‘ì— ìˆìœ¼ë©´ ê¸°íšŒê°€ ì•ˆ ì™€ìš”!'},
        'ì •ì¬': {r:4, l:'ğŸ’µ ì•ˆì •ì ì¸ ë‚ ', d:'ëˆ ê´€ë ¨ ì¼ì´ ìˆœì¡°ë¡œì›Œìš”. ê³„ì•½ì´ë‚˜ ê±°ë˜ë„ ì¢‹ì•„ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> ì €ì¶• ì‹œì‘í•˜ê¸° ì¢‹ì€ ë‚ ì´ì—ìš”.'},
        'í¸ê´€': {r:2, l:'ğŸ˜° ê¸´ì¥ë˜ëŠ” ë‚ ', d:'ê°‘ìê¸° ì¼ì´ ìƒê¸°ê±°ë‚˜ ì••ë°•ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”. ì˜ˆìƒ ëª» í•œ ì—…ë¬´ê°€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆì–´ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> ì»¨ë””ì…˜ ê´€ë¦¬ê°€ ì¤‘ìš”í•´ìš”. ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.'},
        'ì •ê´€': {r:5, l:'ğŸ† ì¸ì •ë°›ëŠ” ë‚ ', d:'ìµœê³ ì˜ ë‚ ! ë…¸ë ¥í•œ ê²Œ ì¸ì •ë°›ê±°ë‚˜ ì¹­ì°¬ì„ ë“¤ì„ ìˆ˜ ìˆì–´ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> ì¤‘ìš”í•œ ë¯¸íŒ…ì´ë‚˜ ì•½ì†ì€ ì˜¤ëŠ˜ ì¡ìœ¼ì„¸ìš”.'},
        'í¸ì¸': {r:3, l:'ğŸ“š í˜¼ìë§Œì˜ ì‹œê°„', d:'ì‚¬ëŒ ë§ì€ ê³³ë³´ë‹¤ í˜¼ì ìˆê³  ì‹¶ì€ ë‚ . ê³µë¶€ë‚˜ ë…ì„œì— ë”±!<br><br><strong>ğŸ’¡ íŒ:</strong> ì¹´í˜ì—ì„œ í˜¼ì ì±… ì½ê¸° ì–´ë•Œìš”?'},
        'ì •ì¸': {r:4, l:'ğŸ¤ ë„ì›€ë°›ëŠ” ë‚ ', d:'ëˆ„êµ°ê°€ì˜ ë„ì›€ì„ ë°›ê¸° ì¢‹ì€ ë‚ ! ëª¨ë¥´ëŠ” ê±° ìˆìœ¼ë©´ ë¬¼ì–´ë³´ì„¸ìš”.<br><br><strong>ğŸ’¡ íŒ:</strong> ê³„ì•½ì„œ, ì„œë¥˜ ì‘ì—…í•˜ê¸° ì¢‹ì•„ìš”.'}
    };
    
    const info = godMeaning[god.k] || {r:3, l:'â˜€ï¸ í‰ì˜¨í•œ ë‚ ', d:'íŠ¹ë³„í•œ ì¼ ì—†ì´ ë¬´ë‚œí•œ í•˜ë£¨ì˜ˆìš”.'};
    let bonus = '';
    if ([dp.s.e, dp.b.e].includes(gods.yong)) {
        info.r = Math.min(5, info.r + 1);
        bonus = '<div class="info-box good" style="margin-top:12px;"><p>âœ¨ <strong>ì˜¤ëŠ˜ í–‰ìš´ì˜ ê¸°ìš´ì´ ë“¤ì–´ì™€ìš”!</strong> í‰ì†Œë³´ë‹¤ ì¼ì´ ì˜ í’€ë¦´ ê±°ì˜ˆìš”!</p></div>';
    } else if ([dp.s.e, dp.b.e].includes(gods.gi)) {
        info.r = Math.max(1, info.r - 1);
        bonus = '<div class="info-box warn" style="margin-top:12px;"><p>âš ï¸ <strong>ì˜¤ëŠ˜ì€ ì¡°ì‹¬í•˜ëŠ” ê²Œ ì¢‹ì•„ìš”!</strong> í° ê²°ì •ì€ ë‚´ì¼ë¡œ ë¯¸ë£¨ì„¸ìš”.</p></div>';
    }
    
    // ì¢‹ì€ ì‹œê°„/ë‚˜ìœ ì‹œê°„
    const goodH = [], badH = [];
    const hourNames = ['ë°¤ 11ì‹œ~ìƒˆë²½ 1ì‹œ','ìƒˆë²½ 1~3ì‹œ','ìƒˆë²½ 3~5ì‹œ','ì•„ì¹¨ 5~7ì‹œ','ì•„ì¹¨ 7~9ì‹œ','ì˜¤ì „ 9~11ì‹œ','ë‚® 11ì‹œ~ì˜¤í›„ 1ì‹œ','ì˜¤í›„ 1~3ì‹œ','ì˜¤í›„ 3~5ì‹œ','ì €ë… 5~7ì‹œ','ì €ë… 7~9ì‹œ','ë°¤ 9~11ì‹œ'];
    for (let i = 0; i < 12; i++) {
        const hEl = BRANCH[i].e;
        if (hEl === gods.yong) goodH.push(hourNames[i]);
        else if (hEl === gods.gi) badH.push(hourNames[i]);
    }
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ“… ${tm}ì›” ${td}ì¼ ì˜¤ëŠ˜ì˜ ìš´ì„¸</strong></p>
            <p style="font-size:0.85rem;color:var(--gray);margin-top:5px;">ì˜¤ëŠ˜ì˜ ê¸°ìš´: ${dp.s.c}${dp.b.c} (${dp.b.m} ${dp.b.a}ì¼)</p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(info.r)}${'â˜†'.repeat(5-info.r)}</span>
        </div>
        <div class="info-box">
            <p><strong>${info.l}</strong></p>
            <p style="margin-top:10px;line-height:1.8;">${info.d}</p>
        </div>
        ${bonus}
        <div class="info-box good" style="margin-top:12px;">
            <p><strong>â° í–‰ìš´ì˜ ì‹œê°„</strong><br>${goodH.length ? goodH.join(', ') : 'íŠ¹ë³„íˆ ì—†ì–´ìš”'}</p>
        </div>
        <div class="info-box warn" style="margin-top:12px;">
            <p><strong>â° ì¡°ì‹¬í•  ì‹œê°„</strong><br>${badH.length ? badH.join(', ') : 'íŠ¹ë³„íˆ ì—†ì–´ìš”'}</p>
        </div>
        <div class="info-box" style="margin-top:12px;">
            <p><strong>ğŸ“Œ ì˜¤ëŠ˜ì˜ ì—ë„ˆì§€: ${state.k}</strong><br>${state.d}</p>
        </div>`;
}

/* ========================================
   14-3. ìƒì„¸ í†µë³€ - ì—°ìš´
   ======================================== */
function genYearFortune(saju, gods, year) {
    const yp = calcYearPillar(year, 2, 5);
    const dm = saju.day.s;
    const god = getTenGod(yp.s, dm);
    const state = getTwelveState(dm, yp.b);
    
    let rating = 3, desc = '';
    if ([yp.s.e, yp.b.e].includes(gods.yong)) { rating = 5; desc = 'ìš©ì‹ ì´ ë“¤ì–´ì˜¤ëŠ” ëŒ€ê¸¸í•œ í•´! ì ê·¹ì ìœ¼ë¡œ ì›€ì§ì´ì„¸ìš”!'; }
    else if ([yp.s.e, yp.b.e].includes(gods.hee)) { rating = 4; desc = 'í¬ì‹ ì´ ë„ì™€ì£¼ëŠ” ì¢‹ì€ í•´! ìˆœíƒ„í•˜ê²Œ í’€ë ¤ìš”.'; }
    else if ([yp.s.e, yp.b.e].includes(gods.gi)) { rating = 2; desc = 'ê¸°ì‹ ì´ ë“¤ì–´ì˜¤ëŠ” ì¡°ì‹¬í•´ì•¼ í•  í•´. ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.'; }
    else { desc = 'í‰íƒ„í•œ í•´ì˜ˆìš”. ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ì„¸ìš”.'; }
    
    if (state.l >= 9) { rating = Math.min(5, rating + 1); desc += ' 12ìš´ì„±ì´ ê°•í•´ì„œ ì—ë„ˆì§€ê°€ ë„˜ì³ìš”!'; }
    else if (state.l <= 3) { rating = Math.max(1, rating - 1); desc += ' 12ìš´ì„±ì´ ì•½í•´ì„œ ì²´ë ¥ ê´€ë¦¬ê°€ í•„ìš”í•´ìš”.'; }
    
    // ì›”ë³„ í¬ì¸íŠ¸
    const months = [];
    for (let m = 1; m <= 12; m++) {
        const mp = calcMonthPillar(year, m, 15);
        const mGod = getTenGod(mp.s, dm);
        let tip = '';
        if (['ì •ê´€','ì •ì¬'].includes(mGod.k)) tip = 'ğŸŸ¢ ì¢‹ìŒ';
        else if (['í¸ê´€','ê²ì¬'].includes(mGod.k)) tip = 'ğŸ”´ ì£¼ì˜';
        else tip = 'ğŸŸ¡ ë³´í†µ';
        months.push(`<span style="display:inline-block;margin:3px;padding:5px 8px;background:rgba(255,255,255,0.05);border-radius:5px;font-size:0.75rem;">${m}ì›” ${tip}</span>`);
    }
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ“† ${year}ë…„ ìš´ì„¸</strong></p>
            <p style="font-size:0.85rem;color:var(--gray);margin-top:5px;">${yp.s.c}${yp.b.c}ë…„ (${yp.b.m} ${yp.b.a}ì˜ í•´)</p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(rating)}${'â˜†'.repeat(5-rating)}</span>
        </div>
        <div class="info-box">
            <p><strong>ì˜¬í•´ì˜ ì‹­ì‹ : ${god.k}</strong></p>
            <p style="margin-top:10px;line-height:1.8;">${desc}</p>
        </div>
        <div class="info-box" style="margin-top:12px;">
            <p><strong>ğŸ“Œ ì˜¬í•´ì˜ ì—ë„ˆì§€: ${state.k}</strong><br>${state.d}</p>
        </div>
        <div class="info-box" style="margin-top:12px;">
            <p><strong>ğŸ—“ï¸ ì›”ë³„ í¬ì¸íŠ¸</strong></p>
            <div style="margin-top:10px;">${months.join('')}</div>
        </div>`;
}

/* ========================================
   14-4. ìƒì„¸ í†µë³€ - ì§ì—…ìš´
   ======================================== */
function genCareerFortune(saju, str, gods) {
    const dm = saju.day.s;
    const ec = countElements(saju);
    const jaeEl = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 2) % 5];
    const gwanEl = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 3) % 5];
    const sikEl = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 1) % 5];
    
    let rating = 3, style = '', advice = '';
    
    if (str.type === 'strong' && ec[jaeEl] >= 2) {
        rating = 5; style = 'ì‚¬ì¥ë‹˜ ìŠ¤íƒ€ì¼';
        advice = 'ì‹ ê°•í•˜ê³  ì¬ì„±ì´ ë§ì•„ì„œ ì‚¬ì—…ê°€ ìì§ˆì´ ìˆì–´ìš”! ëˆì„ ë‹¤ë£¨ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ê³  ì§ì ‘ ì‚¬ì—…ì„ í•˜ë©´ í¬ê²Œ ì„±ê³µí•  ìˆ˜ ìˆì–´ìš”.';
    } else if (str.type === 'strong' && ec[gwanEl] >= 2) {
        rating = 4; style = 'ë†’ì€ ìë¦¬ ê°ˆ ìƒ';
        advice = 'ì‹ ê°•í•˜ê³  ê´€ì„±ì´ ë§ì•„ì„œ ì¡°ì§ì—ì„œ ì¶œì„¸í•´ìš”! ê³µë¬´ì›, ëŒ€ê¸°ì—…, ì •ì¹˜ ìª½ì—ì„œ ë†’ì€ ìë¦¬ê¹Œì§€ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆì–´ìš”.';
    } else if (str.type === 'weak') {
        rating = 3; style = 'ì „ë¬¸ê°€ ìŠ¤íƒ€ì¼';
        advice = 'ì‹ ì•½í•´ì„œ í˜¼ìë³´ë‹¤ëŠ” íŒ€ì—ì„œ ì¼í•˜ëŠ” ê²Œ ì¢‹ì•„ìš”. ì „ë¬¸ ë¶„ì•¼ë¥¼ ê¹Šì´ íŒŒë©´ ì¸ì •ë°›ëŠ” ì „ë¬¸ê°€ê°€ ë  ìˆ˜ ìˆì–´ìš”.';
    } else {
        rating = 4; style = 'ë­ë“  ì˜í•˜ëŠ” ìŠ¤íƒ€ì¼';
        advice = 'ì¤‘í™”ë˜ì–´ ê· í˜• ì¡í˜”ì–´ìš”! ì–´ë–¤ ë¶„ì•¼ì—ì„œë“  ì˜ ì ì‘í•˜ê³  ì„±ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆì–´ìš”.';
    }
    
    // ì‹ì‹  ì²´í¬
    if (ec[sikEl] >= 2) {
        advice += '<br><br>âœ¨ <strong>ì‹ì‹ ì´ ë§ì•„ì„œ ì¬ëŠ¥ìœ¼ë¡œ ëˆ ë²„ëŠ” êµ¬ì¡°ì˜ˆìš”!</strong> ì˜ˆìˆ , ê¸°ìˆ , ì°½ì‘ ë¶„ì•¼ì—ì„œ ë¹›ì„ ë°œí•´ìš”.';
    }
    
    const careerByElement = {
        wood: 'êµìœ¡, ì¶œíŒ, ì˜ë¥˜, ê°€êµ¬, ì¡°ê²½, ë†ì—…, í•œì˜í•™',
        fire: 'ì—°ì˜ˆ, ë°©ì†¡, ì˜ˆìˆ , IT, ì „ê¸°, ì¡°ëª…, ìŒì‹',
        earth: 'ë¶€ë™ì‚°, ê±´ì¶•, ë†ì—…, ì¤‘ê°œ, ìœ í†µ, ì°½ê³ ì—…',
        metal: 'ê¸ˆìœµ, ì œì¡°, ìë™ì°¨, ê¸°ê³„, ì˜ë£Œê¸°ê¸°, ë²•ì¡°',
        water: 'ë¬´ì—­, ìœ í†µ, ê´€ê´‘, ì–´ì—…, ìŒë£Œ, ë¬¼ë¥˜, ì²­ì†Œ'
    };
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ’¼ ì§ì—…ìš´ ë¶„ì„</strong></p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(rating)}${'â˜†'.repeat(5-rating)}</span>
            <p style="margin-top:10px;font-size:1.1rem;color:var(--gold);">${style}</p>
        </div>
        <div class="info-box">
            <p style="line-height:1.8;">${advice}</p>
        </div>
        <div class="info-box good" style="margin-top:12px;">
            <p><strong>ğŸ¯ ìš©ì‹ (${ELEMENT[gods.yong].k}) ê´€ë ¨ ì§ì—…</strong></p>
            <p style="margin-top:8px;">${careerByElement[gods.yong]}</p>
        </div>`;
}

/* ========================================
   14-5. ìƒì„¸ í†µë³€ - ì—°ì• ìš´
   ======================================== */
function genLoveFortune(saju, str, gods) {
    const dm = saju.day.s;
    const dbi = BRANCH.indexOf(saju.day.b);
    const ec = countElements(saju);
    
    // ë°°ìš°ì ì˜¤í–‰ (ë‚¨ìëŠ” ì¬ì„±, ì—¬ìëŠ” ê´€ì„±)
    const spouseEl = GENDER === 'm' ? 
        EL_ORDER[(EL_ORDER.indexOf(dm.e) + 2) % 5] : 
        EL_ORDER[(EL_ORDER.indexOf(dm.e) + 3) % 5];
    const spouseCount = ec[spouseEl];
    
    let rating = 3, desc = '';
    
    // ë°°ìš°ì ì˜¤í–‰ ê°œìˆ˜ë³„ í•´ì„
    if (spouseCount === 0) {
        rating = 2;
        desc = 'ë°°ìš°ì ìë¦¬ì— ê¸°ìš´ì´ ì•½í•´ìš”. ì¸ì—°ì´ ëŠ¦ê±°ë‚˜, ë§Œë‚˜ë„ ì˜¤ë˜ ëª» ê°€ëŠ” ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. ë„ˆë¬´ ì¡°ê¸‰í•´í•˜ì§€ ë§ˆì„¸ìš”!';
    } else if (spouseCount === 1) {
        rating = 4;
        desc = 'ë°°ìš°ì ì¸ì—°ì´ ë”± í•˜ë‚˜! ê·¸ ì‚¬ëŒì´ ì§„ì§œ ì¸ì—°ì´ì—ìš”. ì†Œì¤‘íˆ ëŒ€í•˜ì„¸ìš”.';
    } else if (spouseCount === 2) {
        rating = 3;
        desc = 'ë°°ìš°ì ì¸ì—°ì´ ë‘ ê°œ... ì¬í˜¼ìˆ˜ê°€ ìˆê±°ë‚˜, ë‘ ì‚¬ëŒ ì‚¬ì´ì—ì„œ ê³ ë¯¼í•  ìˆ˜ ìˆì–´ìš”.';
    } else {
        rating = 2;
        desc = 'ë°°ìš°ì ì¸ì—°ì´ ë§ì•„ìš”. ë°”ëŒê¸° ì¡°ì‹¬! í•œ ì‚¬ëŒì—ê²Œ ì§‘ì¤‘í•˜ì„¸ìš”.';
    }
    
    // ì¼ì§€ë¡œ ë³´ëŠ” ë°°ìš°ììƒ
    const spouseByBranch = {
        0: 'ë°°ìš°ìê°€ ë˜‘ë˜‘í•˜ê³  ëˆˆì¹˜ê°€ ë¹¨ë¼ìš”. ê³µë¶€ë„ ì˜í•˜ê³  ìƒê°ì´ ê¹Šì–´ìš”. ë‹¤ë§Œ ê±±ì •ì´ ë§ì„ ìˆ˜ ìˆì–´ìš”.',
        1: 'ë°°ìš°ìê°€ ì°©ì‹¤í•˜ê³  ì„±ì‹¤í•´ìš”. ì²œì²œíˆ ê¾¸ì¤€íˆ í•˜ëŠ” íƒ€ì…ì´ì—ìš”. ë¯¿ìŒì§í•´ìš”.',
        2: 'ë°°ìš°ìê°€ í™œë°œí•˜ê³  ë„ì „ì ì´ì—ìš”. í˜¸ê¸°ì‹¬ì´ ë§ê³  ì—ë„ˆì§€ê°€ ë„˜ì³ìš”!',
        3: 'ë°°ìš°ìê°€ ì˜ˆë¯¼í•˜ê³  ì„¬ì„¸í•´ìš”. ì˜ˆìˆ ì  ê°ê°ì´ ìˆê³  ì†ì¬ì£¼ë„ ì¢‹ì•„ìš”.',
        4: 'ë°°ìš°ìê°€ í¬ìš©ë ¥ ìˆê³  ì‚¬êµì ì´ì—ìš”. ì¹œêµ¬ê°€ ë§ê³  ë¦¬ë”ì‹­ë„ ìˆì–´ìš”.',
        5: 'ë°°ìš°ìê°€ ì˜ë¦¬í•˜ê³  ë§ì„ ì˜í•´ìš”. ëˆˆì¹˜ê°€ ë¹ ë¥´ê³  ì‚¬ëŒ ë‹¤ë£¨ëŠ” ì¬ì£¼ê°€ ìˆì–´ìš”.',
        6: 'ë°°ìš°ìê°€ ë°ê³  ì—´ì •ì ì´ì—ìš”. ì„±ê²©ì´ ê¸‰í•  ìˆ˜ ìˆì§€ë§Œ ì—ë„ˆì§€ ë„˜ì³ìš”!',
        7: 'ë°°ìš°ìê°€ ìˆœí•˜ê³  ì •ì´ ë§ì•„ìš”. ë°°ë ¤ì‹¬ ê¹Šê³  ì°©í•´ìš”.',
        8: 'ë°°ìš°ìê°€ ë˜‘ë¶€ëŸ¬ì§€ê³  ë‹¹ë‹¹í•´ìš”. ê²°ë‹¨ë ¥ ìˆê³  ë…ë¦½ì‹¬ì´ ê°•í•´ìš”.',
        9: 'ë°°ìš°ìê°€ ê¹”ë”í•˜ê³  ê°ê°ì ì´ì—ìš”. ì˜ˆìˆ ì´ë‚˜ ë¯¸ìš© ìª½ì— ì¬ëŠ¥ì´ ìˆì„ ìˆ˜ ìˆì–´ìš”.',
        10: 'ë°°ìš°ìê°€ ê³ ì§‘ ì„¸ì§€ë§Œ ì˜ë¦¬ ìˆì–´ìš”. í•œë²ˆ ì •í•˜ë©´ ëê¹Œì§€ í•´ìš”.',
        11: 'ë°°ìš°ìê°€ í˜„ëª…í•˜ê³  ì ì‘ë ¥ ì¢‹ì•„ìš”. ì–´ë””ì„œë“  ì˜ ì§€ë‚´ê³  ìœµí†µì„±ì´ ìˆì–´ìš”.'
    };
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ’• ì—°ì• ìš´/ê²°í˜¼ìš´ ë¶„ì„</strong></p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(rating)}${'â˜†'.repeat(5-rating)}</span>
        </div>
        <div class="info-box">
            <p style="line-height:1.8;">${desc}</p>
        </div>
        <div class="info-box" style="margin-top:12px;background:rgba(255,182,193,0.15);">
            <p><strong>ğŸ’‘ ì¼ì§€ë¡œ ë³´ëŠ” ë°°ìš°ììƒ</strong></p>
            <p style="margin-top:10px;line-height:1.8;">${spouseByBranch[dbi]}</p>
        </div>`;
}

/* ========================================
   14-6. ìƒì„¸ í†µë³€ - ì¬ë¬¼ìš´
   ======================================== */
function genWealthFortune(saju, str, gods) {
    const dm = saju.day.s;
    const ec = countElements(saju);
    const jaeEl = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 2) % 5];
    const sikEl = EL_ORDER[(EL_ORDER.indexOf(dm.e) + 1) % 5];
    const jaeCount = ec[jaeEl];
    const sikCount = ec[sikEl];
    
    let rating = 3, desc = '';
    
    if (str.type === 'strong' && jaeCount >= 2) {
        rating = 5;
        desc = 'ëˆ ë³µì´ ë§ì•„ìš”! ì‹ ê°•í•˜ë©´ì„œ ì¬ì„±ì´ ë§ìœ¼ë‹ˆ ëˆì„ ë²Œ ëŠ¥ë ¥ê³¼ ë³µì´ ëª¨ë‘ ìˆì–´ìš”. ì‚¬ì—…ì´ë‚˜ íˆ¬ìì—ì„œ í¬ê²Œ ì„±ê³µí•  ìˆ˜ ìˆì–´ìš”!';
    } else if (str.type === 'strong' && jaeCount === 1) {
        rating = 4;
        desc = 'ê¾¸ì¤€íˆ ë²„ëŠ” íƒ€ì…ì´ì—ìš”. í•œ ë²ˆì— í° ëˆë³´ë‹¤ ì›”ê¸‰ì²˜ëŸ¼ ì•ˆì •ì ì¸ ìˆ˜ì…ì´ ì¢‹ì•„ìš”.';
    } else if (str.type === 'weak' && jaeCount >= 2) {
        rating = 2;
        desc = 'ëˆì´ ë“¤ì–´ì™€ë„ ë‚˜ê°€ê¸° ì‰¬ì›Œìš”. ì‹ ì•½í•œë° ì¬ì„±ì´ ë§ìœ¼ë©´ ê°ë‹¹ì´ ì•ˆ ë¼ìš”. ì €ì¶• ìŠµê´€ì„ ë“¤ì´ì„¸ìš”!';
    } else if (jaeCount === 0) {
        rating = 2;
        desc = 'ì¬ì„±ì´ ì—†ì–´ì„œ ëˆì— ê´€ì‹¬ì´ ì ê±°ë‚˜, ëˆ ë²„ëŠ” ê²Œ í˜ë“¤ ìˆ˜ ìˆì–´ìš”. ì „ë¬¸ ê¸°ìˆ ì„ ìµíˆì„¸ìš”.';
    } else {
        rating = 3;
        desc = 'í‰ë²”í•œ ì¬ë¬¼ìš´ì´ì—ìš”. ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ë©´ ì¤‘ì‚°ì¸µ ì´ìƒì˜ ì‚¶ì„ ì‚´ ìˆ˜ ìˆì–´ìš”.';
    }
    
    // ì‹ì‹  ì²´í¬
    if (sikCount >= 2) {
        rating = Math.min(5, rating + 1);
        desc += '<br><br>âœ¨ <strong>ì‹ì‹ ì´ ë§ì•„ì„œ ì¬ëŠ¥ìœ¼ë¡œ ëˆ ë²„ëŠ” êµ¬ì¡°!</strong> ê¸°ìˆ , ì˜ˆìˆ , ì°½ì‘ìœ¼ë¡œ ë¶€ì ë  ìˆ˜ ìˆì–´ìš”.';
    }
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ’° ì¬ë¬¼ìš´ ë¶„ì„</strong></p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(rating)}${'â˜†'.repeat(5-rating)}</span>
        </div>
        <div class="info-box">
            <p style="line-height:1.8;">${desc}</p>
        </div>
        <div class="info-box good" style="margin-top:12px;">
            <p><strong>ğŸ¯ ì¬ë¬¼ ìš´ ì˜¬ë¦¬ëŠ” ë²•</strong></p>
            <p style="margin-top:8px;">ìš©ì‹ ì¸ <strong>${ELEMENT[gods.yong].k}</strong> ê¸°ìš´ì„ í™œìš©í•˜ì„¸ìš”!<br>í–‰ìš´ì˜ ìˆ«ì: ${ELEMENT[gods.yong].nums.slice(0,5).join(', ')}</p>
        </div>`;
}

/* ========================================
   14-7. ìƒì„¸ í†µë³€ - ê±´ê°•ìš´
   ======================================== */
function genHealthFortune(saju, str, gods) {
    const dm = saju.day.s;
    const ec = countElements(saju);
    
    const healthData = {
        wood: {o:'ê°„, ë‹´ë‚­, ëˆˆ', s:'í”¼ë¡œ, ì‹œë ¥ ì €í•˜, ê·¼ìœ¡ ê²½ë ¨, ì†í†± ê°ˆë¼ì§', a:'ë…¹ìƒ‰ ì±„ì†Œ ì„­ì·¨, ìŠ¤íŠ¸ë ˆì¹­, ëˆˆ íœ´ì‹'},
        fire: {o:'ì‹¬ì¥, ì†Œì¥, í˜€', s:'ê°€ìŠ´ ë‘ê·¼ê±°ë¦¼, ë¶ˆë©´ì¦, í˜€ ì—¼ì¦', a:'ê·œì¹™ì ì¸ ìˆ˜ë©´, ëª…ìƒ, ë¶‰ì€ ìŒì‹'},
        earth: {o:'ìœ„ì¥, ë¹„ì¥, ì…ìˆ ', s:'ì†Œí™”ë¶ˆëŸ‰, ë³µë¶€ íŒ½ë§Œ, ì…ìˆ  íŠ¸ëŠ” ê²ƒ', a:'ê·œì¹™ì ì¸ ì‹ì‚¬, ë…¸ë€ ìŒì‹, ê±·ê¸°'},
        metal: {o:'í, ëŒ€ì¥, ì½”', s:'í˜¸í¡ê¸° ì§ˆí™˜, í”¼ë¶€ íŠ¸ëŸ¬ë¸”, ë³€ë¹„', a:'ì‹¬í˜¸í¡, ë“±ì‚°, í°ìƒ‰ ìŒì‹, ìœ ì‚°ê· '},
        water: {o:'ì‹ ì¥, ë°©ê´‘, ê·€', s:'ë¶€ì¢…, ìš”í†µ, ìƒì‹ê¸° ë¬¸ì œ, ì²­ë ¥ ì €í•˜', a:'ì¶©ë¶„í•œ ìˆ˜ë¶„, ê²€ì€ì½©, ë°˜ì‹ ìš•'}
    };
    
    const sorted = Object.entries(ec).sort((a,b) => a[1] - b[1]);
    const weakest = sorted[0];
    const strongest = Object.entries(ec).sort((a,b) => b[1] - a[1])[0];
    
    let rating = str.type === 'weak' ? 3 : 4;
    
    return `
        <div class="info-box gold">
            <p><strong>ğŸ¥ ê±´ê°•ìš´ ë¶„ì„</strong></p>
        </div>
        <div style="text-align:center;margin:15px 0;">
            <span style="font-size:2rem;">${'â­'.repeat(rating)}${'â˜†'.repeat(5-rating)}</span>
        </div>
        <div class="info-box">
            <p><strong>ì•½í•œ ì¥ê¸°:</strong> ${healthData[dm.e].o}</p>
            <p style="margin-top:10px;"><strong>ì£¼ì˜ ì¦ìƒ:</strong><br>${healthData[dm.e].s}</p>
            <p style="margin-top:10px;"><strong>ê±´ê°• ê´€ë¦¬ë²•:</strong><br>${healthData[dm.e].a}</p>
        </div>
        ${weakest[1] === 0 ? `<div class="info-box warn" style="margin-top:12px;"><p><strong>âš ï¸ ${ELEMENT[weakest[0]].k} ê¸°ìš´ì´ ì—†ì–´ìš”!</strong><br>${healthData[weakest[0]].o} ê´€ë ¨ ê±´ê°•ì— íŠ¹íˆ ì‹ ê²½ ì“°ì„¸ìš”!<br><br>${healthData[weakest[0]].a}</p></div>` : ''}
        ${strongest[1] >= 4 ? `<div class="info-box" style="margin-top:12px;"><p><strong>ğŸ“Œ ${ELEMENT[strongest[0]].k} ê¸°ìš´ì´ ë„ˆë¬´ ë§ì•„ìš”</strong><br>${healthData[strongest[0]].o} ê´€ë ¨ ì¥ê¸°ì— ë¬´ë¦¬ ê°ˆ ìˆ˜ ìˆì–´ìš”. ê· í˜•ì´ ì¤‘ìš”í•´ìš”!</p></div>` : ''}
        <div class="info-box good" style="margin-top:12px;">
            <p><strong>ğŸ—“ï¸ ê³„ì ˆë³„ ê±´ê°• ê´€ë¦¬</strong></p>
            <p style="margin-top:8px;line-height:1.8;">
                â€¢ ë´„: ê°„, ëˆˆ ê´€ë¦¬ / ìŠ¤íŠ¸ë ˆì¹­<br>
                â€¢ ì—¬ë¦„: ì‹¬ì¥, í˜ˆê´€ / ë¬¼ ë§ì´ ë§ˆì‹œê¸°<br>
                â€¢ í™˜ì ˆê¸°: ì†Œí™”ê¸° / ê·œì¹™ì ì¸ ì‹ì‚¬<br>
                â€¢ ê°€ì„: í, í˜¸í¡ê¸° / ë“±ì‚°, ì‹¬í˜¸í¡<br>
                â€¢ ê²¨ìš¸: ì‹ ì¥, ë¼ˆ / ë³´ì˜¨, ë°˜ì‹ ìš•
            </p>
        </div>`;
}

/* ========================================
   14-8. ê¶í•© ë¶„ì„
   ======================================== */
function runMatch() {
    if (!SAJU) { toast('ë¨¼ì € ë‚´ ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”!'); return; }
    
    const py = +document.getElementById('partner-year').value;
    const pm = +document.getElementById('partner-month').value;
    const pd = +document.getElementById('partner-day').value;
    
    if (!py || !pm || !pd) { toast('ìƒëŒ€ë°© ìƒë…„ì›”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”'); return; }
    
    const pSaju = {
        year: calcYearPillar(py, pm, pd),
        month: calcMonthPillar(py, pm, pd),
        day: calcDayPillar(py, pm, pd)
    };
    
    let score = 50, details = [];
    
    // 1. ì¼ê°„ ê¶í•© (ì²œê°„ í•©)
    const myDm = STEM.indexOf(SAJU.day.s), pDm = STEM.indexOf(pSaju.day.s);
    const ganHap = [[0,5],[1,6],[2,7],[3,8],[4,9]];
    let ganMatch = false;
    for (let [a,b] of ganHap) if ((myDm===a && pDm===b) || (myDm===b && pDm===a)) { ganMatch = true; break; }
    if (ganMatch) { score += 20; details.push({t:'good', txt:'ğŸ’• ì²œê°„í•©! ë‘ ì‚¬ëŒì˜ ì¼ê°„ì´ ì²œìƒì—°ë¶„ì´ì—ìš”!'}); }
    
    // 2. ì¼ì§€ ê¶í•© (ì§€ì§€ í•©/ì¶©)
    const myDb = BRANCH.indexOf(SAJU.day.b), pDb = BRANCH.indexOf(pSaju.day.b);
    const jiHap = [[0,1],[2,11],[3,10],[4,9],[5,8],[6,7]];
    const jiChung = [[0,6],[1,7],[2,8],[3,9],[4,10],[5,11]];
    for (let [a,b] of jiHap) if ((myDb===a && pDb===b) || (myDb===b && pDb===a)) { score += 15; details.push({t:'good', txt:'ğŸ¤ ì¼ì§€ ìœ¡í•©! í•¨ê»˜ ìˆìœ¼ë©´ í¸ì•ˆí•˜ê³  ì•ˆì •ê°ì„ ëŠê»´ìš”.'}); break; }
    for (let [a,b] of jiChung) if ((myDb===a && pDb===b) || (myDb===b && pDb===a)) { score -= 15; details.push({t:'bad', txt:'ğŸ’¥ ì¼ì§€ ì¶©! ì„œë¡œ ë¶€ë”ªíˆê¸° ì‰¬ì›Œìš”. ì–‘ë³´ê°€ í•„ìš”í•´ìš”.'}); break; }
    
    // 3. ì˜¤í–‰ ìƒìƒ/ìƒê·¹
    const myEl = EL_ORDER.indexOf(SAJU.day.s.e), pEl = EL_ORDER.indexOf(pSaju.day.s.e);
    const saeng = [[0,2],[2,1],[1,3],[3,4],[4,0]];
    const keuk = [[0,3],[3,1],[1,4],[4,2],[2,0]];
    for (let [a,b] of saeng) if ((myEl===a && pEl===b) || (myEl===b && pEl===a)) { score += 10; details.push({t:'good', txt:`ğŸŒ± ì˜¤í–‰ ìƒìƒ! ${ELEMENT[SAJU.day.s.e].k}ê³¼ ${ELEMENT[pSaju.day.s.e].k}ì´ ì„œë¡œ ë„ì™€ì£¼ëŠ” ê´€ê³„ì˜ˆìš”.`}); break; }
    for (let [a,b] of keuk) if ((myEl===a && pEl===b) || (myEl===b && pEl===a)) { score -= 10; details.push({t:'bad', txt:`âš”ï¸ ì˜¤í–‰ ìƒê·¹! ì„œë¡œ ë§ì¶°ê°€ëŠ” ë…¸ë ¥ì´ í•„ìš”í•´ìš”.`}); break; }
    if (SAJU.day.s.e === pSaju.day.s.e) { score += 5; details.push({t:'neutral', txt:`ğŸ”„ ê°™ì€ ${ELEMENT[SAJU.day.s.e].k} ì˜¤í–‰! ë¹„ìŠ·í•œ ì„±í–¥ì´ë¼ í†µí•´ìš”.`}); }
    
    // 4. ë  ê¶í•©
    const myTti = BRANCH.indexOf(SAJU.year.b), pTti = BRANCH.indexOf(pSaju.year.b);
    for (let [a,b] of jiHap) if ((myTti===a && pTti===b) || (myTti===b && pTti===a)) { score += 5; details.push({t:'good', txt:`ğŸ¾ ë  ìœ¡í•©! ${BRANCH[myTti].a}ë ì™€ ${BRANCH[pTti].a}ë ëŠ” ì˜ ë§ì•„ìš”.`}); break; }
    for (let [a,b] of jiChung) if ((myTti===a && pTti===b) || (myTti===b && pTti===a)) { score -= 5; details.push({t:'bad', txt:`ğŸ¾ ë  ì¶©! ${BRANCH[myTti].a}ë ì™€ ${BRANCH[pTti].a}ë ëŠ” ë¶€ë”ªí ìˆ˜ ìˆì–´ìš”.`}); break; }
    
    score = Math.max(0, Math.min(100, score));
    
    let grade, color, summary;
    if (score >= 80) { grade = 'ğŸ’– ì²œìƒì—°ë¶„'; color = '#e91e63'; summary = 'ë‘ ë¶„ì€ ì •ë§ ì˜ ë§ì•„ìš”! ìµœê³ ì˜ ê¶í•©ì´ì—ìš”.'; }
    else if (score >= 65) { grade = 'ğŸ’• ì¢‹ì€ ê¶í•©'; color = '#9c27b0'; summary = 'ì˜ ë§ëŠ” í¸ì´ì—ìš”! ì•½ê°„ì˜ ë…¸ë ¥ë§Œ ìˆìœ¼ë©´ í–‰ë³µí•´ìš”.'; }
    else if (score >= 50) { grade = 'ğŸ’› ë³´í†µ ê¶í•©'; color = '#ff9800'; summary = 'í‰ë²”í•œ ê¶í•©ì´ì—ìš”. ì„œë¡œ ë‹¤ë¥¸ ì ì„ ì¸ì •í•˜ë©´ ì¢‹ì•„ì ¸ìš”.'; }
    else if (score >= 35) { grade = 'ğŸ’” ë…¸ë ¥ í•„ìš”'; color = '#ff5722'; summary = 'ë¶€ë”ªíˆëŠ” ë¶€ë¶„ì´ ìˆì–´ìš”. ì–‘ë³´ì™€ ì´í•´ê°€ ë§ì´ í•„ìš”í•´ìš”.'; }
    else { grade = 'ğŸ˜¢ ìƒê·¹ ê¶í•©'; color = '#f44336'; summary = 'ì‰½ì§€ ì•Šì€ ê¶í•©ì´ì—ìš”. í•˜ì§€ë§Œ ì‚¬ë‘ìœ¼ë¡œ ê·¹ë³µ ê°€ëŠ¥í•´ìš”!'; }
    
    document.getElementById('match-result').innerHTML = `
        <div class="info-box" style="text-align:center;">
            <p style="font-size:2rem;color:${color}">${grade}</p>
            <p style="font-size:1.5rem;font-weight:bold;margin-top:10px;">${score}ì </p>
            <div style="background:#333;border-radius:10px;height:20px;margin:15px 0;">
                <div style="background:linear-gradient(90deg,#ff6b6b,#ee5a24);height:100%;border-radius:10px;width:${score}%"></div>
            </div>
            <p>${summary}</p>
        </div>
        <div class="info-box" style="margin-top:15px;">
            <p><strong>ğŸ“Š ìƒì„¸ ë¶„ì„</strong></p>
            <p style="margin-top:8px;"><strong>ë‚˜:</strong> ${SAJU.day.s.c}${SAJU.day.b.c}ì¼ì£¼ (${ELEMENT[SAJU.day.s.e].k})</p>
            <p><strong>ìƒëŒ€:</strong> ${pSaju.day.s.c}${pSaju.day.b.c}ì¼ì£¼ (${ELEMENT[pSaju.day.s.e].k})</p>
        </div>
        ${details.map(d => `<div class="info-box ${d.t === 'good' ? 'good' : d.t === 'bad' ? 'warn' : ''}" style="margin-top:10px;"><p>${d.txt}</p></div>`).join('')}
        <div class="info-box" style="margin-top:15px;">
            <p><strong>ğŸ’¡ ê¶í•© íŒ</strong></p>
            <p style="margin-top:8px;">${score >= 65 ? 'ì„œë¡œì˜ ì¥ì ì„ ì¹­ì°¬í•´ì£¼ì„¸ìš”!' : score >= 50 ? 'ì„œë¡œ ë‹¤ë¥¸ ì ì„ ì¸ì •í•˜ê³  ì¡´ì¤‘í•˜ì„¸ìš”.' : 'ëŒ€í™”ë¥¼ ë§ì´ í•˜ì„¸ìš”. ì„œë¡œì˜ ê³µê°„ë„ ì¡´ì¤‘í•´ì£¼ì„¸ìš”.'}</p>
        </div>`;
}

/* ========================================
   15. ì‚¬ì£¼ ë¶„ì„ ì‹¤í–‰
   ======================================== */
function analyzeSaju() {
    try {
        const y = +document.getElementById('birth-year').value;
        const m = +document.getElementById('birth-month').value;
        const d = +document.getElementById('birth-day').value;
        const h = +document.getElementById('birth-hour').value;
        
        // ì…ë ¥ê°’ ê²€ì¦
        if (!y || !m || !d) { toast('ìƒë…„ì›”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”'); return; }
        if (y < 1900 || y > 2100) { toast('ì—°ë„ëŠ” 1900~2100 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
        if (m < 1 || m > 12) { toast('ì›”ì€ 1~12 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
        if (d < 1 || d > 31) { toast('ì¼ì€ 1~31 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
        
        let sy = y, sm = m, sd = d;
        if (CALENDAR === 'lunar') {
            const conv = lunarToSolar(y, m, d);
            if (!conv || !conv.year) { toast('ìŒë ¥ ë³€í™˜ ì˜¤ë¥˜. ì–‘ë ¥ìœ¼ë¡œ ì‹œë„í•˜ì„¸ìš”'); return; }
            sy = conv.year; sm = conv.month; sd = conv.day;
        }
        
        const adj = adjustTime(sy, sm, sd, h);
        if (!adj || !adj.y) { toast('ì‹œê°„ ë³´ì • ì˜¤ë¥˜'); return; }
        
        SAJU = {
            year: calcYearPillar(adj.y, adj.m, adj.d),
            month: calcMonthPillar(adj.y, adj.m, adj.d),
            day: calcDayPillar(adj.y, adj.m, adj.d),
            hour: h >= 0 ? calcHourPillar(calcDayPillar(adj.y, adj.m, adj.d).s, adj.h) : null
        };
        
        // ì‚¬ì£¼ ê³„ì‚° ê²°ê³¼ ê²€ì¦
        if (!SAJU.year || !SAJU.month || !SAJU.day) { 
            toast('ì‚¬ì£¼ ê³„ì‚° ì˜¤ë¥˜. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”'); 
            return; 
        }
        
        BIRTH_YEAR = y;
        const str = calcStrength(SAJU);
        if (!str) { toast('ì‹ ê°•/ì‹ ì•½ ê³„ì‚° ì˜¤ë¥˜'); return; }
        
        GODS = calcGods(SAJU, str);
        if (!GODS) { toast('ìš©ì‹  ê³„ì‚° ì˜¤ë¥˜'); return; }
        
        renderSaju(str);
        document.getElementById('saju-result').style.display = 'block';
        document.getElementById('my-info-display').innerHTML = `<p style="color:var(--gold);">${SAJU.day.s.c}${SAJU.day.b.c}ì¼ì£¼ (${ELEMENT[SAJU.day.s.e].k})</p>`;
        
        toast('ì‚¬ì£¼ ë¶„ì„ ì™„ë£Œ!');
    } catch (error) {
        console.error('ì‚¬ì£¼ ë¶„ì„ ì˜¤ë¥˜:', error);
        toast('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì…ë ¥ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
    }
}

/* ========================================
   16. ë Œë”ë§ í•¨ìˆ˜ë“¤
   ======================================== */
function renderSaju(str) {
    try {
    // ì‚¬ì£¼ ê¸°ë‘¥
    const pillars = ['hour','day','month','year'];
    const labels = ['ì‹œì£¼','ì¼ì£¼','ì›”ì£¼','ì—°ì£¼'];
    document.getElementById('pillars').innerHTML = pillars.map((p, i) => {
        const pillar = SAJU[p];
        if (!pillar) return `<div class="pillar"><div class="pillar-label">${labels[i]}</div><div class="pillar-stem">-</div><div class="pillar-branch">-</div></div>`;
        const god = p !== 'day' ? getTenGod(pillar.s, SAJU.day.s) : null;
        return `<div class="pillar ${p === 'day' ? 'dm' : ''}">
            <div class="pillar-label">${labels[i]}</div>
            <div class="pillar-stem el-${pillar.s.e}">${pillar.s.c}</div>
            <div class="pillar-branch el-${pillar.b.e}">${pillar.b.c}</div>
            <div class="pillar-sub">${pillar.s.k}${pillar.b.k}</div>
            ${god ? `<div class="pillar-god">${god.k}</div>` : '<div class="pillar-god">ì¼ê°„</div>'}
        </div>`;
    }).join('');
    
    // 12ìš´ì„±
    const un12 = getTwelveState(SAJU.day.s, SAJU.day.b);
    document.getElementById('twelve-states').innerHTML = `<div class="info-box"><p><strong>ì¼ì§€ 12ìš´ì„±:</strong> ${un12.k} (ì—ë„ˆì§€ ${un12.l}/12)</p></div>`;
    
    // ì‹ ê°•/ì‹ ì•½
    const typeLabel = {strong:'ì‹ ê°•',weak:'ì‹ ì•½',balanced:'ì¤‘í™”'};
    document.getElementById('strength-box').innerHTML = `
        <div class="strength-header">
            <span class="strength-title">ì¼ê°„ ê°•ì•½</span>
            <span class="strength-badge ${str.type}">${typeLabel[str.type]}${str.extreme ? ` (${str.extreme})` : ''}</span>
        </div>
        <div class="strength-bar"><div class="strength-fill ${str.type}" style="width:${str.pct}%"></div></div>
        <div class="factors">${str.factors.map(f => `<div class="factor"><span class="factor-label">${f.l}</span><span class="factor-value ${f.p ? 'pos' : 'neg'}">${f.v}</span></div>`).join('')}</div>
    `;
    
    // ========== ë‚©ìŒ/ëª…ê¶/íƒœì› (NEW) ==========
    const dayNapeum = calcNapeum(SAJU.day.s, SAJU.day.b);
    const yearNapeum = calcNapeum(SAJU.year.s, SAJU.year.b);
    const myunggung = SAJU.hour ? calcMyunggung(SAJU.month.b, SAJU.hour.b) : null;
    const taewon = calcTaewon(SAJU.year.s, SAJU.month.s, SAJU.month.b);
    
    document.getElementById('napeum-myunggung').innerHTML = `
        <div class="info-box" style="margin-bottom:10px;">
            <p><strong>ğŸµ ë‚©ìŒì˜¤í–‰(ç´éŸ³äº”è¡Œ)</strong></p>
            <p style="font-size:0.85rem;color:var(--gray);margin-top:5px;">60ê°‘ìì˜ ìŒë¥ ì— ë”°ë¥¸ ì˜¤í–‰</p>
            <div style="margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                <div style="padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;">
                    <p style="font-size:0.8rem;color:var(--gray);">ì¼ì£¼ ë‚©ìŒ</p>
                    <p style="font-weight:bold;margin-top:5px;color:var(--gold);">${SAJU.day.s.c}${SAJU.day.b.c} â†’ ${dayNapeum.name}</p>
                    <p style="font-size:0.85rem;margin-top:5px;">${dayNapeum.desc}</p>
                </div>
                <div style="padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;">
                    <p style="font-size:0.8rem;color:var(--gray);">ì—°ì£¼ ë‚©ìŒ</p>
                    <p style="font-weight:bold;margin-top:5px;">${SAJU.year.s.c}${SAJU.year.b.c} â†’ ${yearNapeum.name}</p>
                    <p style="font-size:0.85rem;margin-top:5px;">${yearNapeum.desc}</p>
                </div>
            </div>
        </div>
        
        ${myunggung ? `
        <div class="info-box" style="margin-bottom:10px;">
            <p><strong>ğŸ  ëª…ê¶(å‘½å®®)</strong></p>
            <p style="font-size:0.85rem;color:var(--gray);margin-top:5px;">ì›”ì§€+ì‹œì§€ë¡œ ê³„ì‚°í•œ ì¸ìƒì˜ ë°©í–¥</p>
            <div style="margin-top:12px;padding:15px;background:rgba(253,216,53,0.1);border-radius:8px;border-left:3px solid var(--gold);">
                <p style="font-weight:bold;font-size:1.1rem;color:var(--gold);">${myunggung.name} (${myunggung.branch.c}${myunggung.branch.k})</p>
                <p style="margin-top:8px;"><strong>ì„±í–¥:</strong> ${myunggung.trait}</p>
                <p style="margin-top:5px;"><strong>ì í•© ë¶„ì•¼:</strong> ${myunggung.career}</p>
            </div>
        </div>
        ` : '<div class="info-box" style="margin-bottom:10px;"><p><strong>ğŸ  ëª…ê¶(å‘½å®®)</strong></p><p style="color:var(--gray);margin-top:5px;">ì‹œì£¼ë¥¼ ëª¨ë¥´ë©´ ëª…ê¶ì„ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p></div>'}
        
        <div class="info-box">
            <p><strong>ğŸŒ± íƒœì›(èƒå…ƒ)</strong></p>
            <p style="font-size:0.85rem;color:var(--gray);margin-top:5px;">ì‰íƒœ ì‹œì ì˜ ê°„ì§€ (ì›”ê°„+1, ì›”ì§€+3)</p>
            <div style="margin-top:12px;padding:15px;background:rgba(255,255,255,0.05);border-radius:8px;">
                <p style="font-weight:bold;font-size:1.1rem;">${taewon.pillar} (${taewon.stem.k}${taewon.branch.k})</p>
                <p style="margin-top:8px;">ë‚©ìŒ: ${taewon.napeum.name} (${taewon.napeum.elementK})</p>
                <p style="margin-top:5px;font-size:0.9rem;color:var(--gray);">${taewon.desc}</p>
            </div>
        </div>
    `;
    
    // ========== ì§€ì¥ê°„ ë¶„ì„ (NEW) ==========
    const jjAnalysis = analyzeJijanggan(SAJU);
    document.getElementById('jijanggan-analysis').innerHTML = `
        <div class="info-box">
            <p style="margin-bottom:10px;font-size:0.85rem;color:var(--gray);">ì§€ì§€(åœ°æ”¯) ì†ì— ìˆ¨ì€ ì²œê°„(å¤©å¹²)ì„ ë¶„ì„í•©ë‹ˆë‹¤</p>
            ${jjAnalysis.pillars.map(p => `
                <div style="margin-bottom:15px;padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
                    <p style="font-weight:bold;color:var(--gold);">${p.name}: ${p.branch.c}(${p.branch.k})</p>
                    <div style="margin-top:8px;display:flex;flex-wrap:wrap;gap:8px;">
                        ${p.hidden.map(h => `
                            <span style="padding:4px 10px;border-radius:15px;font-size:0.8rem;
                                background:${h.type === 'ì •ê¸°' ? 'rgba(76,175,80,0.3)' : h.type === 'ì¤‘ê¸°' ? 'rgba(255,152,0,0.3)' : 'rgba(158,158,158,0.3)'};
                                border:1px solid ${h.type === 'ì •ê¸°' ? 'var(--wood)' : h.type === 'ì¤‘ê¸°' ? 'var(--earth)' : 'var(--metal)'};">
                                ${h.stem.c}(${h.stem.k}) Â· ${h.type} Â· ${h.days}ì¼ Â· ${h.god.k}
                                ${h.tougan ? '<span style="color:var(--gold);">â˜…íˆ¬ê°„</span>' : ''}
                            </span>
                        `).join('')}
                    </div>
                </div>
            `).join('')}
        </div>
        <div class="info-box" style="margin-top:10px;">
            <p><strong>ğŸ“Š ì§€ì¥ê°„ ì˜¤í–‰ ë¶„í¬</strong></p>
            <div style="margin-top:10px;display:flex;justify-content:space-around;">
                ${EL_ORDER.map(e => `
                    <div style="text-align:center;">
                        <div class="el-${e}" style="font-size:1.2rem;">${ELEMENT[e].c}</div>
                        <div style="font-size:0.9rem;margin-top:3px;">${jjAnalysis.summary.elements[e].toFixed(1)}</div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    // ========== í†µê·¼/íˆ¬ê°„ ë¶„ì„ (NEW) ==========
    const ttAnalysis = analyzeTonggeunTougan(SAJU);
    document.getElementById('tonggeun-analysis').innerHTML = `
        <div class="info-box">
            <p><strong>ğŸŒ³ í†µê·¼(é€šæ ¹)</strong> - ì²œê°„ì´ ì§€ì§€ì— ë¿Œë¦¬ ë‚´ë¦° ìƒíƒœ</p>
            <div style="margin-top:10px;">
                ${ttAnalysis.tonggeun.length ? ttAnalysis.tonggeun.map(t => `
                    <div style="padding:8px;margin:5px 0;background:rgba(76,175,80,0.1);border-radius:6px;border-left:3px solid var(--wood);">
                        <span style="font-weight:bold;">${t.pillar} ${t.stem}</span> (${t.god}) â†’
                        ${t.roots.map(r => `<span style="margin-left:5px;padding:2px 6px;background:rgba(255,255,255,0.1);border-radius:4px;font-size:0.8rem;">${r.pillar}${r.branch} ${r.type}(${r.strength})</span>`).join('')}
                    </div>
                `).join('') : '<p style="color:var(--gray);font-size:0.9rem;">í†µê·¼í•œ ì²œê°„ì´ ì—†ìŠµë‹ˆë‹¤. ë¿Œë¦¬ê°€ ì•½í•´ìš”.</p>'}
            </div>
        </div>
        <div class="info-box" style="margin-top:10px;">
            <p><strong>â˜€ï¸ íˆ¬ê°„(é€å¹²)</strong> - ì§€ì¥ê°„ì´ ì²œê°„ì— ë“œëŸ¬ë‚œ ìƒíƒœ</p>
            <div style="margin-top:10px;">
                ${ttAnalysis.tougan.length ? ttAnalysis.tougan.map(t => `
                    <div style="padding:8px;margin:5px 0;background:rgba(253,216,53,0.1);border-radius:6px;border-left:3px solid var(--gold);">
                        <span style="font-weight:bold;">${t.stem}</span> (${t.god}) - ${t.pillar}ì—ì„œ ${t.from}ì˜ ê¸°ìš´ì´ ë“œëŸ¬ë‚¨
                    </div>
                `).join('') : '<p style="color:var(--gray);font-size:0.9rem;">íˆ¬ê°„í•œ ì§€ì¥ê°„ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
            </div>
        </div>
    `;
    
    // ìš©ì‹ 
    document.getElementById('gods').innerHTML = `
        <div class="god yong"><div class="god-title">ìš©ì‹ (ç”¨ç¥)</div><div class="god-element el-${GODS.yong}">${ELEMENT[GODS.yong].c}</div><div class="god-name">${ELEMENT[GODS.yong].k} - ${ELEMENT[GODS.yong].n}</div></div>
        <div class="god hee"><div class="god-title">í¬ì‹ (å–œç¥)</div><div class="god-element el-${GODS.hee}">${ELEMENT[GODS.hee].c}</div><div class="god-name">${ELEMENT[GODS.hee].k} - ${ELEMENT[GODS.hee].n}</div></div>
        <div class="god gi"><div class="god-title">ê¸°ì‹ (å¿Œç¥)</div><div class="god-element el-${GODS.gi}">${ELEMENT[GODS.gi].c}</div><div class="god-name">${ELEMENT[GODS.gi].k} - ${ELEMENT[GODS.gi].n}</div></div>
    `;
    
    // ìš©ì‹  ìƒì„¸ + ì¡°í›„ ê³ ê¸‰
    let godsDetailHtml = `<div class="info-box gold"><p>${ELEMENT[GODS.yong].n} ê¸°ìš´ì´ ë‹¹ì‹ ì—ê²Œ í–‰ìš´ì„ ê°€ì ¸ë‹¤ì¤ë‹ˆë‹¤.</p></div>`;
    
    // ì¡°í›„ ìƒì„¸
    if (GODS.johu) {
        godsDetailHtml += `
            <div class="info-box" style="margin-top:10px;">
                <p><strong>ğŸŒ¡ï¸ ì¡°í›„(èª¿å€™) ë¶„ì„</strong></p>
                <p style="margin-top:8px;font-size:0.9rem;">${GODS.johuDesc || 'ê³„ì ˆì— ë§ëŠ” ì¡°í›„ìš©ì‹ ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.'}</p>
                ${GODS.sub ? `<p style="margin-top:5px;font-size:0.85rem;color:var(--gray);">ë³´ì¡°ìš©ì‹ : ${ELEMENT[GODS.sub].k}(${ELEMENT[GODS.sub].c})</p>` : ''}
            </div>
        `;
    }
    
    // í•œë‚œì¡°ìŠµ
    if (GODS.climate) {
        godsDetailHtml += `
            <div class="info-box ${GODS.climate.needs.length ? 'warn' : ''}" style="margin-top:10px;">
                <p><strong>ğŸŒ¡ï¸ í•œë‚œì¡°ìŠµ(å¯’æš–ç‡¥æ¿•): ${GODS.climate.type}</strong></p>
                <p style="margin-top:8px;font-size:0.9rem;">${GODS.climate.desc}</p>
                ${GODS.climate.needs.length ? `<p style="margin-top:5px;font-size:0.85rem;">í•„ìš”í•œ ê¸°ìš´: ${GODS.climate.needs.map(e => ELEMENT[e].k).join(', ')}</p>` : ''}
            </div>
        `;
    }
    
    // ë³‘ì•½
    if (GODS.byungYak && GODS.byungYak.byung) {
        godsDetailHtml += `
            <div class="info-box" style="margin-top:10px;">
                <p><strong>ğŸ’Š ë³‘ì•½(ç—…è—¥) ë¶„ì„</strong></p>
                <p style="margin-top:8px;font-size:0.9rem;">
                    ë³‘(ç—…): ${ELEMENT[GODS.byungYak.byung].k}(${ELEMENT[GODS.byungYak.byung].c}) ê³¼ë‹¤<br>
                    ì•½(è—¥): ${ELEMENT[GODS.byungYak.yak].k}(${ELEMENT[GODS.byungYak.yak].c})ìœ¼ë¡œ ì œì–´
                </p>
            </div>
        `;
    }
    
    document.getElementById('gods-detail').innerHTML = godsDetailHtml;
    
    // ========== ìœ¡ì¹œ ë¶„ì„ (NEW) ==========
    const yukcheon = analyzeYukcheon(SAJU, GENDER);
    document.getElementById('yukcheon-analysis').innerHTML = `
        <div class="info-box" style="margin-bottom:10px;">
            <p style="font-size:0.85rem;color:var(--gray);">ì‚¬ì£¼ì˜ ì‹­ì‹ ìœ¼ë¡œ ê°€ì¡±, ì¸ê°„ê´€ê³„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤</p>
        </div>
        
        <!-- ìœ„ì¹˜ë³„ ìœ¡ì¹œ -->
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:15px;">
            ${yukcheon.positions.map(p => `
                <div style="padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;">
                    <p style="font-size:0.8rem;color:var(--gray);">${p.posName}</p>
                    <p style="font-weight:bold;margin:5px 0;">${p.stem.c}${p.branch.c}</p>
                    <p style="font-size:0.9rem;">ì²œê°„: <span style="color:var(--gold);">${p.stemGod}</span></p>
                    ${p.branchGod ? `<p style="font-size:0.85rem;color:var(--gray);">ì§€ì§€: ${p.branchGod}</p>` : ''}
                    <p style="font-size:0.8rem;margin-top:5px;">${p.relation}</p>
                </div>
            `).join('')}
        </div>
        
        <!-- ë°°ìš°ì ë¶„ì„ -->
        <div class="info-box ${yukcheon.spouse.count > 0 ? 'good' : 'warn'}" style="margin-bottom:10px;">
            <p><strong>ğŸ’• ë°°ìš°ì ë¶„ì„</strong></p>
            <p style="margin-top:8px;font-size:0.9rem;">
                ë°°ìš°ìì„±(${yukcheon.spouse.god}): ${yukcheon.spouse.count > 0 ? yukcheon.spouse.count + 'ê°œ' : 'ì—†ìŒ'}<br>
                ì¼ì§€ 12ìš´ì„±: ${yukcheon.spouse.dayBranch.k}
            </p>
            <p style="margin-top:5px;font-size:0.85rem;">${yukcheon.spouse.analysis}</p>
        </div>
        
        <!-- ìë…€ ë¶„ì„ -->
        <div class="info-box" style="margin-bottom:10px;">
            <p><strong>ğŸ‘¶ ìë…€ ë¶„ì„</strong></p>
            <p style="margin-top:8px;font-size:0.9rem;">
                ìë…€ì„±(${yukcheon.children.gods.join('/')}): ${yukcheon.children.count > 0 ? yukcheon.children.count.toFixed(1) + 'ê°œ' : 'ì—†ìŒ'}
            </p>
            <p style="margin-top:5px;font-size:0.85rem;">${yukcheon.children.analysis}</p>
        </div>
        
        <!-- ë¶€ëª¨ ë¶„ì„ -->
        <div class="info-box" style="margin-bottom:10px;">
            <p><strong>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ë¶€ëª¨ ë¶„ì„</strong></p>
            <p style="margin-top:8px;font-size:0.9rem;">
                ì•„ë²„ì§€(í¸ì¬): ${yukcheon.parents.father.count > 0 ? 'ìˆìŒ' : 'ì—†ìŒ'} - ${yukcheon.parents.father.analysis}<br>
                ì–´ë¨¸ë‹ˆ(ì •ì¸): ${yukcheon.parents.mother.count > 0 ? 'ìˆìŒ' : 'ì—†ìŒ'} - ${yukcheon.parents.mother.analysis}
            </p>
        </div>
        
        <!-- ìœ¡ì¹œ íŠ¹ì´ì‚¬í•­ -->
        ${yukcheon.analysis.length ? `
            <div class="info-box warn">
                <p><strong>ğŸ“Œ ìœ¡ì¹œ íŠ¹ì´ì‚¬í•­</strong></p>
                ${yukcheon.analysis.slice(0, 5).map(a => `
                    <p style="margin-top:8px;font-size:0.85rem;">
                        ${a.type === 'many' ? 'âš¡' : 'â­•'} ${a.meaning}
                    </p>
                `).join('')}
            </div>
        ` : ''}
    `;
    
    // ê²©êµ­
    const fmt = calcFormat(SAJU);
    document.getElementById('format').innerHTML = `
        <div class="info-box gold">
            <p><strong>${fmt.n}</strong></p>
            <p style="margin-top:10px;line-height:1.8;">${fmt.d}</p>
            <p style="margin-top:10px;color:var(--gold);">ğŸ’¼ <strong>ì í•© ë¶„ì•¼:</strong> ${fmt.b}</p>
        </div>`;
    
    // ì¼ì£¼ë¡ 
    const ilju = getIljuDesc(SAJU.day.s, SAJU.day.b);
    document.getElementById('ilju').innerHTML = `
        <div class="info-box">
            <p><strong style="font-size:16px;">${ilju.title}</strong></p>
            <p style="margin-top:12px;line-height:1.8;">${ilju.desc}</p>
            <div style="margin-top:15px;padding:12px;background:rgba(255,182,193,0.15);border-radius:8px;">
                <p>ğŸ’• <strong>ë°°ìš°ììš´</strong></p>
                <p style="margin-top:8px;line-height:1.6;">${ilju.spouse}</p>
            </div>
        </div>`;
    
    // ========== ê¶ìœ„(å®®ä½) ë¶„ì„ (NEW) ==========
    const gungwi = analyzeGungwi(SAJU, BIRTH_YEAR);
    document.getElementById('gungwi-analysis').innerHTML = `
        <div class="info-box" style="margin-bottom:10px;">
            <p style="font-size:0.85rem;color:var(--gray);">ì‚¬ì£¼ 4ì£¼ëŠ” ê°ê° ì¸ìƒì˜ ë‹¤ë¥¸ ì‹œê¸°ì™€ ê´€ê³„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤</p>
        </div>
        ${gungwi.map(g => `
            <div class="info-box ${g.rating === 'good' ? 'good' : g.rating === 'bad' ? 'warn' : ''}" style="margin-bottom:10px;${g.isCurrent ? 'border:2px solid var(--gold);' : ''}">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <p><strong>${g.name}</strong> <span style="color:var(--gray);font-size:0.85rem;">${g.alias}</span></p>
                    ${g.isCurrent ? '<span style="background:var(--gold);color:#000;padding:2px 8px;border-radius:10px;font-size:0.7rem;">í˜„ì¬</span>' : ''}
                </div>
                <p style="margin-top:8px;font-size:0.85rem;">
                    ğŸ“… <strong>${g.ageRange}</strong> Â· 
                    ${g.pillar ? `${g.pillar.s.c}${g.pillar.b.c}` : '-'} Â· 
                    ${g.god ? g.god.k : 'ì¼ê°„'} Â· 
                    ${g.state ? g.state.k : '-'}
                </p>
                <p style="margin-top:5px;font-size:0.85rem;color:var(--gray);">
                    ğŸ‘¤ ${GENDER === 'm' ? g.relationM : g.relationF} Â· ğŸ¦´ ${g.bodyPart}
                </p>
                <p style="margin-top:8px;line-height:1.6;">${g.analysis}</p>
            </div>
        `).join('')}
    `;
    
    // ========== 12ìš´ì„± ì™„ì „ ë¶„ì„ (NEW) ==========
    const ts = analyzeTwelveStates(SAJU);
    document.getElementById('twelve-states-full').innerHTML = `
        <div class="info-box ${ts.dominant === 'strong' ? 'good' : ts.dominant === 'weak' ? 'warn' : ''}">
            <p><strong>ğŸ“Š ê¸°ë³¸ ì—ë„ˆì§€ ìƒíƒœ</strong></p>
            <p style="margin-top:8px;">${ts.summary}</p>
        </div>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:15px 0;">
            ${ts.pillars.map(p => `
                <div style="text-align:center;padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;
                    border-bottom:3px solid ${p.energy >= 9 ? 'var(--wood)' : p.energy >= 6 ? 'var(--gold)' : p.energy >= 3 ? 'var(--earth)' : 'var(--fire)'};">
                    <div style="font-size:0.8rem;color:var(--gray);">${p.name}</div>
                    <div style="font-size:1.3rem;margin:8px 0;">${p.state.k}</div>
                    <div style="font-size:0.9rem;">âš¡ ${p.energy}/12</div>
                </div>
            `).join('')}
        </div>
        <div class="info-box">
            <p><strong>ğŸ”„ ì¸ìƒ ì—ë„ˆì§€ íë¦„</strong></p>
            <div style="margin-top:10px;">
                ${ts.lifeFlow.map(lf => `
                    <div style="display:flex;align-items:center;padding:8px;margin:5px 0;background:rgba(255,255,255,0.03);border-radius:6px;">
                        <div style="width:80px;font-size:0.8rem;color:var(--gray);">${lf.period}</div>
                        <div style="width:60px;font-weight:bold;">${lf.state}</div>
                        <div style="flex:1;font-size:0.85rem;">${lf.advice}</div>
                        <div>${'â­'.repeat(Math.ceil(lf.energy/3))}${'â˜†'.repeat(4-Math.ceil(lf.energy/3))}</div>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    // ëŒ€ìš´
    const luck = calcLuck(SAJU, BIRTH_YEAR, GENDER, GODS);
    document.getElementById('luck-timeline').innerHTML = luck.map(l => `
        <div class="luck-item ${l.isCur ? 'current' : ''} ${l.rating}">
            <div class="luck-age">${l.startAge}-${l.endAge}ì„¸</div>
            <div class="luck-pillar el-${l.s.e}">${l.s.c}${l.b.c}</div>
            <div class="luck-rating">${l.rating === 'good' ? 'ğŸ˜Š' : l.rating === 'bad' ? 'ğŸ˜°' : 'ğŸ˜'}</div>
        </div>
    `).join('');
    
    const curLuck = luck.find(l => l.isCur);
    if (curLuck) {
        document.getElementById('luck-detail').innerHTML = `<div class="info-box ${curLuck.rating === 'good' ? 'good' : curLuck.rating === 'bad' ? 'warn' : ''}"><p><strong>í˜„ì¬ ëŒ€ìš´ (${curLuck.startAge}-${curLuck.endAge}ì„¸): ${curLuck.s.c}${curLuck.b.c}</strong><br>${curLuck.rating === 'good' ? 'ì¢‹ì€ ìš´ì´ ë“¤ì–´ì˜¤ëŠ” ì‹œê¸°ì˜ˆìš”! ì ê·¹ì ìœ¼ë¡œ ì›€ì§ì´ì„¸ìš”.' : curLuck.rating === 'bad' ? 'ì¡°ì‹¬í•´ì•¼ í•  ì‹œê¸°ì˜ˆìš”. ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.' : 'í‰íƒ„í•œ ì‹œê¸°ì…ë‹ˆë‹¤. ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ì„¸ìš”.'}</p></div>`;
    }
    
    // ========== ëŒ€ìš´ êµìš´ê¸° ë¶„ì„ (NEW) ==========
    const gyoungi = analyzeGyoungi(luck, BIRTH_YEAR, new Date().getFullYear());
    document.getElementById('gyoungi-analysis').innerHTML = gyoungi.length ? `
        <div class="info-box" style="margin-bottom:10px;">
            <p style="font-size:0.85rem;color:var(--gray);">ëŒ€ìš´ì´ ë°”ë€ŒëŠ” ì‹œì ì„ ë¯¸ë¦¬ ì•Œë©´ ì¸ìƒì˜ ì „í™˜ì ì„ ì¤€ë¹„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        ${gyoungi.map(g => `
            <div class="info-box ${g.intensity === 'strong' ? 'warn' : ''} ${g.isCurrent ? 'gold' : ''}" style="margin-bottom:10px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <p><strong>ğŸ”„ ${g.transitionAge}ì„¸ êµìš´ê¸°</strong> (${g.transitionYear}ë…„)</p>
                    ${g.isCurrent ? '<span style="background:var(--gold);color:#000;padding:2px 8px;border-radius:10px;font-size:0.7rem;">í˜„ì¬ êµìš´ê¸°!</span>' : ''}
                </div>
                <p style="margin-top:10px;font-size:1.1rem;text-align:center;">
                    <span style="color:var(--gray);">${g.from}</span>
                    <span style="margin:0 10px;">â†’</span>
                    <span style="color:var(--gold);">${g.to}</span>
                </p>
                <p style="margin-top:10px;line-height:1.6;">${g.warning}</p>
                <p style="margin-top:8px;font-size:0.9rem;color:var(--gray);">ğŸ’¡ ${g.advice}</p>
            </div>
        `).join('')}
    ` : `<div class="info-box"><p style="color:var(--gray);">í˜„ì¬ ë‚˜ì´ ê¸°ì¤€ìœ¼ë¡œ ê°€ê¹Œìš´ êµìš´ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>`;
    
    // ========== 10ë…„ ìš´ì„¸ ë¯¸ë¦¬ë³´ê¸° (NEW) ==========
    const next10 = getNext10Years(SAJU, BIRTH_YEAR, GENDER, GODS);
    const ratingEmoji = {excellent:'ğŸŒŸ',good:'ğŸ˜Š',neutral:'ğŸ˜',caution:'âš ï¸',difficult:'ğŸ˜°'};
    const ratingClass = {excellent:'good',good:'good',neutral:'',caution:'warn',difficult:'warn'};
    document.getElementById('ten-years-luck').innerHTML = `
        <div style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:15px;">
            ${next10.years.map(y => `
                <div style="flex:1;min-width:60px;padding:8px;text-align:center;background:rgba(255,255,255,0.05);border-radius:8px;
                    border:1px solid ${y.rating === 'excellent' || y.rating === 'good' ? 'var(--wood)' : y.rating === 'difficult' || y.rating === 'caution' ? 'var(--fire)' : 'transparent'};">
                    <div style="font-size:0.75rem;color:var(--gray);">${y.year}</div>
                    <div style="font-size:1.1rem;">${ratingEmoji[y.rating]}</div>
                    <div style="font-size:0.7rem;color:var(--gray);">${y.age}ì„¸</div>
                </div>
            `).join('')}
        </div>
        <div class="info-box good">
            <p>ğŸŒŸ <strong>ìµœê³ ì˜ í•´: ${next10.bestYear.year}ë…„</strong> (${next10.bestYear.age}ì„¸)<br>
            ${next10.bestYear.saeun.pillar.s.c}${next10.bestYear.saeun.pillar.b.c}ë…„, ${next10.bestYear.saeun.god.k}ì˜ ê¸°ìš´</p>
        </div>
        <div class="info-box warn" style="margin-top:10px;">
            <p>âš ï¸ <strong>ì¡°ì‹¬í•  í•´: ${next10.worstYear.year}ë…„</strong> (${next10.worstYear.age}ì„¸)<br>
            ${next10.worstYear.saeun.pillar.s.c}${next10.worstYear.saeun.pillar.b.c}ë…„ - ë¬´ë¦¬í•˜ì§€ ë§ê³  ê±´ê°• ê´€ë¦¬!</p>
        </div>
    `;
    
    // ========== ì˜¬í•´ ì›”ìš´ (NEW) ==========
    const curYear = new Date().getFullYear();
    const monthlyLuck = getYearlyMonthLuck(curYear, SAJU, GODS);
    document.getElementById('monthly-luck').innerHTML = `
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:15px;">
            ${monthlyLuck.months.map(m => `
                <div style="padding:10px;text-align:center;background:rgba(255,255,255,0.05);border-radius:8px;
                    border:1px solid ${m.rating === 'good' ? 'var(--wood)' : m.rating === 'bad' ? 'var(--fire)' : 'transparent'};">
                    <div style="font-weight:bold;">${m.month}ì›”</div>
                    <div style="font-size:1.2rem;margin:5px 0;">${m.rating === 'good' ? 'ğŸ˜Š' : m.rating === 'bad' ? 'ğŸ˜°' : 'ğŸ˜'}</div>
                    <div style="font-size:0.7rem;color:var(--gray);">${m.pillar.s.c}${m.pillar.b.c}</div>
                    <div style="font-size:0.7rem;color:var(--gray);">${m.god.k}</div>
                </div>
            `).join('')}
        </div>
        <div class="info-box good">
            <p>ğŸŒŸ <strong>ìµœê³ ì˜ ë‹¬: ${monthlyLuck.best.month}ì›”</strong><br>${monthlyLuck.best.god.k}ì˜ ê¸°ìš´ìœ¼ë¡œ ì¢‹ì€ ì¼ì´ ìƒê²¨ìš”!</p>
        </div>
        <div class="info-box warn" style="margin-top:10px;">
            <p>âš ï¸ <strong>ì¡°ì‹¬í•  ë‹¬: ${monthlyLuck.worst.month}ì›”</strong><br>${monthlyLuck.worst.god.k}ì˜ ê¸°ìš´ - ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.</p>
        </div>
    `;
    
    // í•©ì¶©í˜•íŒŒí•´
    const ints = calcInteractions(SAJU);
    document.getElementById('interactions').innerHTML = ints.length ? ints.map(i => `<div class="int-item"><div class="int-type">${i.t}</div><div><div class="int-chars">${i.c}</div><div class="int-meaning">${i.m} - ${i.d}</div></div></div>`).join('') : '<p style="color:var(--gray);">ì‚¬ì£¼ ë‚´ íŠ¹ë³„í•œ í•©ì¶©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    
    // ========== ë°©í•©/ì•”í•© ë¶„ì„ (NEW) ==========
    const banghap = analyzeBanghap(SAJU);
    const amhap = analyzeAmhap(SAJU);
    document.getElementById('banghap-amhap').innerHTML = `
        <div class="info-box" style="margin-bottom:10px;">
            <p><strong>ğŸŒ€ ë°©í•©(æ–¹åˆ)</strong> - ê°™ì€ ë°©í–¥ ì§€ì§€ê°€ ëª¨ì—¬ ê°•ë ¥í•œ ì˜¤í–‰ í˜•ì„±</p>
            ${banghap.length ? banghap.map(b => `
                <div style="margin-top:10px;padding:12px;background:rgba(${b.type === 'complete' ? '76,175,80' : '255,152,0'},0.1);border-radius:8px;border-left:3px solid ${b.type === 'complete' ? 'var(--wood)' : 'var(--earth)'};">
                    <p style="font-weight:bold;color:${b.type === 'complete' ? 'var(--wood)' : 'var(--earth)'};">${b.name} (${b.branches})</p>
                    <p style="margin-top:5px;font-size:0.9rem;">${b.dir}</p>
                    <p style="margin-top:5px;font-size:0.85rem;">${b.desc}</p>
                    ${b.type === 'partial' ? `<p style="margin-top:5px;font-size:0.8rem;color:var(--gray);">ğŸ’¡ ${b.missing}(ì´)ê°€ ì˜¤ë©´ ì™„ì„±!</p>` : ''}
                </div>
            `).join('') : '<p style="margin-top:10px;color:var(--gray);font-size:0.9rem;">ë°©í•©ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
        </div>
        
        <div class="info-box">
            <p><strong>ğŸ¤« ì•”í•©(æš—åˆ)</strong> - ì§€ì¥ê°„ë¼ë¦¬ì˜ ìˆ¨ì€ í•© (ê²‰ìœ¼ë¡œ ì•ˆ ë“œëŸ¬ë‚¨)</p>
            ${amhap.length ? amhap.map(a => `
                <div style="margin-top:10px;padding:12px;background:rgba(156,39,176,0.1);border-radius:8px;border-left:3px solid #9C27B0;">
                    <p style="font-weight:bold;color:#9C27B0;">${a.name}</p>
                    <p style="margin-top:5px;font-size:0.9rem;">${a.positions}</p>
                    <p style="margin-top:5px;font-size:0.85rem;">${a.desc}</p>
                    <p style="margin-top:5px;font-size:0.8rem;color:var(--gray);">ğŸ’« ${a.meaning}</p>
                </div>
            `).join('') : '<p style="margin-top:10px;color:var(--gray);font-size:0.9rem;">ì•”í•©ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
        </div>
    `;
    
    // ========== í•©ì¶© ê³ ê¸‰ ë¶„ì„ (NEW) ==========
    const advInt = analyzeAdvancedInteractions(SAJU);
    document.getElementById('advanced-interactions').innerHTML = `
        ${advInt.hapHwa.length ? `
            <div class="info-box" style="margin-bottom:10px;">
                <p><strong>ğŸ”® ì²œê°„ í•©í™”(åˆåŒ–) ë¶„ì„</strong></p>
                ${advInt.hapHwa.map(h => `
                    <div style="margin-top:10px;padding:10px;background:rgba(255,255,255,0.05);border-radius:6px;border-left:3px solid ${h.isHwa ? 'var(--gold)' : 'var(--gray)'};">
                        <p><strong>${h.name}</strong> (${h.stems})</p>
                        <p style="font-size:0.85rem;color:${h.isHwa ? 'var(--gold)' : 'var(--gray)'};margin-top:5px;">
                            ${h.isHwa ? `âœ¨ ${h.result}ìœ¼ë¡œ í•©í™” ì„±ë¦½! ${h.reason}` : `âšª ${h.reason}`}
                        </p>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        ${advInt.samhapGuk.length ? `
            <div class="info-box" style="margin-bottom:10px;">
                <p><strong>ğŸŒ€ ì‚¼í•©êµ­(ä¸‰åˆå±€) ë¶„ì„</strong></p>
                ${advInt.samhapGuk.map(s => `
                    <div style="margin-top:10px;padding:10px;background:rgba(255,255,255,0.05);border-radius:6px;border-left:3px solid ${s.complete ? 'var(--wood)' : 'var(--earth)'};">
                        <p><strong>${s.name}</strong> â†’ ${s.result} ê¸°ìš´</p>
                        <p style="font-size:0.85rem;margin-top:5px;">${s.desc}</p>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        ${advInt.chungHaeso.length ? `
            <div class="info-box ${advInt.chungHaeso.some(c => !c.isResolved) ? 'warn' : ''}" style="margin-bottom:10px;">
                <p><strong>âš¡ ì¶©(æ²–) í•´ì†Œ ë¶„ì„</strong></p>
                ${advInt.chungHaeso.map(c => `
                    <div style="margin-top:10px;padding:10px;background:rgba(255,255,255,0.05);border-radius:6px;border-left:3px solid ${c.isResolved ? 'var(--wood)' : 'var(--fire)'};">
                        <p><strong>${c.clash}</strong></p>
                        <p style="font-size:0.85rem;color:${c.isResolved ? 'var(--wood)' : 'var(--fire)'};margin-top:5px;">${c.reason}</p>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        ${advInt.warnings.length ? `
            <div class="info-box warn">
                <p><strong>âš ï¸ íŠ¹ë³„ ì£¼ì˜ì‚¬í•­</strong></p>
                ${advInt.warnings.map(w => `
                    <div style="margin-top:10px;">
                        <p><strong>${w.type}</strong></p>
                        <p style="font-size:0.85rem;margin-top:5px;">${w.desc}</p>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        ${!advInt.hapHwa.length && !advInt.samhapGuk.length && !advInt.chungHaeso.length && !advInt.warnings.length ?
            '<p style="color:var(--gray);">íŠ¹ë³„í•œ í•©í™”ë‚˜ ì¶© ê´€ê³„ê°€ ì—†ì–´ìš”. í‰ì˜¨í•œ ì‚¬ì£¼!</p>' : ''}
    `;
    
    // ê³µë§
    const gm = calcGongmang(SAJU);
    document.getElementById('gongmang').innerHTML = `<div class="info-box"><p><strong>ê³µë§:</strong> ${gm.names.join(', ')}<br>${gm.affected.length ? `âš ï¸ ${gm.affected.join(', ')}ì— ê³µë§ì´ ìˆì–´ìš”. í•´ë‹¹ ë¶€ë¶„ì˜ ê¸°ìš´ì´ ì•½í•©ë‹ˆë‹¤.` : 'ì‚¬ì£¼ ë‚´ ê³µë§ì´ ì—†ì–´ìš”!'}</p></div>`;
    
    // ========== ê³µë§ í•´ì†Œ ë¶„ì„ (NEW) ==========
    const gmHaeso = analyzeGongmangHaeso(SAJU, gm);
    document.getElementById('gongmang-haeso').innerHTML = gmHaeso.hasGongmang ? `
        ${gmHaeso.results.map(r => `
            <div class="info-box ${r.resolved ? 'good' : 'warn'}" style="margin-bottom:10px;">
                <p><strong>${r.position} ê³µë§ (${r.branch})</strong></p>
                <p style="margin-top:8px;font-size:0.9rem;">
                    ${r.resolved ? 
                        `âœ… í•´ì†Œë¨: ${r.method}` : 
                        `âŒ í•´ì†Œë˜ì§€ ì•ŠìŒ`}
                </p>
                <p style="margin-top:5px;font-size:0.85rem;color:var(--gray);">${r.effect}</p>
            </div>
        `).join('')}
        <div class="info-box" style="margin-top:10px;">
            <p><strong>ğŸ’¡ ê³µë§ í•´ì†Œ ì¡°ê±´</strong></p>
            <p style="margin-top:8px;font-size:0.85rem;line-height:1.6;">
                1. ì¶©(æ²–)ìœ¼ë¡œ í•´ì†Œ: ê³µë§ ì§€ì§€ì˜ ë°˜ëŒ€í¸ ì§€ì§€ê°€ ìˆìœ¼ë©´ í•´ì†Œ<br>
                2. ì‚¼í•©ìœ¼ë¡œ í•´ì†Œ: ì‚¼í•©ì˜ ë‚˜ë¨¸ì§€ ë‘ ì§€ì§€ê°€ ëª¨ë‘ ìˆìœ¼ë©´ í•´ì†Œ<br>
                3. ëŒ€ìš´/ì„¸ìš´ì—ì„œ í•´ì†Œ: ìš´ì—ì„œ í•´ë‹¹ ì¡°ê±´ì´ ì¶©ì¡±ë˜ë©´ ì¼ì‹œì  í•´ì†Œ
            </p>
        </div>
    ` : '<div class="info-box"><p style="color:var(--gray);">ì‚¬ì£¼ ë‚´ ê³µë§ì´ ì—†ì–´ í•´ì†Œ ë¶„ì„ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤. ğŸ‘</p></div>';
    
    // ì‹ ì‚´
    const sinsal = calcSinsal(SAJU);
    document.getElementById('sinsal').innerHTML = sinsal.length ? sinsal.map(s => `<div class="sinsal ${s.t}"><div class="sinsal-icon">${s.i}</div><div><div class="sinsal-name">${s.n}</div><div class="sinsal-desc">${s.d}</div></div></div>`).join('') : '<p style="color:var(--gray);">íŠ¹ë³„í•œ ì‹ ì‚´ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    
    // ========== ì‹ ì‚´ ìœ„ì¹˜ë³„ ë¶„ì„ (NEW) ==========
    const sinsalPos = analyzeSinsalPosition(SAJU);
    document.getElementById('sinsal-position').innerHTML = sinsalPos.length ? `
        <div class="info-box" style="margin-bottom:10px;">
            <p style="font-size:0.85rem;color:var(--gray);">ê°™ì€ ì‹ ì‚´ë„ ì–´ëŠ ìë¦¬ì— ìˆëŠëƒì— ë”°ë¼ ì˜ë¯¸ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.</p>
        </div>
        ${sinsalPos.map(sp => `
            <div class="info-box" style="margin-bottom:10px;border-left:3px solid ${sp.sinsal.includes('ë„í™”') ? '#e91e63' : sp.sinsal.includes('ì—­ë§ˆ') ? '#ff9800' : '#9c27b0'};">
                <p><strong>${sp.sinsal}</strong> - ${sp.position}</p>
                <p style="margin-top:8px;font-size:0.9rem;">${sp.interpretation}</p>
                <p style="margin-top:5px;font-size:0.85rem;color:var(--gold);">ğŸ’¡ ${sp.advice}</p>
            </div>
        `).join('')}
    ` : '<div class="info-box"><p style="color:var(--gray);">ìœ„ì¹˜ë³„ë¡œ ë¶„ì„í•  ì£¼ìš” ì‹ ì‚´ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
    
    // AI ì¢…í•© í•´ì„
    document.getElementById('ai-interpretation').innerHTML = generateAIInterpretation(SAJU, GODS, BIRTH_YEAR, GENDER);
    
    // í†µë³€ ì´ˆê¸°í™”
    renderFortune('total');
    } catch (error) {
        console.error('ì‚¬ì£¼ ë Œë”ë§ ì˜¤ë¥˜:', error);
        toast('ê²°ê³¼ í‘œì‹œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}

function renderFortune(type) {
    const el = document.getElementById('fortune-content');
    if (!SAJU) { el.innerHTML = '<p>ë¨¼ì € ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.</p>'; return; }
    
    const str = calcStrength(SAJU);
    
    // ìƒˆ ìƒì„¸ í†µë³€ í•¨ìˆ˜ ì‚¬ìš©
    if (type === 'today') {
        el.innerHTML = genTodayFortune(SAJU, GODS);
        return;
    }
    if (type === 'year') {
        const cy = new Date().getFullYear();
        el.innerHTML = genYearFortune(SAJU, GODS, cy);
        return;
    }
    if (type === 'career') {
        el.innerHTML = genCareerFortune(SAJU, str, GODS);
        return;
    }
    if (type === 'love') {
        el.innerHTML = genLoveFortune(SAJU, str, GODS);
        return;
    }
    if (type === 'wealth') {
        el.innerHTML = genWealthFortune(SAJU, str, GODS);
        return;
    }
    if (type === 'health') {
        el.innerHTML = genHealthFortune(SAJU, str, GODS);
        return;
    }
    
    // total (ê¸°ë³¸ê°’)
    const dm = SAJU.day.s;
    const yongEl = ELEMENT[GODS.yong];
    const colorAdvice = {
        wood: { color: 'ì´ˆë¡ìƒ‰, ì²­ë¡ìƒ‰', dir: 'ë™ìª½', num: '3, 8', item: 'ë‚˜ë¬´ ì†Œí’ˆ, ì‹ë¬¼, ì±…' },
        fire: { color: 'ë¹¨ê°„ìƒ‰, ë³´ë¼ìƒ‰', dir: 'ë‚¨ìª½', num: '2, 7', item: 'ì¡°ëª…, ìº”ë“¤, ì „ìê¸°ê¸°' },
        earth: { color: 'ë…¸ë€ìƒ‰, ê°ˆìƒ‰', dir: 'ì¤‘ì•™', num: '5, 10', item: 'ë„ìê¸°, í¬ë¦¬ìŠ¤íƒˆ, ë¶€ë™ì‚°' },
        metal: { color: 'í°ìƒ‰, ê¸ˆìƒ‰, ì€ìƒ‰', dir: 'ì„œìª½', num: '4, 9', item: 'ê¸ˆì† ì•¡ì„¸ì„œë¦¬, ì‹œê³„, ìë™ì°¨' },
        water: { color: 'ê²€ì€ìƒ‰, íŒŒë€ìƒ‰', dir: 'ë¶ìª½', num: '1, 6', item: 'ìˆ˜ì¡±ê´€, ë¶„ìˆ˜, ê·¸ë¦¼' }
    };
    const yongAdvice = colorAdvice[GODS.yong];
    
    const typeDesc = {
        strong: `<strong>ğŸ”¥ ê¸°ìš´ì´ ê°•í•œ ì‚¬ì£¼!</strong><br><br>ìê¸° ì£¼ì¥ì´ í™•ì‹¤í•˜ê³  ë‚¨ì—ê²Œ íœ˜ë‘˜ë¦¬ì§€ ì•ŠëŠ” íƒ€ì…ì´ì—ìš”.<br><br><strong>ì¥ì :</strong> ë¦¬ë”ì‹­, ë¹ ë¥¸ ê²°ì •ë ¥, ë…ë¦½ì‹¬, ì¶”ì§„ë ¥<br><strong>ì£¼ì˜:</strong> ë„ˆë¬´ ê°•í•˜ë©´ "ê³ ì§‘ìŸì´"ë¡œ ë³´ì—¬ìš”. ê°€ë” ë‚¨ì˜ ë§ë„ ë“¤ì–´ì£¼ì„¸ìš”!`,
        weak: `<strong>ğŸ’§ ë¶€ë“œëŸ¬ìš´ ê¸°ìš´ì˜ ì‚¬ì£¼!</strong><br><br>í˜‘ë ¥ ì˜í•˜ê³  ì¡°í™”ë¡­ê²Œ ì§€ë‚´ëŠ” íƒ€ì…ì´ì—ìš”.<br><br><strong>ì¥ì :</strong> ëˆˆì¹˜ ë¹ ë¦„, ì ì‘ë ¥, ë°°ë ¤ì‹¬, ê·€ì¸ìš´<br><strong>ì£¼ì˜:</strong> ë„ˆë¬´ ëˆˆì¹˜ ë³´ë©´ ìê¸° ì˜ê²¬ ëª» ë§í•´ìš”. ë‹¹ë‹¹í•˜ê²Œ!`,
        balanced: `<strong>âš–ï¸ ê· í˜• ì¡íŒ ì‚¬ì£¼!</strong><br><br>ê°•í•  ë•Œ ê°•í•˜ê³ , ë¶€ë“œëŸ¬ìš¸ ë•Œ ë¶€ë“œëŸ¬ìš´ ë§ŒëŠ¥ íƒ€ì…! ì‚¬ì£¼ì—ì„œ ê°€ì¥ ì¢‹ì€ ìƒíƒœì˜ˆìš”!<br><br><strong>ì¥ì :</strong> ìƒí™© íŒë‹¨ ë¹ ë¦„, ì ì‘ë ¥ ìµœê³ , ì–´ë””ì„œë“  ì˜ ì‚´ì•„ë‚¨ì•„ìš”`
    };
    
    el.innerHTML = `
        <div class="info-box gold">
            <p><strong>ğŸ“Š ì´ìš´ ë¶„ì„</strong></p>
        </div>
        <div class="info-box" style="margin-top:12px;">
            <p style="line-height:1.8;">${typeDesc[GODS.type]}</p>
        </div>
        ${str.extreme ? `<div class="info-box warn" style="margin-top:12px;"><p><strong>âš¡ ${str.extreme} ì‚¬ì£¼!</strong><br>${str.extreme === 'ê·¹ì‹ ê°•' ? 'ê¸°ìš´ì´ ë§¤ìš° ê°•í•´ì„œ ì¢…ê²©(ì¢…ì™•ê²©, ì¢…ê°•ê²©)ì¼ ìˆ˜ ìˆì–´ìš”. ìê¸° ëœ»ëŒ€ë¡œ ì‚¬ëŠ” ê²Œ ì¢‹ì•„ìš”!' : 'ê¸°ìš´ì´ ë§¤ìš° ì•½í•´ì„œ ì¢…ê²©(ì¢…ì•„ê²©, ì¢…ì¬ê²©, ì¢…ì‚´ê²©)ì¼ ìˆ˜ ìˆì–´ìš”. ë‚¨ì„ ì˜ ë”°ë¥´ê³  í˜‘ì¡°í•˜ëŠ” ê²Œ ì¢‹ì•„ìš”!'}</p></div>` : ''}
        <div class="info-box good" style="margin-top:15px;">
            <p><strong>ğŸ¯ ìš©ì‹  í™œìš©ë²•</strong></p>
            <p style="margin-top:8px;">ìš©ì‹ ì¸ <strong>${yongEl.n}(${yongEl.k})</strong> ê¸°ìš´ì„ ê°€ê¹Œì´ í•˜ì„¸ìš”!</p>
            <ul style="margin-top:10px;margin-left:15px;line-height:1.8;">
                <li>ğŸ¨ í–‰ìš´ì˜ ìƒ‰: ${yongAdvice.color}</li>
                <li>ğŸ§­ í–‰ìš´ì˜ ë°©í–¥: ${yongAdvice.dir}</li>
                <li>ğŸ”¢ í–‰ìš´ì˜ ìˆ«ì: ${yongAdvice.num}</li>
                <li>âœ¨ í–‰ìš´ì˜ ì•„ì´í…œ: ${yongAdvice.item}</li>
            </ul>
        </div>`;
}

function getTodayFortune() {
    const today = new Date();
    const dp = calcDayPillar(today.getFullYear(), today.getMonth() + 1, today.getDate());
    const god = getTenGod(dp.s, SAJU.day.s);
    
    const isYong = [dp.s.e, dp.b.e].includes(GODS.yong);
    const isHee = [dp.s.e, dp.b.e].includes(GODS.hee);
    const isGi = [dp.s.e, dp.b.e].includes(GODS.gi);
    
    let rating, advice;
    if (isYong) {
        rating = 'âœ¨ ëŒ€ê¸¸(å¤§å‰)';
        advice = 'ì˜¤ëŠ˜ì€ ìš©ì‹ ì˜ ê¸°ìš´ì´ ê°•í•˜ê²Œ ë“¤ì–´ì˜¤ëŠ” ë‚ ! ì¤‘ìš”í•œ ì¼ì„ ì¶”ì§„í•˜ì„¸ìš”. ì ê·¹ì ìœ¼ë¡œ ì›€ì§ì´ë©´ ì¢‹ì€ ê²°ê³¼ê°€ ìˆìŠµë‹ˆë‹¤.';
    } else if (isHee) {
        rating = 'ğŸ˜Š ê¸¸(å‰)';
        advice = 'í¬ì‹ ì˜ ê¸°ìš´ì´ ë„ì™€ì£¼ëŠ” ë‚ ì…ë‹ˆë‹¤. ê³„íší•œ ì¼ë“¤ì´ ìˆœì¡°ë¡­ê²Œ ì§„í–‰ë©ë‹ˆë‹¤. ìƒˆë¡œìš´ ì‹œë„ë„ ì¢‹ìŠµë‹ˆë‹¤.';
    } else if (isGi) {
        rating = 'âš ï¸ ì¡°ì‹¬';
        advice = 'ê¸°ì‹ ì˜ ê¸°ìš´ì´ ê°•í•œ ë‚ ì´ë‹ˆ ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”. ì¤‘ìš”í•œ ê²°ì •ì€ ë¯¸ë£¨ê³ , ê¸°ì¡´ì— í•˜ë˜ ì¼ì— ì§‘ì¤‘í•˜ì„¸ìš”.';
    } else {
        rating = 'ğŸ˜ í‰ì˜¨';
        advice = 'í‰ë²”í•œ í•˜ë£¨ì…ë‹ˆë‹¤. ê¾¸ì¤€íˆ ì¼ìƒì„ ìœ ì§€í•˜ë©´ì„œ ì‘ì€ í–‰ë³µì„ ì°¾ìœ¼ì„¸ìš”.';
    }
    
    return `<div class="info-box">
        <p><strong>ğŸ“… ì˜¤ëŠ˜ì˜ ìš´ì„¸</strong> <span style="color:var(--gold);">(${dp.s.c}${dp.b.c}ì¼)</span></p>
        <div style="margin-top:12px;text-align:center;font-size:18px;">${rating}</div>
        <p style="margin-top:12px;line-height:1.8;">
            ì˜¤ëŠ˜ì˜ ì¼ì§„: <strong>${dp.s.c}${dp.b.c}</strong> (${ELEMENT[dp.s.e].k}${ELEMENT[dp.b.e].k})<br>
            ì˜¤ëŠ˜ì˜ ì‹­ì‹ : <strong>${god.k}</strong> - ${god.d}
        </p>
        <div style="margin-top:15px;padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;">
            <p><strong>ğŸ’¡ ì˜¤ëŠ˜ì˜ ì¡°ì–¸</strong></p>
            <p style="margin-top:8px;line-height:1.6;">${advice}</p>
        </div>
    </div>`;
}

function getYearFortune() {
    const cy = new Date().getFullYear();
    const yp = calcYearPillar(cy, 6, 1);
    const god = getTenGod(yp.s, SAJU.day.s);
    
    const isYong = [yp.s.e, yp.b.e].includes(GODS.yong);
    const isHee = [yp.s.e, yp.b.e].includes(GODS.hee);
    const isGi = [yp.s.e, yp.b.e].includes(GODS.gi);
    
    let rating, advice;
    if (isYong) {
        rating = 'ğŸŒŸ ëŒ€ê¸¸ë…„(å¤§å‰å¹´)';
        advice = 'ì˜¬í•´ëŠ” ìš©ì‹ ì˜ í•´! 10ë…„ì— í•œ ë²ˆ ì˜¤ëŠ” ê¸°íšŒì˜ í•´ì…ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ ë„ì „í•˜ê³  í™•ì¥í•˜ì„¸ìš”. ì´ì§, ì°½ì—…, ê²°í˜¼ ë“± í° ê²°ì •ì— ì¢‹ìŠµë‹ˆë‹¤.';
    } else if (isHee) {
        rating = 'ğŸ˜Š ê¸¸ë…„(å‰å¹´)';
        advice = 'í¬ì‹ ì˜ ê¸°ìš´ì´ ë„ì™€ì£¼ëŠ” í•´ì…ë‹ˆë‹¤. í•˜ëŠ” ì¼ì´ ìˆœì¡°ë¡­ê³  ì£¼ë³€ì˜ ë„ì›€ì„ ë°›ê¸° ì‰½ìŠµë‹ˆë‹¤. ì¸ë§¥ì„ ë„“íˆê³  ë°°ì›€ì— íˆ¬ìí•˜ì„¸ìš”.';
    } else if (isGi) {
        rating = 'âš ï¸ ì¡°ì‹¬í•´ì•¼ í•  í•´';
        advice = 'ê¸°ì‹ ì˜ í•´ì´ë‹ˆ ë¬´ë¦¬í•œ í™•ì¥ì´ë‚˜ íˆ¬ìëŠ” í”¼í•˜ì„¸ìš”. ê±´ê°• ê´€ë¦¬ì— ì‹ ê²½ ì“°ê³ , ì•ˆì •ì„ ìœ ì§€í•˜ë©´ì„œ ë‚´ì‹¤ì„ ë‹¤ì§€ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.';
    } else {
        rating = 'ğŸ˜ í‰ë…„(å¹³å¹´)';
        advice = 'í° ë³€í™” ì—†ì´ í‰íƒ„í•œ í•´ì…ë‹ˆë‹¤. ë¬µë¬µíˆ ìê¸° ì¼ì— ì¶©ì‹¤í•˜ë©´ì„œ ë‹¤ìŒ ê¸°íšŒë¥¼ ì¤€ë¹„í•˜ì„¸ìš”.';
    }
    
    return `<div class="info-box">
        <p><strong>ğŸ“† ${cy}ë…„ ìš´ì„¸</strong> <span style="color:var(--gold);">(${yp.s.c}${yp.b.c}ë…„)</span></p>
        <div style="margin-top:12px;text-align:center;font-size:18px;">${rating}</div>
        <p style="margin-top:12px;line-height:1.8;">
            ì˜¬í•´ì˜ ì„¸ìš´: <strong>${yp.s.c}${yp.b.c}</strong> (${ELEMENT[yp.s.e].k}${ELEMENT[yp.b.e].k})<br>
            ì˜¬í•´ì˜ ì‹­ì‹ : <strong>${god.k}</strong> - ${god.d}
        </p>
        <div style="margin-top:15px;padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;">
            <p><strong>ğŸ’¡ ì˜¬í•´ì˜ ì¡°ì–¸</strong></p>
            <p style="margin-top:8px;line-height:1.6;">${advice}</p>
        </div>
        <div style="margin-top:12px;padding:12px;background:rgba(253,216,53,0.1);border-radius:8px;">
            <p><strong>ğŸ“… ì˜¬í•´ ì¢‹ì€ ë‹¬</strong></p>
            <p style="margin-top:8px;">ìš©ì‹ (${ELEMENT[GODS.yong].k})ì´ ê°•í•œ ë‹¬: ${getGoodMonths()}</p>
        </div>
    </div>`;
}

function getGoodMonths() {
    const monthElements = ['water','water','wood','wood','earth','fire','fire','earth','metal','metal','earth','water'];
    const goodMonths = [];
    monthElements.forEach((el, i) => {
        if (el === GODS.yong || el === GODS.hee) goodMonths.push((i + 1) + 'ì›”');
    });
    return goodMonths.length ? goodMonths.join(', ') : 'ìƒë°˜ê¸°ë³´ë‹¤ í•˜ë°˜ê¸°ê°€ ì¢‹ìŠµë‹ˆë‹¤';
}

/* ========================================
   AI ì¢…í•© í•´ì„ ì—”ì§„
   ======================================== */
function generateAIInterpretation(saju, gods, birthYear, gender) {
    const dm = saju.day.s;
    const str = calcStrength(saju);
    const currentYear = new Date().getFullYear();
    const age = currentYear - birthYear + 1;
    
    // ì—¬ëŸ¬ ë¶„ì„ ê²°ê³¼ ìˆ˜ì§‘
    const interactions = calcInteractions(saju);
    const format = calcFormat(saju);
    const sinsal = calcSinsal(saju);
    const gongmang = calcGongmang(saju);
    const luck = calcLuck(saju, birthYear, gender, gods);
    const curLuck = luck.find(l => l.isCur);
    
    // ì˜¤í–‰ ë¶„í¬ ë¶„ì„
    const elCount = {wood:0, fire:0, earth:0, metal:0, water:0};
    [saju.year, saju.month, saju.day, saju.hour].forEach(p => {
        if(p && p.s) elCount[p.s.e]++;
        if(p && p.b) elCount[p.b.e]++;
    });
    
    // ê°€ì¥ ê°•í•œ/ì•½í•œ ì˜¤í–‰
    const maxEl = Object.entries(elCount).reduce((a,b) => b[1] > a[1] ? b : a);
    const minEl = Object.entries(elCount).filter(e => e[1] === 0);
    
    // í•©ì¶© ë¶„ì„
    const hasGoodHap = interactions.some(i => i.t.includes('í•©'));
    const hasBadChung = interactions.some(i => i.t.includes('ì¶©'));
    
    // ê¸¸ì‹ /í‰ì‹  ë¶„ë¥˜
    const goodSinsal = sinsal.filter(s => s.t === 'good');
    const badSinsal = sinsal.filter(s => s.t === 'bad');
    
    // ========== í•µì‹¬ ë©”ì‹œì§€ ìƒì„± ==========
    let coreMessage = '';
    let priority = [];
    
    // 1. ì‹ ê°•/ì‹ ì•½ ê¸°ë³¸ ì„±í–¥
    const dmName = `${dm.k}${ELEMENT[dm.e].k}`; // ê¸°í† , ê°‘ëª© ë“±
    const dmHanja = `${dm.c}${ELEMENT[dm.e].c}`; // å·±åœŸ, ç”²æœ¨ ë“±
    
    if (str.type === 'strong') {
        coreMessage = `<strong>${dmName}(${dmHanja})</strong> ì¼ê°„ì´ ${str.pct}%ë¡œ <span style="color:var(--fire);">ì‹ ê°•(èº«å¼º)</span>í•œ ì‚¬ì£¼ì…ë‹ˆë‹¤. ìì‹ ì˜ ì˜ì§€ê°€ ê°•í•˜ê³  ì£¼ë„ì ìœ¼ë¡œ ì‚´ì•„ê°€ëŠ” íƒ€ì…ì´ì—ìš”.`;
        priority.push('ìì‹ ë§Œì˜ ê¸¸ì„ ê°œì²™í•˜ëŠ” ê²ƒì´ ìœ ë¦¬');
    } else if (str.type === 'weak') {
        coreMessage = `<strong>${dmName}(${dmHanja})</strong> ì¼ê°„ì´ ${str.pct}%ë¡œ <span style="color:var(--water);">ì‹ ì•½(èº«å¼±)</span>í•œ ì‚¬ì£¼ì…ë‹ˆë‹¤. í˜‘ë ¥ê³¼ ì¡°í™”ë¥¼ í†µí•´ ë¹›ë‚˜ëŠ” íƒ€ì…ì´ì—ìš”.`;
        priority.push('ì¢‹ì€ íŒŒíŠ¸ë„ˆì™€ í•¨ê»˜í•˜ëŠ” ê²ƒì´ ì¤‘ìš”');
    } else {
        coreMessage = `<strong>${dmName}(${dmHanja})</strong> ì¼ê°„ì´ ${str.pct}%ë¡œ <span style="color:var(--gold);">ê· í˜• ì¡íŒ</span> ì‚¬ì£¼ì…ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆì–´ìš”.`;
        priority.push('ì–´ë–¤ í™˜ê²½ì—ì„œë“  ì ì‘ ê°€ëŠ¥');
    }
    
    // 2. ìƒì¶© ìš”ì†Œ ìš°ì„ ìˆœìœ„ íŒë‹¨
    let conflictAnalysis = [];
    
    // ì¶©ì´ ìˆì§€ë§Œ í•©ìœ¼ë¡œ í•´ì†Œë˜ëŠ” ê²½ìš°
    if (hasBadChung && hasGoodHap) {
        conflictAnalysis.push({
            type: 'resolved',
            msg: 'ì‚¬ì£¼ì— ì¶©(æ²–)ì´ ìˆì§€ë§Œ í•©(åˆ)ì´ í•¨ê»˜ ìˆì–´ ê·¸ ì˜í–¥ì´ ì™„í™”ë©ë‹ˆë‹¤. ê°ˆë“± í›„ í™”í•´í•˜ëŠ” íŒ¨í„´ì´ ìˆì–´ìš”.'
        });
    } else if (hasBadChung) {
        conflictAnalysis.push({
            type: 'caution',
            msg: 'ì‚¬ì£¼ì— ì¶©(æ²–)ì´ ìˆì–´ ë³€í™”ì™€ ê°ˆë“±ì´ ë§ì„ ìˆ˜ ìˆì–´ìš”. í•˜ì§€ë§Œ ì´ëŠ” ì„±ì¥ì˜ ê¸°íšŒê°€ ë˜ê¸°ë„ í•©ë‹ˆë‹¤.'
        });
    }
    
    // ì˜¤í–‰ ë¶ˆê· í˜•
    if (minEl.length >= 2) {
        conflictAnalysis.push({
            type: 'missing',
            msg: `${minEl.map(e => ELEMENT[e[0]].k).join(', ')} ì˜¤í–‰ì´ ì—†ì–´ í•´ë‹¹ ê¸°ìš´ì„ ë³´ì™„í•˜ë©´ ì¢‹ì•„ìš”. ìš©ì‹ (${ELEMENT[gods.yong].k})ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì™„ë©ë‹ˆë‹¤.`
        });
    }
    
    // ê·¹ë‹¨ì  ì‚¬ì£¼
    if (str.extreme) {
        conflictAnalysis.push({
            type: 'extreme',
            msg: `${str.extreme} ì‚¬ì£¼ë¡œ, ì¼ë°˜ì ì¸ í•´ì„ë³´ë‹¤ ì¢…ê²©(å¾æ ¼)ìœ¼ë¡œ ë³´ëŠ” ê²ƒì´ ë” ë§ì„ ìˆ˜ ìˆì–´ìš”. ${str.extreme === 'ê·¹ì‹ ê°•' ? 'ìê¸° ëœ»ëŒ€ë¡œ ë°€ê³  ë‚˜ê°€ëŠ” ê²Œ ì˜¤íˆë ¤ ì¢‹ì•„ìš”.' : 'í˜‘ë ¥í•˜ê³  ë§¡ê¸°ëŠ” ê²Œ ì„±ê³µì˜ ì—´ì‡ ì…ë‹ˆë‹¤.'}`
        });
    }
    
    // 3. í˜„ì¬ ì‹œê¸°ë³„ ë§ì¶¤ ê°€ì´ë“œ
    let timingGuide = '';
    const yearPillar = calcYearPillar(currentYear, 6, 1);
    const isYongYear = [yearPillar.s.e, yearPillar.b.e].includes(gods.yong);
    const isGiYear = [yearPillar.s.e, yearPillar.b.e].includes(gods.gi);
    
    if (curLuck) {
        const isGoodLuck = curLuck.rating === 'good';
        const luckEl = ELEMENT[curLuck.s.e].k;
        
        if (isGoodLuck && isYongYear) {
            timingGuide = `ğŸŒŸ <strong>ì§€ê¸ˆì´ ìµœê³ ì˜ ì‹œê¸°!</strong><br>ëŒ€ìš´ê³¼ ì˜¬í•´ ìš´ì´ ëª¨ë‘ ì¢‹ìŠµë‹ˆë‹¤. ${curLuck.startAge}~${curLuck.endAge}ì„¸ ëŒ€ìš´(${curLuck.s.c}${curLuck.b.c})ì—ì„œ ${luckEl} ê¸°ìš´ì´ ë„ì™€ì£¼ê³ , ${currentYear}ë…„ë„ ìš©ì‹ ì˜ í•´ì˜ˆìš”. <span style="color:var(--gold);">ì ê·¹ì ìœ¼ë¡œ ë„ì „í•˜ì„¸ìš”!</span>`;
        } else if (isGoodLuck && isGiYear) {
            timingGuide = `âš–ï¸ <strong>ê¸°íšŒì™€ ì‹œí—˜ì´ ê³µì¡´</strong><br>ëŒ€ìš´ì€ ì¢‹ì§€ë§Œ ì˜¬í•´ëŠ” ê¸°ì‹ ì˜ í•´ì…ë‹ˆë‹¤. í° í‹€ì—ì„œëŠ” ìƒìŠ¹ ì¤‘ì´ë‹ˆ ë‹¹ì¥ì˜ ì–´ë ¤ì›€ì— í”ë“¤ë¦¬ì§€ ë§ˆì„¸ìš”. <span style="color:var(--earth);">ë‚´ë…„ì„ ìœ„í•œ ê¸°ë°˜ì„ ë‹¤ì§€ì„¸ìš”.</span>`;
        } else if (!isGoodLuck && isYongYear) {
            timingGuide = `ğŸ’« <strong>ë°˜ì „ì˜ í•´!</strong><br>ëŒ€ìš´ì´ ì•½í•œ ì‹œê¸°ì§€ë§Œ ì˜¬í•´ëŠ” ìš©ì‹ ì˜ í•´ì…ë‹ˆë‹¤. ì´ ê¸°íšŒë¥¼ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”! <span style="color:var(--gold);">ì§€ê¸ˆ ì›€ì§ì´ë©´ ì¢‹ì€ ê²°ê³¼ê°€ ìˆì–´ìš”.</span>`;
        } else if (!isGoodLuck && isGiYear) {
            timingGuide = `ğŸ›¡ï¸ <strong>ì¸ë‚´ì˜ ì‹œê¸°</strong><br>ëŒ€ìš´ê³¼ ì„¸ìš´ ëª¨ë‘ ì¡°ì‹¬í•´ì•¼ í•  ë•Œì…ë‹ˆë‹¤. ë¬´ë¦¬í•œ í™•ì¥ë³´ë‹¤ <span style="color:var(--water);">ë‚´ì‹¤ì„ ë‹¤ì§€ê³  ê±´ê°•ì„ ì±™ê¸°ì„¸ìš”.</span> ê³§ ì¢‹ì€ ìš´ì´ ì˜µë‹ˆë‹¤.`;
        } else {
            timingGuide = `ğŸ˜Š <strong>í‰ì˜¨í•œ íë¦„</strong><br>${curLuck.startAge}~${curLuck.endAge}ì„¸ ëŒ€ìš´(${curLuck.s.c}${curLuck.b.c})ì„ ë³´ë‚´ê³  ìˆì–´ìš”. ê¾¸ì¤€í•¨ì´ ë‹µì…ë‹ˆë‹¤.`;
        }
    }
    
    // 4. ê°œì¸í™”ëœ êµ¬ì²´ì  ì¡°ì–¸
    let personalAdvice = [];
    
    // ë‚˜ì´ëŒ€ë³„ ì¡°ì–¸
    if (age < 30) {
        personalAdvice.push({icon:'ğŸ“š', title:'20ëŒ€ ì¡°ì–¸', msg:`${ELEMENT[gods.yong].k} ê´€ë ¨ ë¶„ì•¼ë¥¼ ê³µë¶€í•˜ê±°ë‚˜ ê²½í—˜í•˜ì„¸ìš”. í‰ìƒì˜ ìì‚°ì´ ë©ë‹ˆë‹¤.`});
    } else if (age < 40) {
        personalAdvice.push({icon:'ğŸš€', title:'30ëŒ€ ì¡°ì–¸', msg:`ì§€ê¸ˆ ìŒ“ëŠ” ê²ƒë“¤ì´ 40ëŒ€ì˜ ì—´ë§¤ê°€ ë©ë‹ˆë‹¤. ${format.b.split(',')[0]} ë¶„ì•¼ì—ì„œ ì „ë¬¸ì„±ì„ í‚¤ìš°ì„¸ìš”.`});
    } else if (age < 50) {
        personalAdvice.push({icon:'ğŸ¯', title:'40ëŒ€ ì¡°ì–¸', msg:'ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë¦¬ë”ì‹­ì„ ë°œíœ˜í•  ë•Œì…ë‹ˆë‹¤. í›„ë°° ì–‘ì„±ë„ ì¢‹ì•„ìš”.'});
    } else {
        personalAdvice.push({icon:'ğŸŒ³', title:'ì¸ìƒ í›„ë°˜ ì¡°ì–¸', msg:'ì§€í˜œë¥¼ ë‚˜ëˆ„ê³  ê±´ê°•ì„ ì±™ê¸°ì„¸ìš”. ì •ì‹ ì  í’ìš”ê°€ ì§„ì •í•œ í–‰ë³µì…ë‹ˆë‹¤.'});
    }
    
    // ìš©ì‹  ê¸°ë°˜ êµ¬ì²´ì  í–‰ë™ ì¡°ì–¸
    const yongAdvice = {
        wood: {actions:['ë™ìª½ìœ¼ë¡œ ì´ì‚¬/ì—¬í–‰', 'ì•„ì¹¨ ìš´ë™', 'ì´ˆë¡ìƒ‰ ì¸í…Œë¦¬ì–´', 'ë…ì„œ/ê³µë¶€', 'ìƒˆë¡œìš´ ì‹œì‘'], avoid:'ê³¼ë„í•œ ê²½ìŸ, ê¸ˆì† ì¸í…Œë¦¬ì–´'},
        fire: {actions:['ë‚¨ìª½ ë°©í–¥', 'ì‚¬ëŒ ë§ì€ ê³³', 'ë¹¨ê°„ìƒ‰ í¬ì¸íŠ¸', 'SNS í™œë™', 'ë°œí‘œ/ê°•ì—°'], avoid:'ì–´ë‘ìš´ í™˜ê²½, í˜¼ì ìˆê¸°'},
        earth: {actions:['ì¤‘ì‹¬ë¶€ ìœ„ì¹˜', 'ë¶€ë™ì‚° ê´€ì‹¬', 'ë…¸ë€ìƒ‰/ê°ˆìƒ‰', 'ì‹ ë¢° ìŒ“ê¸°', 'ì•ˆì •ì  íˆ¬ì'], avoid:'ì¦ì€ ì´ì‚¬, ê¸‰í•œ ë³€í™”'},
        metal: {actions:['ì„œìª½ ë°©í–¥', 'ê¸ˆìœµ/íˆ¬ì', 'í°ìƒ‰/ê¸ˆìƒ‰', 'ì›ì¹™ ì„¸ìš°ê¸°', 'ì •ë¦¬ì •ëˆ'], avoid:'ìš°ìœ ë¶€ë‹¨í•¨, ì–´ìˆ˜ì„ í•œ í™˜ê²½'},
        water: {actions:['ë¶ìª½ ë°©í–¥', 'ìœ ì—°í•œ ì‚¬ê³ ', 'ê²€ì€ìƒ‰/íŒŒë€ìƒ‰', 'ë„¤íŠ¸ì›Œí‚¹', 'ì—¬í–‰'], avoid:'ê³ ì§‘, í•œ ê³³ì— ë¨¸ë¬´ë¥´ê¸°'}
    };
    
    const yongAction = yongAdvice[gods.yong];
    personalAdvice.push({
        icon:'âœ¨',
        title:`ìš©ì‹ (${ELEMENT[gods.yong].k}) í™œìš©ë²•`,
        msg:`ì¶”ì²œ: ${yongAction.actions.slice(0,3).join(', ')}<br>í”¼í•´ì•¼ í•  ê²ƒ: ${yongAction.avoid}`
    });
    
    // ê²©êµ­ ê¸°ë°˜ ì¡°ì–¸
    personalAdvice.push({
        icon:'ğŸ’¼',
        title:'ì ì„± ë¶„ì•¼',
        msg:`${format.n}ì— ë§ëŠ” ë¶„ì•¼: ${format.b}`
    });
    
    // ê¸¸ì‹ ì´ ìˆìœ¼ë©´ ê°•ì¡°
    if (goodSinsal.length > 0) {
        personalAdvice.push({
            icon:'ğŸŒŸ',
            title:'ê¸¸ì‹  í™œìš©',
            msg:`${goodSinsal.map(s => s.n).join(', ')}ì´ ìˆì–´ìš”. ì´ ê¸°ìš´ì„ ë¯¿ê³  ë„ì „í•˜ì„¸ìš”!`
        });
    }
    
    // ========== HTML ìƒì„± ==========
    let html = `
        <div style="padding:15px;background:linear-gradient(135deg,rgba(156,39,176,0.1),rgba(103,58,183,0.05));border-radius:12px;margin-bottom:15px;">
            <p style="font-size:0.85rem;color:var(--gray);margin-bottom:10px;">ğŸ§  AIê°€ ë‹¹ì‹ ì˜ ì‚¬ì£¼ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í–ˆìŠµë‹ˆë‹¤</p>
            <p style="line-height:1.8;font-size:1rem;">${coreMessage}</p>
        </div>
    `;
    
    // ìƒì¶© ìš”ì†Œ ë¶„ì„
    if (conflictAnalysis.length > 0) {
        html += `
            <div class="info-box ${conflictAnalysis.some(c => c.type === 'caution' || c.type === 'extreme') ? 'warn' : ''}" style="margin-bottom:15px;">
                <p style="margin-bottom:10px;"><strong>âš–ï¸ ìƒì¶© ìš”ì†Œ ë¶„ì„</strong></p>
                ${conflictAnalysis.map(c => `
                    <div style="padding:10px;margin:8px 0;background:rgba(255,255,255,0.05);border-radius:8px;border-left:3px solid ${c.type === 'caution' ? 'var(--fire)' : c.type === 'resolved' ? 'var(--wood)' : 'var(--gold)'};">
                        <p style="font-size:0.9rem;line-height:1.6;">${c.msg}</p>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    // ì‹œê¸°ë³„ ê°€ì´ë“œ
    html += `
        <div class="info-box gold" style="margin-bottom:15px;">
            <p style="margin-bottom:10px;"><strong>ğŸ“… ì§€ê¸ˆ ì´ ì‹œê¸° ê°€ì´ë“œ (${currentYear}ë…„, ${age}ì„¸)</strong></p>
            <p style="line-height:1.8;font-size:0.95rem;">${timingGuide}</p>
        </div>
    `;
    
    // ê°œì¸í™”ëœ ì¡°ì–¸
    html += `
        <div class="info-box" style="margin-bottom:15px;">
            <p style="margin-bottom:12px;"><strong>ğŸ’¡ ë§ì¶¤ ì¡°ì–¸</strong></p>
            ${personalAdvice.map(a => `
                <div style="padding:12px;margin:8px 0;background:rgba(255,255,255,0.05);border-radius:8px;">
                    <p style="font-weight:bold;margin-bottom:5px;">${a.icon} ${a.title}</p>
                    <p style="font-size:0.9rem;line-height:1.6;color:var(--gray);">${a.msg}</p>
                </div>
            `).join('')}
        </div>
    `;
    
    // í•µì‹¬ ìš°ì„ ìˆœìœ„
    if (priority.length > 0) {
        html += `
            <div style="padding:15px;background:linear-gradient(135deg,var(--gold),var(--gold-dark));border-radius:12px;color:var(--red-dark);text-align:center;">
                <p style="font-weight:bold;font-size:1.1rem;">ğŸ¯ í•µì‹¬ ë©”ì‹œì§€</p>
                <p style="margin-top:8px;font-size:0.95rem;">"${priority[0]}"</p>
            </div>
        `;
    }
    
    return html;
}

function showTodayFortune() {
    const el = document.getElementById('today-fortune');
    el.style.display = 'block';
    document.getElementById('today-fortune-content').innerHTML = getTodayFortune();
}

/* ========================================
   AI í•´ì„ìš© ë³µì‚¬ ê¸°ëŠ¥
   ======================================== */
function copySajuForAI() {
    if (!SAJU) { toast('ë¨¼ì € ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”'); return; }
    
    try {
        const str = calcStrength(SAJU);
        const dm = SAJU.day.s;
        const format = calcFormat(SAJU);
        const interactions = calcInteractions(SAJU) || [];
        const sinsal = calcSinsal(SAJU) || [];
        const gongmang = calcGongmang(SAJU);
        const luck = calcLuck(SAJU, BIRTH_YEAR, GENDER, GODS) || [];
        const curLuck = luck.find(l => l.isCur);
        const currentYear = new Date().getFullYear();
        const age = currentYear - BIRTH_YEAR + 1;
        const ilju = getIljuDesc(SAJU.day.s, SAJU.day.b);
        
        // ì˜¤í–‰ ë¶„í¬ ê³„ì‚°
        const elCount = {wood:0, fire:0, earth:0, metal:0, water:0};
        [SAJU.year, SAJU.month, SAJU.day, SAJU.hour].forEach(p => {
            if(p && p.s) elCount[p.s.e]++;
            if(p && p.b) elCount[p.b.e]++;
        });
        
        // ì‹­ì‹  ê³„ì‚°
        const yearGod = getTenGod(SAJU.year.s, dm);
        const monthGod = getTenGod(SAJU.month.s, dm);
        const hourGod = SAJU.hour ? getTenGod(SAJU.hour.s, dm) : null;
        
        // 12ìš´ì„± ê³„ì‚°
        const yearState = getTwelveState(dm, SAJU.year.b);
        const monthState = getTwelveState(dm, SAJU.month.b);
        const dayState = getTwelveState(dm, SAJU.day.b);
        const hourState = SAJU.hour ? getTwelveState(dm, SAJU.hour.b) : null;
        
        // ì§€ì¥ê°„ ë¶„ì„ (ì•ˆì „í•˜ê²Œ)
        let jjText = '';
        try {
            const jjAnalysis = analyzeJijanggan(SAJU);
            if (jjAnalysis && jjAnalysis.pillars) {
                jjText = `â€¢ ë…„ì§€ ${SAJU.year.b.c}: ${jjAnalysis.pillars[0]?.hidden?.map(h => h.stem.c + '(' + h.stem.k + ',' + h.type + ',' + h.god.k + ')').join(', ') || '-'}
â€¢ ì›”ì§€ ${SAJU.month.b.c}: ${jjAnalysis.pillars[1]?.hidden?.map(h => h.stem.c + '(' + h.stem.k + ',' + h.type + ',' + h.god.k + ')').join(', ') || '-'}
â€¢ ì¼ì§€ ${SAJU.day.b.c}: ${jjAnalysis.pillars[2]?.hidden?.map(h => h.stem.c + '(' + h.stem.k + ',' + h.type + ',' + h.god.k + ')').join(', ') || '-'}`;
                if (SAJU.hour && jjAnalysis.pillars[3]) {
                    jjText += `\nâ€¢ ì‹œì§€ ${SAJU.hour.b.c}: ${jjAnalysis.pillars[3]?.hidden?.map(h => h.stem.c + '(' + h.stem.k + ',' + h.type + ',' + h.god.k + ')').join(', ') || '-'}`;
                }
            }
        } catch(e) { jjText = 'â€¢ ì§€ì¥ê°„ ë¶„ì„ ë°ì´í„° ì—†ìŒ'; }
        
        // í†µê·¼/íˆ¬ê°„ ë¶„ì„ (ì•ˆì „í•˜ê²Œ)
        let ttText = '';
        try {
            const ttAnalysis = analyzeTonggeunTougan(SAJU);
            const tgText = ttAnalysis?.tonggeun?.length ? 
                ttAnalysis.tonggeun.map(t => t.stem + 'ì´ ' + (t.roots?.map(r => r.pillar + r.branch).join(',') || '')).join('; ') : 'í†µê·¼ ì—†ìŒ';
            const tuText = ttAnalysis?.tougan?.length ? 
                ttAnalysis.tougan.map(t => t.stem + '(' + t.god + ')').join(', ') : 'íˆ¬ê°„ ì—†ìŒ';
            ttText = `â€¢ í†µê·¼: ${tgText}\nâ€¢ íˆ¬ê°„: ${tuText}`;
        } catch(e) { ttText = 'â€¢ í†µê·¼/íˆ¬ê°„ ë¶„ì„ ë°ì´í„° ì—†ìŒ'; }
        
        // ìœ¡ì¹œ ë¶„ì„ (ì•ˆì „í•˜ê²Œ)
        let ycText = '';
        try {
            const yukcheon = analyzeYukcheon(SAJU, GENDER);
            if (yukcheon) {
                ycText = `â€¢ ë°°ìš°ìì„±(${yukcheon.spouse?.god || '-'}): ${yukcheon.spouse?.count > 0 ? yukcheon.spouse.count + 'ê°œ ìˆìŒ' : 'ì—†ìŒ'} - ${yukcheon.spouse?.analysis || '-'}
â€¢ ìë…€ì„±(${yukcheon.children?.gods?.join('/') || '-'}): ${yukcheon.children?.count > 0 ? 'ìˆìŒ' : 'ì—†ìŒ'} - ${yukcheon.children?.analysis || '-'}
â€¢ ë¶€ì¹œ(í¸ì¬): ${yukcheon.parents?.father?.analysis || '-'}
â€¢ ëª¨ì¹œ(ì •ì¸): ${yukcheon.parents?.mother?.analysis || '-'}`;
            }
        } catch(e) { ycText = 'â€¢ ìœ¡ì¹œ ë¶„ì„ ë°ì´í„° ì—†ìŒ'; }
        
        // ê¶ìœ„ ë¶„ì„ (ì•ˆì „í•˜ê²Œ)
        let gwText = '';
        try {
            const gungwi = analyzeGungwi(SAJU, BIRTH_YEAR);
            if (gungwi && Array.isArray(gungwi)) {
                gwText = gungwi.map(g => 'â€¢ ' + g.name + '(' + g.ageRange + '): ' + (g.analysis?.substring(0, 50) || '') + '...' + (g.isCurrent ? ' â—€ í˜„ì¬' : '')).join('\n');
            }
        } catch(e) { gwText = 'â€¢ ê¶ìœ„ ë¶„ì„ ë°ì´í„° ì—†ìŒ'; }
        
        // 10ë…„ ìš´ì„¸ (ì•ˆì „í•˜ê²Œ)
        let next10Text = '';
        try {
            const next10 = getNext10Years(SAJU, BIRTH_YEAR, GENDER, GODS);
            if (next10) {
                next10Text = `â€¢ ìµœê³ ì˜ í•´: ${next10.bestYear?.year || '-'}ë…„ (${next10.bestYear?.age || '-'}ì„¸)
â€¢ ì¡°ì‹¬í•  í•´: ${next10.worstYear?.year || '-'}ë…„ (${next10.worstYear?.age || '-'}ì„¸)`;
            }
        } catch(e) { next10Text = 'â€¢ 10ë…„ ìš´ì„¸ ë°ì´í„° ì—†ìŒ'; }
        
        // ì˜¬í•´ ì›”ìš´ (ì•ˆì „í•˜ê²Œ)
        let monthText = '';
        try {
            const monthlyLuck = getYearlyMonthLuck(currentYear, SAJU, GODS);
            if (monthlyLuck) {
                monthText = `â€¢ ì¢‹ì€ ë‹¬: ${monthlyLuck.best?.month || '-'}ì›” (${monthlyLuck.best?.god?.k || '-'})
â€¢ ì¡°ì‹¬í•  ë‹¬: ${monthlyLuck.worst?.month || '-'}ì›” (${monthlyLuck.worst?.god?.k || '-'})`;
            }
        } catch(e) { monthText = 'â€¢ ì›”ë³„ ìš´ì„¸ ë°ì´í„° ì—†ìŒ'; }
        
        // ë‚©ìŒ/ëª…ê¶/íƒœì› (ì•ˆì „í•˜ê²Œ)
        let napeumText = '';
        try {
            const dayNapeum = calcNapeum(SAJU.day.s, SAJU.day.b);
            const yearNapeum = calcNapeum(SAJU.year.s, SAJU.year.b);
            napeumText = `â€¢ ì¼ì£¼ ë‚©ìŒ: ${SAJU.day.s.c}${SAJU.day.b.c} â†’ ${dayNapeum.name} (${dayNapeum.elementK}) - ${dayNapeum.desc}
â€¢ ì—°ì£¼ ë‚©ìŒ: ${SAJU.year.s.c}${SAJU.year.b.c} â†’ ${yearNapeum.name} (${yearNapeum.elementK})`;
        } catch(e) { napeumText = 'â€¢ ë‚©ìŒ ë°ì´í„° ì—†ìŒ'; }
        
        let myunggungText = '';
        try {
            if (SAJU.hour) {
                const myunggung = calcMyunggung(SAJU.month.b, SAJU.hour.b);
                myunggungText = `â€¢ ëª…ê¶: ${myunggung.name} (${myunggung.branch.c})
â€¢ ì„±í–¥: ${myunggung.trait}
â€¢ ì í•© ë¶„ì•¼: ${myunggung.career}`;
            } else {
                myunggungText = 'â€¢ ëª…ê¶: ì‹œì£¼ ë¯¸ìƒìœ¼ë¡œ ê³„ì‚° ë¶ˆê°€';
            }
        } catch(e) { myunggungText = 'â€¢ ëª…ê¶ ë°ì´í„° ì—†ìŒ'; }
        
        let taewonText = '';
        try {
            const taewon = calcTaewon(SAJU.year.s, SAJU.month.s, SAJU.month.b);
            taewonText = `â€¢ íƒœì›: ${taewon.pillar} (${taewon.stem.k}${taewon.branch.k})
â€¢ íƒœì› ë‚©ìŒ: ${taewon.napeum.name} (${taewon.napeum.elementK})`;
        } catch(e) { taewonText = 'â€¢ íƒœì› ë°ì´í„° ì—†ìŒ'; }
        
        // ë°©í•©/ì•”í•© (ì•ˆì „í•˜ê²Œ)
        let banghapText = '';
        try {
            const banghap = analyzeBanghap(SAJU);
            banghapText = banghap.length ? banghap.map(b => 
                `â€¢ ${b.name} (${b.branches}): ${b.dir} ${b.type === 'complete' ? 'ì™„ì„±!' : 'ë¯¸ì™„ì„±'}`
            ).join('\n') : 'â€¢ ë°©í•© ì—†ìŒ';
        } catch(e) { banghapText = 'â€¢ ë°©í•© ë°ì´í„° ì—†ìŒ'; }
        
        let amhapText = '';
        try {
            const amhap = analyzeAmhap(SAJU);
            amhapText = amhap.length ? amhap.map(a => 
                `â€¢ ${a.name}: ${a.positions} - ${a.desc}`
            ).join('\n') : 'â€¢ ì•”í•© ì—†ìŒ';
        } catch(e) { amhapText = 'â€¢ ì•”í•© ë°ì´í„° ì—†ìŒ'; }
        
        // ì‚¼í•©êµ­ ë¶„ì„ (ì¤‘ìš”!)
        let samhapText = '';
        let samhapWarning = '';
        try {
            const advInt = analyzeAdvancedInteractions(SAJU);
            if (advInt && advInt.samhapGuk && advInt.samhapGuk.length) {
                samhapText = advInt.samhapGuk.map(s => 
                    `â€¢ ${s.name}: ${s.complete ? 'ì™„ì „ ì„±ë¦½!' : 'ë°˜í•©'} - ${s.desc}`
                ).join('\n');
                // ì‚¼í•© ì™„ì„± ì‹œ íŠ¹ë³„ ê²½ê³ 
                const completeSamhap = advInt.samhapGuk.filter(s => s.complete);
                if (completeSamhap.length > 0) {
                    samhapWarning = `\n\nâš ï¸ [ì¤‘ìš”: ì‚¼í•©êµ­ ì™„ì „ ì„±ë¦½]\n${completeSamhap.map(s => 
                        `${s.name}ì´ ì™„ì„±ë˜ì–´ ì§€ì§€ì˜ ${s.result} ê¸°ìš´ì´ ë§¤ìš° ê°•í•´ì¡ŒìŠµë‹ˆë‹¤. ê²©êµ­ê³¼ ì‹ ê°•/ì‹ ì•½ íŒë‹¨ ì‹œ ì´ ì˜¤í–‰ ë³€í™”ë¥¼ ë°˜ë“œì‹œ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.`
                    ).join('\n')}`;
                }
            } else {
                samhapText = 'â€¢ ì‚¼í•©êµ­ ì—†ìŒ';
            }
        } catch(e) { samhapText = 'â€¢ ì‚¼í•©êµ­ ë°ì´í„° ì—†ìŒ'; }
        
        // í…ìŠ¤íŠ¸ ìƒì„±
        let text = `===== ì‚¬ì£¼íŒ”ì ë¶„ì„ ê²°ê³¼ =====

ã€ê¸°ë³¸ ì •ë³´ã€‘
â€¢ ìƒë…„ì›”ì¼ì‹œ: ${BIRTH_YEAR}ë…„ (${GENDER === 'm' ? 'ë‚¨' : 'ì—¬'}ì„±, ë§Œ ${age-1}ì„¸)
â€¢ ì¼ê°„: ${dm.k}${ELEMENT[dm.e].k}(${dm.c}${ELEMENT[dm.e].c})

ã€ì‚¬ì£¼ ì›êµ­ (ë…„/ì›”/ì¼/ì‹œ)ã€‘
â€¢ ì²œê°„: ${SAJU.year.s.c}(${SAJU.year.s.k}) ${SAJU.month.s.c}(${SAJU.month.s.k}) ${SAJU.day.s.c}(${SAJU.day.s.k}) ${SAJU.hour ? SAJU.hour.s.c+'('+SAJU.hour.s.k+')' : 'ë¯¸ìƒ'}
â€¢ ì§€ì§€: ${SAJU.year.b.c}(${SAJU.year.b.k}) ${SAJU.month.b.c}(${SAJU.month.b.k}) ${SAJU.day.b.c}(${SAJU.day.b.k}) ${SAJU.hour ? SAJU.hour.b.c+'('+SAJU.hour.b.k+')' : 'ë¯¸ìƒ'}

ã€ì‹­ì‹  (ì²œê°„ ê¸°ì¤€)ã€‘
â€¢ ë…„ê°„ ${SAJU.year.s.c}: ${yearGod.k} - ${yearGod.d}
â€¢ ì›”ê°„ ${SAJU.month.s.c}: ${monthGod.k} - ${monthGod.d}
â€¢ ì¼ê°„ ${SAJU.day.s.c}: ë³¸ì¸ (ì¼ì£¼)
${hourGod ? 'â€¢ ì‹œê°„ ' + SAJU.hour.s.c + ': ' + hourGod.k + ' - ' + hourGod.d : 'â€¢ ì‹œê°„: ë¯¸ìƒ'}

ã€12ìš´ì„± (ì¼ê°„ ê¸°ì¤€)ã€‘
â€¢ ë…„ì§€ ${SAJU.year.b.c}: ${yearState.k} (ì—ë„ˆì§€ ${yearState.l}/12)
â€¢ ì›”ì§€ ${SAJU.month.b.c}: ${monthState.k} (ì—ë„ˆì§€ ${monthState.l}/12)
â€¢ ì¼ì§€ ${SAJU.day.b.c}: ${dayState.k} (ì—ë„ˆì§€ ${dayState.l}/12)
${hourState ? 'â€¢ ì‹œì§€ ' + SAJU.hour.b.c + ': ' + hourState.k + ' (ì—ë„ˆì§€ ' + hourState.l + '/12)' : 'â€¢ ì‹œì§€: ë¯¸ìƒ'}

ã€ì˜¤í–‰ ë¶„í¬ã€‘
â€¢ ëª©(æœ¨): ${elCount.wood}ê°œ
â€¢ í™”(ç«): ${elCount.fire}ê°œ
â€¢ í† (åœŸ): ${elCount.earth}ê°œ
â€¢ ê¸ˆ(é‡‘): ${elCount.metal}ê°œ
â€¢ ìˆ˜(æ°´): ${elCount.water}ê°œ
â€¢ ì—†ëŠ” ì˜¤í–‰: ${Object.entries(elCount).filter(e => e[1] === 0).map(e => ELEMENT[e[0]].k).join(', ') || 'ì—†ìŒ'}

ã€ì‹ ê°•/ì‹ ì•½ã€‘
â€¢ ì¼ê°„ ê°•ë„: ${str.pct}% (${str.type === 'strong' ? 'ì‹ ê°•' : str.type === 'weak' ? 'ì‹ ì•½' : 'ì¤‘í™”'})
${str.extreme ? 'â€¢ íŠ¹ì´ì‚¬í•­: ' + str.extreme + ' ì‚¬ì£¼ (ì¢…ê²© ê°€ëŠ¥ì„±)' : ''}

ã€ìš©ì‹ /í¬ì‹ /ê¸°ì‹ ã€‘
â€¢ ìš©ì‹ (ç”¨ç¥): ${ELEMENT[GODS.yong].k}(${ELEMENT[GODS.yong].c}) - ê°€ì¥ í•„ìš”í•œ ì˜¤í–‰
â€¢ í¬ì‹ (å–œç¥): ${ELEMENT[GODS.hee].k}(${ELEMENT[GODS.hee].c}) - ìš©ì‹ ì„ ë•ëŠ” ì˜¤í–‰
â€¢ ê¸°ì‹ (å¿Œç¥): ${ELEMENT[GODS.gi].k}(${ELEMENT[GODS.gi].c}) - í”¼í•´ì•¼ í•  ì˜¤í–‰
${GODS.johu ? 'â€¢ ì¡°í›„ìš©ì‹ : ' + (GODS.johuDesc || '') : ''}
${GODS.climate ? 'â€¢ í•œë‚œì¡°ìŠµ: ' + GODS.climate.type + ' - ' + GODS.climate.desc : ''}

ã€ê²©êµ­ã€‘
â€¢ ${format.n}
â€¢ íŠ¹ì§•: ${format.d}
â€¢ ì í•© ë¶„ì•¼: ${format.b}

ã€60ê°‘ì ì¼ì£¼ë¡  - ${SAJU.day.s.c}${SAJU.day.b.c}ì¼ì£¼ã€‘
â€¢ ${ilju.title}
â€¢ ì„±ê²©: ${ilju.desc?.substring(0, 100) || ''}...
â€¢ ë°°ìš°ììš´: ${ilju.spouse?.substring(0, 80) || ''}...

ã€ì§€ì¥ê°„ ë¶„ì„ã€‘
${jjText}

ã€ë‚©ìŒì˜¤í–‰(ç´éŸ³äº”è¡Œ)ã€‘
${napeumText}

ã€ëª…ê¶(å‘½å®®)ã€‘
${myunggungText}

ã€íƒœì›(èƒå…ƒ)ã€‘
${taewonText}

ã€í†µê·¼/íˆ¬ê°„ã€‘
${ttText}

ã€ìœ¡ì¹œ ë¶„ì„ã€‘
${ycText}

ã€ê¶ìœ„(å®®ä½) ë¶„ì„ - ì¸ìƒ ì‹œê¸°ë³„ã€‘
${gwText}

ã€í•©ì¶©í˜•íŒŒí•´ã€‘
${interactions.length ? interactions.map(i => 'â€¢ ' + i.t + ': ' + i.c + ' - ' + i.m).join('\n') : 'â€¢ íŠ¹ë³„í•œ í•©ì¶© ì—†ìŒ'}

ã€ë°©í•©(æ–¹åˆ)ã€‘
${banghapText}

ã€ì•”í•©(æš—åˆ)ã€‘
${amhapText}

ã€ì‚¼í•©êµ­(ä¸‰åˆå±€)ã€‘
${samhapText}${samhapWarning}

ã€ê³µë§ã€‘
â€¢ ${gongmang?.names?.join(', ') || ''}
${gongmang?.affected?.length ? 'â€¢ ì˜í–¥: ' + gongmang.affected.join(', ') + 'ì— ê³µë§' : 'â€¢ ì‚¬ì£¼ ë‚´ ê³µë§ ì—†ìŒ'}

ã€ì‹ ì‚´ã€‘
${sinsal.length ? sinsal.map(s => 'â€¢ ' + s.n + '(' + (s.t === 'good' ? 'ê¸¸' : s.t === 'bad' ? 'í‰' : 'ì¤‘') + '): ' + s.d).join('\n') : 'â€¢ íŠ¹ë³„í•œ ì‹ ì‚´ ì—†ìŒ'}

ã€ëŒ€ìš´ (10ë…„ ë‹¨ìœ„)ã€‘
${luck.slice(0,8).map(l => 'â€¢ ' + l.startAge + '-' + l.endAge + 'ì„¸: ' + l.s.c + l.b.c + ' (' + ELEMENT[l.s.e].k + ELEMENT[l.b.e].k + ')' + (l.isCur ? ' â—€ í˜„ì¬' : '')).join('\n')}

ã€í˜„ì¬ ìš´ì„¸ã€‘
â€¢ í˜„ì¬ ëŒ€ìš´: ${curLuck ? curLuck.s.c + curLuck.b.c + ' (' + curLuck.startAge + '-' + curLuck.endAge + 'ì„¸)' : 'ê³„ì‚° ì¤‘'}
â€¢ ëŒ€ìš´ í‰ê°€: ${curLuck ? (curLuck.rating === 'good' ? 'ê¸¸ìš´' : curLuck.rating === 'bad' ? 'í‰ìš´' : 'í‰ìš´') : '-'}
â€¢ ${currentYear}ë…„ ì„¸ìš´: ${(() => { const yp = calcYearPillar(currentYear, 6, 1); return yp.s.c + yp.b.c + ' (' + ELEMENT[yp.s.e].k + ELEMENT[yp.b.e].k + ')'; })()}

ã€í–¥í›„ 10ë…„ ìš´ì„¸ ë¯¸ë¦¬ë³´ê¸°ã€‘
${next10Text}

ã€${currentYear}ë…„ ì›”ë³„ ìš´ì„¸ã€‘
${monthText}

===== AI í•´ì„ ìš”ì²­ =====

[í˜ë¥´ì†Œë‚˜ ì„¤ì •]
ë‹¹ì‹ ì€ 30ë…„ ê²½ë ¥ì˜ í˜„ëŒ€ì ì´ê³  ì„¸ë ¨ëœ ëª…ë¦¬í•™ìì…ë‹ˆë‹¤. 
- ì „ë¬¸ ìš©ì–´(ë¹„ê²¬, í¸ì¬, ì‹ì‹ , ê±´ë¡, ê´€ëŒ€ ë“±)ë¥¼ ì‚¬ìš©í•˜ë˜, ë°˜ë“œì‹œ ê·¸ ë’¤ì— ì´ˆë“±í•™ìƒë„ ì´í•´í•  ìˆ˜ ìˆëŠ” ì‰¬ìš´ ë¹„ìœ ë¥¼ ì„ì–´ ì„¤ëª…í•´ì£¼ì„¸ìš”. ì˜ˆ: "ë¹„ê²¬(æ¯”è‚©)ì€ ë‚˜ì™€ ê°™ì€ ì—ë„ˆì§€ë¥¼ ê°€ì§„ í˜•ì œìë§¤ ê°™ì€ ì¡´ì¬ì˜ˆìš”."
- ë§íˆ¬ëŠ” ë”°ëœ»í•˜ê³  í¬ë§ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë¶€ì •ì ì¸ ë‚´ìš©ë„ ë°˜ë“œì‹œ ê±´ì„¤ì ì¸ ì¡°ì–¸ê³¼ ê·¹ë³µ ë°©ë²•ê³¼ í•¨ê»˜ ì „ë‹¬í•´ì£¼ì„¸ìš”.
- "~ì…ë‹ˆë‹¤"ì²´ë¡œ ê²©ì‹ìˆê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.
- ê° í•­ëª©ë‹¹ 2-3ë¬¸ë‹¨ì”© ìƒì„¸íˆ ì„œìˆ í•´ì£¼ì„¸ìš”.

[âš ï¸ ì¤‘ìš” í•´ì„ ì§€ì¹¨]
1. ì‚¼í•©êµ­(ä¸‰åˆå±€)ì´ ì™„ì „ ì„±ë¦½í–ˆë‹¤ë©´, ì§€ì§€ì˜ ì˜¤í–‰ì´ í•´ë‹¹ ì˜¤í–‰ìœ¼ë¡œ ê°•ë ¥í•˜ê²Œ ë³€í™”í•©ë‹ˆë‹¤. ì´ ì ì„ ê²©êµ­/ì‹ ê°•ì‹ ì•½/ìš©ì‹  íŒë‹¨ì— ë°˜ë“œì‹œ ë°˜ì˜í•˜ì„¸ìš”.
   - ì¸ì˜¤ìˆ  í™”êµ­ â†’ ì§€ì§€ê°€ í™”(ç«) ê¸°ìš´ìœ¼ë¡œ
   - ì‚¬ìœ ì¶• ê¸ˆêµ­ â†’ ì§€ì§€ê°€ ê¸ˆ(é‡‘) ê¸°ìš´ìœ¼ë¡œ
   - ì‹ ìì§„ ìˆ˜êµ­ â†’ ì§€ì§€ê°€ ìˆ˜(æ°´) ê¸°ìš´ìœ¼ë¡œ
   - í•´ë¬˜ë¯¸ ëª©êµ­ â†’ ì§€ì§€ê°€ ëª©(æœ¨) ê¸°ìš´ìœ¼ë¡œ

2. ë°°ìš°ìì„±ì´ ì²œê°„ì— ì—†ë”ë¼ë„ ì§€ì¥ê°„ì— ìˆ¨ì–´ìˆìœ¼ë©´ "ì—†ìŒ"ì´ ì•„ë‹ˆë¼ "ì•”ì¥(æš—è—)"ìœ¼ë¡œ í•´ì„í•˜ì„¸ìš”.

3. ëŒ€ìš´/ì„¸ìš´ì—ì„œ ì‚¼í•©ì´ ì™„ì„±ë˜ëŠ” í•´ëŠ” íŠ¹ë³„íˆ ê°•ì¡°í•´ì„œ í•´ì„í•˜ì„¸ìš”.
   - ì˜ˆ: ì›êµ­ì— ì‹ +ì§„ì´ ìˆê³  ëŒ€ìš´ì—ì„œ ì(å­)ê°€ ì˜¤ë©´ â†’ "ì‹ ìì§„ ìˆ˜êµ­ ì™„ì„±! ëŒ€ìš´ ê¸°ê°„ ë‚´ë‚´ ë¬¼(ì¬ë¬¼/ìš•ë§)ì´ ì§€ë°°í•˜ëŠ” ì‹œê¸°"

4. ëŒ€ìš´ vs ì„¸ìš´ ì¶©ëŒ (ì™•ì§€ ì¶©ëŒ) ì£¼ì˜:
   - ìì˜¤ì¶©(å­åˆæ²–), ë¬˜ìœ ì¶©(å¯é…‰æ²–) ë“± ì™•ì§€ë¼ë¦¬ì˜ ì¶©ëŒì€ ë§¤ìš° ê°•ë ¥í•©ë‹ˆë‹¤.
   - ëŒ€ìš´ì˜ ì§€ì§€ì™€ ì„¸ìš´ì˜ ì§€ì§€ê°€ ì¶©ëŒí•˜ë©´ "ê²©ë™ì˜ í•´"ë¡œ í•´ì„í•˜ì„¸ìš”.
   - ì˜ˆ: ëŒ€ìš´ ì(å­) + ì„¸ìš´ ì˜¤(åˆ) = ìˆ˜í™”ìƒì „(æ°´ç«ç›¸æˆ°). ì‹¬í˜ˆê´€/ì •ì‹  ê±´ê°• ì£¼ì˜.

5. ê²©êµ­ íŒë‹¨ ì‹œ ì£¼ì˜:
   - ì›”ì§€ ì •ê¸°ë§Œ ë³´ì§€ ë§ê³ , ì›”ê°„ì— íˆ¬ì¶œëœ ì‹­ì‹ ì´ ê°•í•œ ì„¸ë ¥ì„ í˜•ì„±í•˜ë©´ ê·¸ê²ƒì´ ê²©êµ­ì…ë‹ˆë‹¤.
   - ì˜ˆ: ì›”ì§€ê°€ ì¶•(í† )ì´ì§€ë§Œ ì›”ê°„ì— ì„ëª©(í¸ê´€)ì´ ìˆê³  í•´ë¬˜ ë°˜í•©ì´ ìˆìœ¼ë©´ â†’ í¸ê´€ê²©ìœ¼ë¡œ ë´ì•¼ í•¨

6. ì‹ ê°•/ì‹ ì•½ê³¼ ê²©êµ­ í•´ì„ì˜ ì¡°í™”:
   - ì‹ ì•½(30% ì´í•˜)ì¸ë° ë¹„ê²¬ê²©ì´ë©´ "ê³ ì§‘ì´ ì„¸ë‹¤"ê°€ ì•„ë‹ˆë¼ "ê°•ë°•ì´ ìˆë‹¤/ì˜ˆë¯¼í•˜ë‹¤"ë¡œ í•´ì„
   - ì‹ ê°•(70% ì´ìƒ)ì¸ë° í¸ê´€ê²©ì´ë©´ "ìŠ¤íŠ¸ë ˆìŠ¤"ê°€ ì•„ë‹ˆë¼ "ë¦¬ë”ì‹­/ì¹´ë¦¬ìŠ¤ë§ˆ"ë¡œ í•´ì„

7. íƒ•í™”ì‚´(æ¹¯ç«æ®º)ì´ ìˆì„ ë•Œ:
   - ì›êµ­ì— ì¶•ì˜¤/ì¸ì‚¬ íƒ•í™”ê°€ ìˆëŠ”ë° ì„¸ìš´ì—ì„œ ì˜¤(åˆ)ë‚˜ ì‚¬(å·³)ê°€ ë˜ ë“¤ì–´ì˜¤ë©´ "ìŒíƒ•í™”" â†’ ë©˜íƒˆ ê±´ê°• íŠ¹ë³„ ê²½ê³ 
   - "í™”ë³‘, ì•½ë¬¼ ë¶€ì‘ìš©, ê°ì • í­ë°œ"ì˜ ìœ„í—˜ì„±ì„ ë°˜ë“œì‹œ ì–¸ê¸‰

8. ìƒê´€í•©ì‚´(å‚·å®˜åˆæ®º)ì´ ìˆìœ¼ë©´:
   - ë‹¨ìˆœíˆ "ë§ì¡°ì‹¬"ì´ ì•„ë‹ˆë¼ "ìœ„ê¸°ë¥¼ ê¸°íšŒë¡œ ë°”ê¾¸ëŠ” í˜‘ìƒê°€ ì¬ëŠ¥"ìœ¼ë¡œ ê¸ì • í•´ì„

[ë¶„ì„ ìš”ì²­ì‚¬í•­]
ìœ„ ì‚¬ì£¼íŒ”ì ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì„ ê°ê° ìƒì„¸íˆ ì„œìˆ í˜•ìœ¼ë¡œ í•´ì„í•´ ì£¼ì„¸ìš”:

1. íƒ€ê³ ë‚œ ì„±ê²©ê³¼ ê¸°ì§ˆ
   - ì¼ê°„ì˜ íŠ¹ì„±, ê²©êµ­ì˜ ì˜ë¯¸, 60ê°‘ì ì¼ì£¼ë¡  ê¸°ë°˜
   - ì¥ì ê³¼ ë³´ì™„í•  ì 

2. ì ì„±ê³¼ ì§ì—…ìš´  
   - ê²©êµ­, ìš©ì‹ , ì‹­ì‹  ê¸°ë°˜ ì í•© ë¶„ì•¼
   - ì§ì¥ì¸ vs ì‚¬ì—…ê°€ ì ì„±

3. ì¬ë¬¼ìš´ê³¼ ê¸ˆì „ ê´€ë¦¬
   - ì¬ì„±ì˜ ìœ„ì¹˜ì™€ ê°•ì•½
   - ëˆì„ ë²„ëŠ” ë°©ì‹ê³¼ ê´€ë¦¬ ì¡°ì–¸
   - ì•”í•©ì´ ìˆìœ¼ë©´ ë‚¨ë“¤ì´ ëª¨ë¥´ëŠ” ë¹„ìƒê¸ˆì´ë‚˜ ë¶€ìˆ˜ì… ê°€ëŠ¥ì„±ë„ ì–¸ê¸‰

4. ì—°ì• ìš´ê³¼ ê²°í˜¼ìš´
   - ë°°ìš°ìì„±, ì¼ì§€ 12ìš´ì„±, ë°°ìš°ìê¶ ë¶„ì„
   - ì´ìƒí˜•ê³¼ ê²°í˜¼ ì‹œê¸°
   - ì•”í•©ì´ ìˆìœ¼ë©´ ë¹„ë°€ì—°ì• ë‚˜ ìˆ¨ê²¨ì§„ ì¸ì—° ê°€ëŠ¥ì„±ë„ ì–¸ê¸‰

5. ê±´ê°• ì£¼ì˜ì‚¬í•­
   - ì˜¤í–‰ ë¶ˆê· í˜•ìœ¼ë¡œ ì¸í•œ ì·¨ì•½ ë¶€ìœ„
   - ì˜ˆë°© ë° ê´€ë¦¬ ë°©ë²•

6. í˜„ì¬ ìš´ì„¸ (${currentYear}ë…„)
   - í˜„ì¬ ëŒ€ìš´ê³¼ ì„¸ìš´ì˜ ì¡°í•©
   - ì˜¬í•´ íŠ¹íˆ ì£¼ì˜í•  ì ê³¼ ê¸°íšŒ

7. ì¸ìƒ ì „ë°˜ì˜ íë¦„
   - ê¶ìœ„ë³„ ì‹œê¸° ë¶„ì„ (ìœ ë…„-ì²­ë…„-ì¤‘ë…„-ë§ë…„)
   - ì£¼ìš” ì „í™˜ì ê³¼ ëŒ€ë¹„ ë°©ë²•

8. ì¢…í•© ì¡°ì–¸
   - ìš©ì‹  í™œìš© êµ¬ì²´ì  ë°©ë²• (ìƒ‰ìƒ, ë°©í–¥, ì§ì—…, ì¸ê°„ê´€ê³„)
   - ì´ ì‚¬ì£¼ì˜ í•µì‹¬ ë©”ì‹œì§€ í•œ ì¤„ ìš”ì•½
`;

        navigator.clipboard.writeText(text).then(() => {
            toast('ğŸ“‹ ë³µì‚¬ ì™„ë£Œ! Geminië‚˜ ChatGPTì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”');
        }).catch(() => {
            // í´ë°±: textarea ì‚¬ìš©
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            toast('ğŸ“‹ ë³µì‚¬ ì™„ë£Œ!');
        });
    } catch(err) {
        console.error('ë³µì‚¬ ì˜¤ë¥˜:', err);
        toast('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');
    }
}

/* ========================================
   17. ê¶í•©
   ======================================== */
function analyzeMatch() {
    try {
    if (!SAJU) { toast('ë¨¼ì € [ì‚¬ì£¼ë¶„ì„]ì—ì„œ ë‚´ ì‚¬ì£¼ë¥¼ ë¶„ì„í•˜ì„¸ìš”'); return; }
    
    const py = +document.getElementById('partner-year').value;
    const pm = +document.getElementById('partner-month').value;
    const pd = +document.getElementById('partner-day').value;
    const pGender = document.getElementById('partner-gender').value;
    
    // ì…ë ¥ê°’ ê²€ì¦
    if (!py || !pm || !pd) { toast('ìƒëŒ€ë°© ìƒë…„ì›”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”'); return; }
    if (py < 1900 || py > 2100) { toast('ì—°ë„ëŠ” 1900~2100 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
    if (pm < 1 || pm > 12) { toast('ì›”ì€ 1~12 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
    if (pd < 1 || pd > 31) { toast('ì¼ì€ 1~31 ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”'); return; }
    
    // ìƒëŒ€ë°© ì‚¬ì£¼ ê³„ì‚°
    const pSaju = { 
        year: calcYearPillar(py, pm, pd), 
        month: calcMonthPillar(py, pm, pd), 
        day: calcDayPillar(py, pm, pd) 
    };
    
    // ì‚¬ì£¼ ê³„ì‚° ê²°ê³¼ ê²€ì¦
    if (!pSaju.year || !pSaju.month || !pSaju.day) {
        toast('ìƒëŒ€ë°© ì‚¬ì£¼ ê³„ì‚° ì˜¤ë¥˜. ì…ë ¥ê°’ì„ í™•ì¸í•˜ì„¸ìš”');
        return;
    }
    
    const pStr = calcStrength(pSaju);
    const pGods = calcGods(pSaju, pStr);
    
    // ë¶„ì„ ê²°ê³¼ ì €ì¥
    let totalScore = 50;
    const analysis = {
        ilgan: { score: 0, details: [] },      // ì¼ê°„ ê¶í•©
        ilji: { score: 0, details: [] },       // ì¼ì§€ ê¶í•©
        oheng: { score: 0, details: [] },      // ì˜¤í–‰ ê¶í•©
        napeum: { score: 0, details: [] },     // ë‚©ìŒ ê¶í•©
        yongsin: { score: 0, details: [] },    // ìš©ì‹  ê¶í•©
        jijanggan: { score: 0, details: [] },  // ì§€ì¥ê°„ ê¶í•©
        samhap: { score: 0, details: [] },     // ì‚¼í•© ê¶í•©
        ddi: { score: 0, details: [] },        // ë  ê¶í•©
        ilju: { score: 0, details: [] },       // ì¼ì£¼ ê¶í•©
        wonJinGuiMun: { score: 0, details: [] }, // ì›ì§„/ê·€ë¬¸ ê¶í•© (NEW)
        yukChin: { score: 0, details: [] }     // ìœ¡ì¹œ ê¶í•© (NEW)
    };
    
    const myDm = SAJU.day.s;
    const pDm = pSaju.day.s;
    const myDmIdx = STEM.indexOf(myDm);
    const pDmIdx = STEM.indexOf(pDm);
    const myDbIdx = BRANCH.indexOf(SAJU.day.b);
    const pDbIdx = BRANCH.indexOf(pSaju.day.b);
    const myYbIdx = BRANCH.indexOf(SAJU.year.b);
    const pYbIdx = BRANCH.indexOf(pSaju.year.b);
    
    // ========== 1. ì¼ê°„(ì²œê°„) ê¶í•© ==========
    const ganHap = [
        {a:0, b:5, name:'ê°‘ê¸°í•©í† ', result:'åœŸ'},
        {a:1, b:6, name:'ì„ê²½í•©ê¸ˆ', result:'é‡‘'},
        {a:2, b:7, name:'ë³‘ì‹ í•©ìˆ˜', result:'æ°´'},
        {a:3, b:8, name:'ì •ì„í•©ëª©', result:'æœ¨'},
        {a:4, b:9, name:'ë¬´ê³„í•©í™”', result:'ç«'}
    ];
    
    let ganHapFound = false;
    for (const gh of ganHap) {
        if ((myDmIdx === gh.a && pDmIdx === gh.b) || (myDmIdx === gh.b && pDmIdx === gh.a)) {
            analysis.ilgan.score = 25;
            analysis.ilgan.details.push({
                type: 'excellent',
                title: 'ğŸ’• ì²œê°„í•© ì„±ë¦½!',
                desc: `${gh.name} - ë‘ ë¶„ì˜ ì¼ê°„ì´ ì²œìƒì—°ë¶„ì´ì—ìš”! ë§ˆì¹˜ í¼ì¦ ì¡°ê°ì²˜ëŸ¼ ë”± ë§ì•„ìš”.`,
                tip: 'ì„œë¡œë¥¼ ë³´ì™„í•´ì£¼ëŠ” ìµœê³ ì˜ ì¡°í•©ì…ë‹ˆë‹¤.'
            });
            ganHapFound = true;
            break;
        }
    }
    
    if (!ganHapFound) {
        // ê°™ì€ ì˜¤í–‰ì¸ì§€
        if (myDm.e === pDm.e) {
            analysis.ilgan.score = 10;
            analysis.ilgan.details.push({
                type: 'good',
                title: 'ğŸ¤ ê°™ì€ ì˜¤í–‰',
                desc: `ë‘˜ ë‹¤ ${ELEMENT[myDm.e].k} ê¸°ìš´! ìƒê°ì´ ë¹„ìŠ·í•´ì„œ í†µí•´ìš”.`,
                tip: 'ë¹„ìŠ·í•´ì„œ í¸í•˜ì§€ë§Œ, ë•Œë¡  ì–‘ë³´ê°€ í•„ìš”í•´ìš”.'
            });
        }
        // ìƒìƒ ê´€ê³„ì¸ì§€
        else if ((EL_ORDER.indexOf(myDm.e) + 1) % 5 === EL_ORDER.indexOf(pDm.e)) {
            analysis.ilgan.score = 8;
            analysis.ilgan.details.push({
                type: 'good',
                title: 'ğŸŒ± ë‚´ê°€ ìƒëŒ€ë¥¼ ìƒí•´ì¤Œ',
                desc: `${ELEMENT[myDm.e].k}ì´ ${ELEMENT[pDm.e].k}ì„ ìƒí•´ìš”. ë‚´ê°€ ìƒëŒ€ë¥¼ ë„ì™€ì£¼ëŠ” ê´€ê³„.`,
                tip: 'í—Œì‹ ì ì¸ ì‚¬ë‘ì„ í•˜ê²Œ ë¼ìš”.'
            });
        }
        else if ((EL_ORDER.indexOf(pDm.e) + 1) % 5 === EL_ORDER.indexOf(myDm.e)) {
            analysis.ilgan.score = 8;
            analysis.ilgan.details.push({
                type: 'good',
                title: 'ğŸ’ ìƒëŒ€ê°€ ë‚˜ë¥¼ ìƒí•´ì¤Œ',
                desc: `${ELEMENT[pDm.e].k}ì´ ${ELEMENT[myDm.e].k}ì„ ìƒí•´ìš”. ìƒëŒ€ê°€ ë‚˜ë¥¼ ë„ì™€ì¤˜ìš”.`,
                tip: 'ìƒëŒ€ì˜ ì‚¬ë‘ì„ ë“¬ë¿ ë°›ì•„ìš”.'
            });
        }
        // ìƒê·¹ ê´€ê³„ì¸ì§€
        else if ((EL_ORDER.indexOf(myDm.e) + 2) % 5 === EL_ORDER.indexOf(pDm.e)) {
            analysis.ilgan.score = -5;
            analysis.ilgan.details.push({
                type: 'caution',
                title: 'âš¡ ë‚´ê°€ ìƒëŒ€ë¥¼ ê·¹í•¨',
                desc: `${ELEMENT[myDm.e].k}ì´ ${ELEMENT[pDm.e].k}ì„ ê·¹í•´ìš”. ë‚´ê°€ ìƒëŒ€ë¥¼ ì••ë°•í•  ìˆ˜ ìˆì–´ìš”.`,
                tip: 'ë¬´ì‹¬ì½” ìƒëŒ€ì—ê²Œ ìƒì²˜ì¤„ ìˆ˜ ìˆìœ¼ë‹ˆ ë§ì¡°ì‹¬!'
            });
        }
        else if ((EL_ORDER.indexOf(pDm.e) + 2) % 5 === EL_ORDER.indexOf(myDm.e)) {
            analysis.ilgan.score = -5;
            analysis.ilgan.details.push({
                type: 'caution',
                title: 'ğŸ˜° ìƒëŒ€ê°€ ë‚˜ë¥¼ ê·¹í•¨',
                desc: `${ELEMENT[pDm.e].k}ì´ ${ELEMENT[myDm.e].k}ì„ ê·¹í•´ìš”. ìƒëŒ€ê°€ ë‚˜ë¥¼ í˜ë“¤ê²Œ í•  ìˆ˜ ìˆì–´ìš”.`,
                tip: 'ê°ì • í‘œí˜„ì„ ì†”ì§í•˜ê²Œ í•˜ë©´ ì¢‹ì•„ì ¸ìš”.'
            });
        }
    }
    
    // ========== 2. ì¼ì§€(ë°°ìš°ìê¶) ê¶í•© ==========
    const jiHap = [
        {a:0, b:1, name:'ìì¶•í•©'}, {a:2, b:11, name:'ì¸í•´í•©'},
        {a:3, b:10, name:'ë¬˜ìˆ í•©'}, {a:4, b:9, name:'ì§„ìœ í•©'},
        {a:5, b:8, name:'ì‚¬ì‹ í•©'}, {a:6, b:7, name:'ì˜¤ë¯¸í•©'}
    ];
    const jiChung = [
        {a:0, b:6, name:'ìì˜¤ì¶©'}, {a:1, b:7, name:'ì¶•ë¯¸ì¶©'},
        {a:2, b:8, name:'ì¸ì‹ ì¶©'}, {a:3, b:9, name:'ë¬˜ìœ ì¶©'},
        {a:4, b:10, name:'ì§„ìˆ ì¶©'}, {a:5, b:11, name:'ì‚¬í•´ì¶©'}
    ];
    
    // ìœ¡í•© ì²´í¬
    for (const jh of jiHap) {
        if ((myDbIdx === jh.a && pDbIdx === jh.b) || (myDbIdx === jh.b && pDbIdx === jh.a)) {
            analysis.ilji.score = 20;
            analysis.ilji.details.push({
                type: 'excellent',
                title: 'ğŸ’‘ ì¼ì§€ ìœ¡í•©!',
                desc: `${jh.name} - ë°°ìš°ìê¶ë¼ë¦¬ í•©! í•¨ê»˜ ìˆìœ¼ë©´ ë§ˆìŒì´ í¸ì•ˆí•´ìš”.`,
                tip: 'ê²°í˜¼í•˜ë©´ ê¸ˆìŠ¬ì´ ì¢‹ì•„ìš”.'
            });
            break;
        }
    }
    
    // ì¶© ì²´í¬
    for (const jc of jiChung) {
        if ((myDbIdx === jc.a && pDbIdx === jc.b) || (myDbIdx === jc.b && pDbIdx === jc.a)) {
            analysis.ilji.score = -15;
            analysis.ilji.details.push({
                type: 'bad',
                title: 'ğŸ’¥ ì¼ì§€ ì¶©!',
                desc: `${jc.name} - ë°°ìš°ìê¶ë¼ë¦¬ ì¶©ëŒ! ì„œë¡œ ë¶€ë”ªíˆê¸° ì‰¬ì›Œìš”.`,
                tip: 'ëŒ€í™”ë¡œ í’€ì–´ê°€ë©´ ì˜¤íˆë ¤ ì—´ì •ì ì¸ ê´€ê³„ê°€ ë  ìˆ˜ ìˆì–´ìš”.'
            });
            break;
        }
    }
    
    // ê°™ì€ ì¼ì§€ (ìí˜•)
    if (myDbIdx === pDbIdx) {
        analysis.ilji.score = 5;
        analysis.ilji.details.push({
            type: 'neutral',
            title: 'ğŸ”„ ê°™ì€ ì¼ì§€',
            desc: `ë‘˜ ë‹¤ ${SAJU.day.b.c}(${SAJU.day.b.k})! ì„±ê²©ì´ ë¹„ìŠ·í•´ìš”.`,
            tip: 'ë„ˆë¬´ ë¹„ìŠ·í•´ì„œ ë‹µë‹µí•  ìˆ˜ ìˆì–´ìš”. ê°ì ê³µê°„ì´ í•„ìš”í•´ìš”.'
        });
    }
    
    // ========== 3. ì‚¼í•© ê¶í•© ==========
    const samhapSets = [
        {branches: [2, 6, 10], name: 'ì¸ì˜¤ìˆ  ì‚¼í•©', element: 'ç«'},
        {branches: [5, 9, 1], name: 'ì‚¬ìœ ì¶• ì‚¼í•©', element: 'é‡‘'},
        {branches: [8, 0, 4], name: 'ì‹ ìì§„ ì‚¼í•©', element: 'æ°´'},
        {branches: [11, 3, 7], name: 'í•´ë¬˜ë¯¸ ì‚¼í•©', element: 'æœ¨'}
    ];
    
    for (const sh of samhapSets) {
        const myIn = sh.branches.includes(myDbIdx);
        const pIn = sh.branches.includes(pDbIdx);
        if (myIn && pIn && myDbIdx !== pDbIdx) {
            analysis.samhap.score = 12;
            analysis.samhap.details.push({
                type: 'good',
                title: 'ğŸŒ€ ì‚¼í•© ê´€ê³„!',
                desc: `${sh.name}(${sh.element}êµ­)ì— ë‘˜ ë‹¤ ì†í•´ìš”! ê°™ì€ íŒ€ì´ì—ìš”.`,
                tip: 'ê³µë™ ëª©í‘œê°€ ìˆìœ¼ë©´ ìµœê°• íŒŒíŠ¸ë„ˆ!'
            });
            break;
        }
    }
    
    // ========== 4. ë°©í•© ê¶í•© ==========
    for (const bh of BANGHAP) {
        const myIn = bh.branches.includes(myDbIdx);
        const pIn = bh.branches.includes(pDbIdx);
        if (myIn && pIn && myDbIdx !== pDbIdx) {
            analysis.samhap.score += 8;
            analysis.samhap.details.push({
                type: 'good',
                title: 'ğŸ§­ ë°©í•© ê´€ê³„!',
                desc: `${bh.name} - ê°™ì€ ë°©í–¥ì„ ë°”ë¼ë´ìš”.`,
                tip: 'ê°€ì¹˜ê´€ì´ ë¹„ìŠ·í•´ì„œ ê°ˆë“±ì´ ì ì–´ìš”.'
            });
            break;
        }
    }
    
    // ========== 5. ë‚©ìŒ ê¶í•© ==========
    const myNapeum = calcNapeum(SAJU.day.s, SAJU.day.b);
    const pNapeum = calcNapeum(pSaju.day.s, pSaju.day.b);
    
    if (myNapeum.name === pNapeum.name) {
        analysis.napeum.score = 15;
        analysis.napeum.details.push({
            type: 'excellent',
            title: 'ğŸµ ë‚©ìŒ ì¼ì¹˜!',
            desc: `ë‘˜ ë‹¤ "${myNapeum.name}"! ì˜í˜¼ì˜ íŒŒì¥ì´ ê°™ì•„ìš”.`,
            tip: 'ë§ ì•ˆ í•´ë„ í†µí•˜ëŠ” ì‚¬ì´ê°€ ë  ê±°ì˜ˆìš”.'
        });
    } else if (myNapeum.element === pNapeum.element) {
        analysis.napeum.score = 8;
        analysis.napeum.details.push({
            type: 'good',
            title: 'ğŸ¶ ë‚©ìŒ ì˜¤í–‰ ì¼ì¹˜',
            desc: `ë‘˜ ë‹¤ ${myNapeum.elementK} ê³„ì—´! ê¸°ë³¸ íŒŒì¥ì´ ë¹„ìŠ·í•´ìš”.`,
            tip: 'ê°ì„±ì´ í†µí•˜ëŠ” í¸ì´ì—ìš”.'
        });
    } else {
        // ë‚©ìŒ ìƒìƒ/ìƒê·¹
        const myNEl = EL_ORDER.indexOf(myNapeum.element);
        const pNEl = EL_ORDER.indexOf(pNapeum.element);
        if ((myNEl + 1) % 5 === pNEl || (pNEl + 1) % 5 === myNEl) {
            analysis.napeum.score = 5;
            analysis.napeum.details.push({
                type: 'good',
                title: 'ğŸ¼ ë‚©ìŒ ìƒìƒ',
                desc: `${myNapeum.name}ê³¼ ${pNapeum.name}ì´ ì„œë¡œ ë„ì™€ì¤˜ìš”.`,
                tip: 'ìì—°ìŠ¤ëŸ½ê²Œ ì¡°í™”ë¥¼ ì´ë¤„ìš”.'
            });
        }
    }
    
    // ========== 6. ìš©ì‹  ê¶í•© ==========
    // ë‚´ ìš©ì‹ ì´ ìƒëŒ€ ì‚¬ì£¼ì— ìˆëŠ”ì§€
    const pElements = {};
    EL_ORDER.forEach(e => pElements[e] = 0);
    [pSaju.year, pSaju.month, pSaju.day].forEach(p => {
        if (p && p.s) pElements[p.s.e]++;
        if (p && p.b) pElements[p.b.e]++;
    });
    
    if (pElements[GODS.yong] >= 2) {
        analysis.yongsin.score = 15;
        analysis.yongsin.details.push({
            type: 'excellent',
            title: 'â­ ìƒëŒ€ê°€ ë‚´ ìš©ì‹ !',
            desc: `ìƒëŒ€ ì‚¬ì£¼ì— ë‚´ ìš©ì‹ (${ELEMENT[GODS.yong].k})ì´ í’ë¶€í•´ìš”!`,
            tip: 'ë§Œë‚˜ë©´ ìš´ì´ ì¢‹ì•„ì§€ëŠ” ê·€ì¸ì´ì—ìš”!'
        });
    } else if (pElements[GODS.yong] >= 1) {
        analysis.yongsin.score = 8;
        analysis.yongsin.details.push({
            type: 'good',
            title: 'âœ¨ ìƒëŒ€ì—ê²Œ ìš©ì‹  ìˆìŒ',
            desc: `ìƒëŒ€ ì‚¬ì£¼ì— ë‚´ ìš©ì‹ (${ELEMENT[GODS.yong].k})ì´ ìˆì–´ìš”.`,
            tip: 'í•¨ê»˜ ìˆìœ¼ë©´ ê¸°ìš´ì´ ë³´ì¶©ë¼ìš”.'
        });
    }
    
    // ìƒëŒ€ì˜ ìš©ì‹ ì´ ë‚´ ì‚¬ì£¼ì— ìˆëŠ”ì§€
    const myElements = {};
    EL_ORDER.forEach(e => myElements[e] = 0);
    [SAJU.year, SAJU.month, SAJU.day, SAJU.hour].forEach(p => {
        if (p && p.s) myElements[p.s.e]++;
        if (p && p.b) myElements[p.b.e]++;
    });
    
    if (myElements[pGods.yong] >= 2) {
        analysis.yongsin.score += 10;
        analysis.yongsin.details.push({
            type: 'good',
            title: 'ğŸ’« ë‚´ê°€ ìƒëŒ€ì˜ ìš©ì‹ !',
            desc: `ë‚´ ì‚¬ì£¼ì— ìƒëŒ€ ìš©ì‹ (${ELEMENT[pGods.yong].k})ì´ í’ë¶€í•´ìš”!`,
            tip: 'ìƒëŒ€ì—ê²Œ ë‚´ê°€ ê·€ì¸ì´ì—ìš”!'
        });
    }
    
    // ê¸°ì‹  ì²´í¬
    if (pElements[GODS.gi] >= 2) {
        analysis.yongsin.score -= 8;
        analysis.yongsin.details.push({
            type: 'caution',
            title: 'âš ï¸ ìƒëŒ€ì—ê²Œ ê¸°ì‹  ë§ìŒ',
            desc: `ìƒëŒ€ ì‚¬ì£¼ì— ë‚´ ê¸°ì‹ (${ELEMENT[GODS.gi].k})ì´ ë§ì•„ìš”.`,
            tip: 'ì˜¤ë˜ ë§Œë‚˜ë©´ ê¸°ìš´ì´ ë¹ ì§ˆ ìˆ˜ ìˆì–´ìš”.'
        });
    }
    
    // ========== 7. ì§€ì¥ê°„ ê¶í•© (ì•”í•©) ==========
    // ë‘ ì‚¬ëŒì˜ ì¼ì§€ ì§€ì¥ê°„ë¼ë¦¬ ì•”í•©ì´ ìˆëŠ”ì§€
    for (const ah of AMHAP) {
        if ((myDbIdx === ah.a && pDbIdx === ah.b) || (myDbIdx === ah.b && pDbIdx === ah.a)) {
            analysis.jijanggan.score = 10;
            analysis.jijanggan.details.push({
                type: 'special',
                title: 'ğŸ¤« ì•”í•© ë°œê²¬!',
                desc: `${ah.name} - ê²‰ìœ¼ë¡œëŠ” ì•ˆ í‹°ë‚˜ì§€ë§Œ ì†ìœ¼ë¡œ ëŒë¦¬ëŠ” ì‚¬ì´!`,
                tip: 'ë¬˜í•œ ëŒë¦¼ì´ ìˆì–´ìš”. ë¹„ë°€ì—°ì•  ì²´ì§ˆ?'
            });
            break;
        }
    }
    
    // ========== 8. ë  ê¶í•© (ë…„ì§€) ==========
    // ë…„ì§€ ì‚¼í•©
    for (const sh of samhapSets) {
        const myIn = sh.branches.includes(myYbIdx);
        const pIn = sh.branches.includes(pYbIdx);
        if (myIn && pIn && myYbIdx !== pYbIdx) {
            analysis.ddi.score = 8;
            analysis.ddi.details.push({
                type: 'good',
                title: 'ğŸ¾ ë  ì‚¼í•©!',
                desc: `${SAJU.year.b.a}ë ì™€ ${pSaju.year.b.a}ë ëŠ” ì‚¼í•©!`,
                tip: 'ì–´ë¥¸ë“¤ì´ ë³´ê¸°ì—ë„ ì¢‹ì€ ê¶í•©ì´ì—ìš”.'
            });
            break;
        }
    }
    
    // ë…„ì§€ ì¶©
    for (const jc of jiChung) {
        if ((myYbIdx === jc.a && pYbIdx === jc.b) || (myYbIdx === jc.b && pYbIdx === jc.a)) {
            analysis.ddi.score = -5;
            analysis.ddi.details.push({
                type: 'caution',
                title: 'ğŸ¾ ë  ìƒì¶©',
                desc: `${SAJU.year.b.a}ë ì™€ ${pSaju.year.b.a}ë ëŠ” ì¶© ê´€ê³„!`,
                tip: 'ì˜›ë‚  ë§ë¡œëŠ” ì•ˆ ì¢‹ì§€ë§Œ, ìš”ì¦˜ì€ ê·¹ë³µ ê°€ëŠ¥í•´ìš”.'
            });
            break;
        }
    }
    
    // ========== 9. ì¼ì£¼ íŠ¹ìˆ˜ ê¶í•© ==========
    const myIlju = SAJU.day.s.c + SAJU.day.b.c;
    const pIlju = pSaju.day.s.c + pSaju.day.b.c;
    
    // ì²œì„ê·€ì¸ ì²´í¬ (ì¼ê°„ ê¸°ì¤€)
    const guiin = {
        0: [1,7], 1: [0,8], 2: [11,9], 3: [11,9], 4: [1,7],
        5: [3,5], 6: [2,6], 7: [5,11], 8: [3,5], 9: [3,5]
    };
    if (guiin[myDmIdx]?.includes(pDbIdx)) {
        analysis.ilju.score = 10;
        analysis.ilju.details.push({
            type: 'excellent',
            title: 'ğŸ‘¼ ì²œì„ê·€ì¸!',
            desc: 'ìƒëŒ€ê°€ ë‚˜ì˜ ì²œì„ê·€ì¸ ìë¦¬ì— ìˆì–´ìš”!',
            tip: 'ì–´ë ¤ìš¸ ë•Œ ë„ì™€ì£¼ëŠ” ì²œìƒ ì¡°ë ¥ìì˜ˆìš”.'
        });
    }
    if (guiin[pDmIdx]?.includes(myDbIdx)) {
        analysis.ilju.score += 8;
        analysis.ilju.details.push({
            type: 'good',
            title: 'ğŸ‘¼ ë‚´ê°€ ìƒëŒ€ì˜ ê·€ì¸',
            desc: 'ë‚´ê°€ ìƒëŒ€ì˜ ì²œì„ê·€ì¸ì´ì—ìš”!',
            tip: 'ìƒëŒ€ì—ê²Œ í–‰ìš´ì„ ê°€ì ¸ë‹¤ì£¼ëŠ” ì‚¬ëŒì´ì—ìš”.'
        });
    }
    
    // ========== 10. ì›ì§„/ê·€ë¬¸ ê¶í•© (NEW) ==========
    // ì›ì§„ ì²´í¬ - ë¯¸ì›Œë„ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ê´€ê³„
    const wonJinPairs = [[0,7],[1,6],[2,5],[3,4],[4,3],[5,2],[6,1],[7,0],[8,11],[9,10],[10,9],[11,8]];
    for (const [a,b] of wonJinPairs) {
        if ((myDbIdx === a && pDbIdx === b) || (myYbIdx === a && pYbIdx === b)) {
            analysis.wonJinGuiMun.score = -12;
            analysis.wonJinGuiMun.details.push({
                type: 'caution',
                title: 'ğŸ’” ì›ì§„(æ€¨å—”) ê´€ê³„',
                desc: 'ë¯¸ì›Œë„ ë–¨ì–´ì§ˆ ìˆ˜ ì—†ëŠ” ì•…ì—°ì´ì—ìš”. ëŠìœ¼ë ¤ í•´ë„ ì§ˆì§ˆ ëŒë ¤ìš”.',
                tip: 'ì„œë¡œ ë¯¸ì›Œí•˜ë©´ì„œë„ ì‹ ê²½ ì“°ì´ëŠ” ê´€ê³„. ê±°ë¦¬ë‘ê¸°ê°€ í•„ìš”í•´ìš”.'
            });
            break;
        }
    }
    
    // ê·€ë¬¸ ì²´í¬ - ì •ì‹ ì  ê´´ë¡œì›€
    const guiMunPairs = [[2,7],[3,8],[4,9],[5,10],[6,11],[1,6]];
    for (const [a,b] of guiMunPairs) {
        if ((myDbIdx === a && pDbIdx === b) || (myDbIdx === b && pDbIdx === a)) {
            analysis.wonJinGuiMun.score -= 8;
            analysis.wonJinGuiMun.details.push({
                type: 'bad',
                title: 'ğŸ‘» ê·€ë¬¸(é¬¼é–€) ê´€ê³„',
                desc: 'ë§Œë‚˜ë©´ ì •ì‹ ì ìœ¼ë¡œ í˜ë“¤ì–´ì§ˆ ìˆ˜ ìˆì–´ìš”.',
                tip: 'ì‹¬ë¦¬ì  ê°ˆë“±ì´ ê¹Šì–´ìš”. ìƒë‹´ì´ë‚˜ ëŒ€í™”ê°€ í•„ìˆ˜!'
            });
            break;
        }
    }
    
    // í˜•ì‚´ ì²´í¬ - ì„œë¡œ í•´ì¹˜ëŠ” ê´€ê³„
    const hyungPairs = [[2,5],[5,8],[2,8],[1,10],[10,7],[1,7],[0,3]];
    for (const [a,b] of hyungPairs) {
        if ((myDbIdx === a && pDbIdx === b) || (myDbIdx === b && pDbIdx === a)) {
            analysis.wonJinGuiMun.score -= 6;
            analysis.wonJinGuiMun.details.push({
                type: 'caution',
                title: 'âš¡ í˜•(åˆ‘) ê´€ê³„',
                desc: 'ì„œë¡œì—ê²Œ ìƒì²˜ë¥¼ ì£¼ê¸° ì‰¬ìš´ ê´€ê³„ì˜ˆìš”.',
                tip: 'ë§ì¡°ì‹¬! ê°ì •ì ìœ¼ë¡œ ëŒ€í•˜ë©´ ìƒì²˜ê°€ ì»¤ì ¸ìš”.'
            });
            break;
        }
    }
    
    // ========== 11. ìœ¡ì¹œ ê¶í•© (NEW) ==========
    // ë‚¨ìì—ê²Œ ì—¬ìê°€ ì–´ë–¤ ì¡´ì¬ì¸ì§€ (ì¬ì„± = ì•„ë‚´)
    // ì—¬ìì—ê²Œ ë‚¨ìê°€ ì–´ë–¤ ì¡´ì¬ì¸ì§€ (ê´€ì„± = ë‚¨í¸)
    const myGender = GENDER;
    const pGenderVal = pGender;
    
    // ìƒëŒ€ì˜ ì¼ê°„ì´ ë‚˜ì—ê²Œ ì–´ë–¤ ì‹­ì‹ ì¸ì§€
    const partnerGodToMe = getTenGod(pDm, myDm);
    // ë‚´ ì¼ê°„ì´ ìƒëŒ€ì—ê²Œ ì–´ë–¤ ì‹­ì‹ ì¸ì§€
    const myGodToPartner = getTenGod(myDm, pDm);
    
    if (partnerGodToMe) {
        const godName = partnerGodToMe.k;
        
        // ì •ì¬/í¸ì¬ (ì¬ì„±) - ë‚¨ìì—ê²Œ ì•„ë‚´
        if (['ì •ì¬','í¸ì¬'].includes(godName)) {
            if (myGender === 'm') {
                analysis.yukChin.score = 12;
                analysis.yukChin.details.push({
                    type: 'excellent',
                    title: 'ğŸ’ ìƒëŒ€ê°€ ë‚˜ì˜ ì¬ì„±(è²¡æ˜Ÿ)',
                    desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”! ë‚¨ìì—ê²Œ ì¬ì„±ì€ ì•„ë‚´ë¥¼ ëœ»í•´ìš”.`,
                    tip: 'ìš´ëª…ì ì¸ ë°°ìš°ì ì¸ì—°ì´ì—ìš”. ê²°í˜¼í•˜ë©´ ì¬ë¬¼ìš´ë„ ì˜¬ë¼ìš”!'
                });
            } else {
                analysis.yukChin.score = 5;
                analysis.yukChin.details.push({
                    type: 'good',
                    title: 'ğŸ’° ìƒëŒ€ê°€ ë‚˜ì˜ ì¬ì„±',
                    desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”. í•¨ê»˜ ìˆìœ¼ë©´ ì¬ë¬¼ìš´ì´ ì¢‹ì•„ì ¸ìš”.`,
                    tip: 'ëˆ ê´€ë ¨í•´ì„œ ì¢‹ì€ íŒŒíŠ¸ë„ˆê°€ ë  ìˆ˜ ìˆì–´ìš”.'
                });
            }
        }
        // ì •ê´€/í¸ê´€ (ê´€ì„±) - ì—¬ìì—ê²Œ ë‚¨í¸
        else if (['ì •ê´€','í¸ê´€'].includes(godName)) {
            if (myGender === 'f') {
                analysis.yukChin.score = 12;
                analysis.yukChin.details.push({
                    type: 'excellent',
                    title: 'ğŸ‘” ìƒëŒ€ê°€ ë‚˜ì˜ ê´€ì„±(å®˜æ˜Ÿ)',
                    desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”! ì—¬ìì—ê²Œ ê´€ì„±ì€ ë‚¨í¸ì„ ëœ»í•´ìš”.`,
                    tip: 'ìš´ëª…ì ì¸ ë°°ìš°ì ì¸ì—°ì´ì—ìš”. ê²°í˜¼í•˜ë©´ ì‚¬íšŒìš´ë„ ì˜¬ë¼ìš”!'
                });
            } else {
                analysis.yukChin.score = 3;
                analysis.yukChin.details.push({
                    type: 'neutral',
                    title: 'ğŸ‘” ìƒëŒ€ê°€ ë‚˜ì˜ ê´€ì„±',
                    desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”. ë‚˜ë¥¼ í†µì œí•˜ë ¤ í•  ìˆ˜ ìˆì–´ìš”.`,
                    tip: 'ìƒí•˜ê´€ê³„ê°€ ìƒê¸°ê¸° ì‰¬ì›Œìš”. í‰ë“±í•œ ê´€ê³„ ìœ ì§€ í•„ìš”!'
                });
            }
        }
        // ë¹„ê²¬/ê²ì¬ - ì¹œêµ¬ ê°™ì€ ê´€ê³„
        else if (['ë¹„ê²¬','ê²ì¬'].includes(godName)) {
            analysis.yukChin.score = 5;
            analysis.yukChin.details.push({
                type: 'good',
                title: 'ğŸ¤ ìƒëŒ€ê°€ ë‚˜ì˜ ë¹„ê²(æ¯”åŠ«)',
                desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”. ë™ë“±í•œ ì¹œêµ¬ ê°™ì€ ê´€ê³„!`,
                tip: 'ê²½ìŸì‹¬ì´ ìƒê¸¸ ìˆ˜ ìˆì§€ë§Œ, ë™ì§€ë¡œì„œ í•¨ê»˜ ì„±ì¥í•´ìš”.'
            });
        }
        // ì‹ì‹ /ìƒê´€ - ë‚´ê°€ ìƒí•´ì£¼ëŠ” ê´€ê³„
        else if (['ì‹ì‹ ','ìƒê´€'].includes(godName)) {
            analysis.yukChin.score = 4;
            analysis.yukChin.details.push({
                type: 'good',
                title: 'ğŸ¨ ìƒëŒ€ê°€ ë‚˜ì˜ ì‹ìƒ(é£Ÿå‚·)',
                desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”. ë‚´ê°€ ëŒë´ì£¼ëŠ” ê´€ê³„!`,
                tip: 'ìƒëŒ€ë¥¼ ë³´ë©´ í‘œí˜„ìš•êµ¬ê°€ ìƒê²¨ìš”. ì°½ì‘ íŒŒíŠ¸ë„ˆë¡œ ì¢‹ì•„ìš”.'
            });
        }
        // ì •ì¸/í¸ì¸ - ìƒëŒ€ê°€ ë‚˜ë¥¼ ëŒë´ì£¼ëŠ” ê´€ê³„
        else if (['ì •ì¸','í¸ì¸'].includes(godName)) {
            analysis.yukChin.score = 6;
            analysis.yukChin.details.push({
                type: 'good',
                title: 'ğŸ“š ìƒëŒ€ê°€ ë‚˜ì˜ ì¸ì„±(å°æ˜Ÿ)',
                desc: `ìƒëŒ€ê°€ ë‚˜ì˜ ${godName}ì´ì—ìš”. ìƒëŒ€ê°€ ë‚˜ë¥¼ ëŒë´ì¤˜ìš”!`,
                tip: 'í¸ì•ˆí•˜ê³  ë³´í˜¸ë°›ëŠ” ëŠë‚Œ. ì—„ë§ˆ ê°™ì€ ìƒëŒ€ì˜ˆìš”.'
            });
        }
    }
    
    // ========== ì´ì  ê³„ì‚° ==========
    for (const key in analysis) {
        totalScore += analysis[key].score;
    }
    totalScore = Math.max(0, Math.min(100, totalScore));
    
    // ========== ë“±ê¸‰ íŒì • ==========
    let grade, color, summary;
    if (totalScore >= 85) { 
        grade = 'ğŸ’– ì²œìƒì—°ë¶„'; 
        color = '#e91e63'; 
        summary = 'ìµœê³ ì˜ ê¶í•©! ìš´ëª…ì ì¸ ë§Œë‚¨ì´ì—ìš”.';
    } else if (totalScore >= 70) { 
        grade = 'ğŸ’• ì•„ì£¼ ì¢‹ì€ ê¶í•©'; 
        color = '#9c27b0'; 
        summary = 'ì„œë¡œì—ê²Œ ì¢‹ì€ ê¸°ìš´ì„ ì£¼ëŠ” ê´€ê³„ì˜ˆìš”.';
    } else if (totalScore >= 55) { 
        grade = 'ğŸ’› ì¢‹ì€ ê¶í•©'; 
        color = '#ff9800'; 
        summary = 'ë…¸ë ¥í•˜ë©´ í–‰ë³µí•´ì§ˆ ìˆ˜ ìˆì–´ìš”!';
    } else if (totalScore >= 40) { 
        grade = 'ğŸ§¡ ë³´í†µ ê¶í•©'; 
        color = '#ff5722'; 
        summary = 'ì„œë¡œ ë‹¤ë¥¸ ì ì„ ì¸ì •í•˜ë©´ ì¢‹ì•„ì ¸ìš”.';
    } else { 
        grade = 'ğŸ’” ë…¸ë ¥ í•„ìš”'; 
        color = '#f44336'; 
        summary = 'ì‰½ì§€ ì•Šì§€ë§Œ, ì‚¬ë‘ì˜ í˜ìœ¼ë¡œ ê·¹ë³µ ê°€ëŠ¥í•´ìš”!';
    }
    
    // ========== ê²°ê³¼ ë Œë”ë§ ==========
    const categoryNames = {
        ilgan: {icon: 'â˜¯', name: 'ì¼ê°„ ê¶í•©', desc: 'ë‘ ì‚¬ëŒì˜ ë³¸ì§ˆì  ì¡°í™”'},
        ilji: {icon: 'ğŸ’‘', name: 'ì¼ì§€(ë°°ìš°ìê¶) ê¶í•©', desc: 'ê²°í˜¼ í›„ ìƒí™œ ì¡°í™”'},
        samhap: {icon: 'ğŸŒ€', name: 'ì‚¼í•©/ë°©í•© ê¶í•©', desc: 'ê°™ì€ ëª©í‘œì™€ ë°©í–¥'},
        napeum: {icon: 'ğŸµ', name: 'ë‚©ìŒ ê¶í•©', desc: 'ì˜í˜¼ì˜ íŒŒì¥'},
        yongsin: {icon: 'â­', name: 'ìš©ì‹  ê¶í•©', desc: 'ì„œë¡œì—ê²Œ ê·€ì¸ì¸ì§€'},
        jijanggan: {icon: 'ğŸ¤«', name: 'ì§€ì¥ê°„(ì•”í•©) ê¶í•©', desc: 'ìˆ¨ê²¨ì§„ ëŒë¦¼'},
        ddi: {icon: 'ğŸ¾', name: 'ë  ê¶í•©', desc: 'ì „í†µ ê¶í•©'},
        ilju: {icon: 'ğŸ‘¼', name: 'ê·€ì¸ ê¶í•©', desc: 'íŠ¹ë³„í•œ ì¸ì—°'},
        wonJinGuiMun: {icon: 'âš ï¸', name: 'ì›ì§„/ê·€ë¬¸ ê¶í•©', desc: 'ì•…ì—° ì²´í¬'},
        yukChin: {icon: 'ğŸ’', name: 'ìœ¡ì¹œ ê¶í•©', desc: 'ìš´ëª…ì  ì¸ì—° ë¶„ì„'}
    };
    
    // HTML ìƒì„±
    let html = `
        <div class="card" style="text-align:center;background:linear-gradient(145deg, rgba(233,30,99,0.15), rgba(156,39,176,0.08));">
            <p style="font-size:0.9rem;color:var(--gray);margin-bottom:10px;">ë‘ ì‚¬ëŒì˜ ê¶í•©</p>
            <p style="font-size:2.5rem;color:${color};margin-bottom:5px;">${grade}</p>
            <p style="font-size:2rem;font-weight:bold;margin-bottom:10px;">${totalScore}ì </p>
            <div style="background:#333;border-radius:10px;height:20px;margin:15px 0;">
                <div style="background:linear-gradient(90deg,${color},#ff6b6b);height:100%;border-radius:10px;width:${totalScore}%;transition:width 1s;"></div>
            </div>
            <p style="font-size:0.95rem;color:var(--gray);">${summary}</p>
        </div>
        
        <div class="card">
            <h3>ğŸ“Š ë‘ ì‚¬ëŒ ë¹„êµ</h3>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:15px;">
                <div style="text-align:center;padding:15px;background:rgba(253,216,53,0.1);border-radius:10px;">
                    <p style="font-size:0.8rem;color:var(--gray);margin-bottom:5px;">ë‚˜</p>
                    <p style="font-size:1.5rem;font-weight:bold;color:var(--gold);">${myIlju}</p>
                    <p style="font-size:0.9rem;">${myDm.k}${ELEMENT[myDm.e].k}</p>
                    <p style="font-size:0.8rem;color:var(--gray);">${myNapeum.name}</p>
                </div>
                <div style="text-align:center;padding:15px;background:rgba(233,30,99,0.1);border-radius:10px;">
                    <p style="font-size:0.8rem;color:var(--gray);margin-bottom:5px;">ìƒëŒ€</p>
                    <p style="font-size:1.5rem;font-weight:bold;color:#e91e63;">${pIlju}</p>
                    <p style="font-size:0.9rem;">${pDm.k}${ELEMENT[pDm.e].k}</p>
                    <p style="font-size:0.8rem;color:var(--gray);">${pNapeum.name}</p>
                </div>
            </div>
        </div>
    `;
    
    // ê° ì¹´í…Œê³ ë¦¬ë³„ ê²°ê³¼
    for (const key in analysis) {
        if (analysis[key].details.length === 0) continue;
        
        const cat = categoryNames[key];
        const scoreColor = analysis[key].score > 0 ? 'var(--wood)' : analysis[key].score < 0 ? 'var(--fire)' : 'var(--gray)';
        
        html += `
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                    <h3>${cat.icon} ${cat.name}</h3>
                    <span style="color:${scoreColor};font-weight:bold;">${analysis[key].score > 0 ? '+' : ''}${analysis[key].score}ì </span>
                </div>
                <p style="font-size:0.8rem;color:var(--gray);margin-bottom:10px;">${cat.desc}</p>
                ${analysis[key].details.map(d => `
                    <div style="padding:12px;margin-top:10px;border-radius:8px;
                        background:${d.type === 'excellent' ? 'rgba(233,30,99,0.1)' : 
                                    d.type === 'good' ? 'rgba(76,175,80,0.1)' : 
                                    d.type === 'special' ? 'rgba(156,39,176,0.1)' :
                                    d.type === 'caution' ? 'rgba(255,152,0,0.1)' : 
                                    d.type === 'bad' ? 'rgba(244,67,54,0.1)' : 'rgba(255,255,255,0.05)'};
                        border-left:3px solid ${d.type === 'excellent' ? '#e91e63' : 
                                              d.type === 'good' ? 'var(--wood)' : 
                                              d.type === 'special' ? '#9c27b0' :
                                              d.type === 'caution' ? 'var(--earth)' : 
                                              d.type === 'bad' ? 'var(--fire)' : 'var(--gray)'};">
                        <p style="font-weight:bold;margin-bottom:5px;">${d.title}</p>
                        <p style="font-size:0.9rem;margin-bottom:5px;">${d.desc}</p>
                        <p style="font-size:0.8rem;color:var(--gold);">ğŸ’¡ ${d.tip}</p>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    // ì¢…í•© ì¡°ì–¸
    html += `
        <div class="card" style="background:linear-gradient(145deg, rgba(253,216,53,0.1), rgba(255,152,0,0.05));">
            <h3>ğŸ’¡ ê¶í•© ì¢…í•© ì¡°ì–¸</h3>
            <div style="margin-top:15px;line-height:1.8;">
                ${totalScore >= 70 ? `
                    <p>âœ¨ ë‘ ë¶„ì€ <strong>ì²œìƒì—°ë¶„</strong>ì— ê°€ê¹Œìš´ ê¶í•©ì´ì—ìš”!</p>
                    <p>ì„œë¡œë¥¼ ìˆëŠ” ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ê³ , ê°ì‚¬í•˜ëŠ” ë§ˆìŒìœ¼ë¡œ í•¨ê»˜í•˜ì„¸ìš”.</p>
                ` : totalScore >= 50 ? `
                    <p>ğŸ’• ê´œì°®ì€ ê¶í•©ì´ì—ìš”! ì¡°ê¸ˆì˜ ë…¸ë ¥ìœ¼ë¡œ ë” ì¢‹ì•„ì§ˆ ìˆ˜ ìˆì–´ìš”.</p>
                    <p>ì„œë¡œ ë‹¤ë¥¸ ì ì„ ë‹¨ì ì´ ì•„ë‹Œ <strong>ë³´ì™„ì </strong>ìœ¼ë¡œ ë³´ì„¸ìš”.</p>
                ` : `
                    <p>ğŸ’ª ì‰½ì§€ ì•Šì€ ê¶í•©ì´ì§€ë§Œ, <strong>ì‚¬ë‘ì˜ í˜</strong>ìœ¼ë¡œ ê·¹ë³µ ê°€ëŠ¥í•´ìš”!</p>
                    <p>ì„œë¡œì˜ ì°¨ì´ë¥¼ ì¸ì •í•˜ê³ , ëŒ€í™”ë¥¼ ë§ì´ í•˜ì„¸ìš”.</p>
                `}
                <p style="margin-top:15px;padding-top:15px;border-top:1px solid rgba(255,255,255,0.1);">
                    <strong>ğŸ”® ê¶í•©ë³´ë‹¤ ì¤‘ìš”í•œ ê±´ ì„œë¡œë¥¼ í–¥í•œ ë§ˆìŒì´ì—ìš”.</strong><br>
                    ì¢‹ì€ ê¶í•©ë„ ë…¸ë ¥ ì—†ì´ëŠ” ë¬´ë„ˆì§€ê³ , ì•ˆ ì¢‹ì€ ê¶í•©ë„ ì‚¬ë‘ìœ¼ë¡œ ê·¹ë³µë©ë‹ˆë‹¤.
                </p>
            </div>
        </div>
        
        <div class="card" style="text-align:center;">
            <button class="btn" style="background:linear-gradient(135deg,#9C27B0,#673AB7);" onclick="copyMatchForAI()">
                ğŸ“‹ ì„œìˆ í˜• í•´ì„ì„ ìœ„í•œ ë³µì‚¬ (Gemini/ChatGPT)
            </button>
            <p style="margin-top:15px;font-size:13px;color:#9C27B0;opacity:0.9;line-height:1.8;">
                âœ¨ ì •ë°€í•œ ê¶í•© ë°ì´í„°ì™€ AIì˜ ì‹¬ì¸µ ë¶„ì„ì´ ë§Œë‚˜ëŠ”<br>
                <span style="color:var(--gold);font-weight:600;">í˜„ì¡´í•˜ëŠ” ê°€ì¥ ì™„ë²½í•œ ê¶í•© í•´ì„ì˜ ì¡°í•©</span>ì…ë‹ˆë‹¤
            </p>
            <p style="margin-top:10px;font-size:12px;color:#aaa;line-height:1.7;">
                ê³ ì „ ëª…ë¦¬ì˜ ë³µì¡í•œ ìˆ˜ì‹ì€ ë‹¨ í•œ ì¹˜ì˜ ì˜¤ì°¨ ì—†ì´ ê³„ì‚°í•˜ê³ ,<br>
                ê·¸ ê²°ê³¼ë¥¼ ì„¸ê³„ ìµœì •ìƒ AIê°€ ì˜¤ì§ ë‘ ë¶„ë§Œì„ ìœ„í•´ í•´ì„í•©ë‹ˆë‹¤.<br>
                <span style="color:var(--gold);opacity:0.9;">ì „ë¬¸ê°€ì˜ í†µì°°ê³¼ ê¸°ìˆ ì˜ ì •í™•ì„±, ë‘˜ ëª¨ë‘ë¥¼ ì·¨í•˜ì‹­ì‹œì˜¤.</span>
            </p>
        </div>
    `;
    
    document.getElementById('match-result').innerHTML = html;
    
    // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥ (AI ë³µì‚¬ìš©)
    window.MATCH_RESULT = { mySaju: SAJU, pSaju, myGods: GODS, pGods, analysis, totalScore, grade, myNapeum, pNapeum };
    } catch (error) {
        console.error('ê¶í•© ë¶„ì„ ì˜¤ë¥˜:', error);
        toast('ê¶í•© ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}

/* ========================================
   ê¶í•© AI ë³µì‚¬ ê¸°ëŠ¥
   ======================================== */
function copyMatchForAI() {
    if (!window.MATCH_RESULT) { toast('ë¨¼ì € ê¶í•©ì„ ë¶„ì„í•˜ì„¸ìš”'); return; }
    
    const r = window.MATCH_RESULT;
    const myDm = r.mySaju.day.s;
    const pDm = r.pSaju.day.s;
    
    let text = `===== ë‘ ì‚¬ëŒ ê¶í•© ë¶„ì„ ê²°ê³¼ =====

ã€ë‚˜ì˜ ì‚¬ì£¼ã€‘
â€¢ ì¼ì£¼: ${myDm.c}${r.mySaju.day.b.c} (${myDm.k}${r.mySaju.day.b.k})
â€¢ ì¼ê°„: ${myDm.k}${ELEMENT[myDm.e].k}
â€¢ ë‚©ìŒ: ${r.myNapeum.name} (${r.myNapeum.elementK})
â€¢ ìš©ì‹ : ${ELEMENT[r.myGods.yong].k}
â€¢ ì‚¬ì£¼ ì›êµ­: ${r.mySaju.year.s.c}${r.mySaju.year.b.c} ${r.mySaju.month.s.c}${r.mySaju.month.b.c} ${r.mySaju.day.s.c}${r.mySaju.day.b.c} ${r.mySaju.hour ? r.mySaju.hour.s.c + r.mySaju.hour.b.c : 'ì‹œì£¼ë¯¸ìƒ'}

ã€ìƒëŒ€ë°© ì‚¬ì£¼ã€‘
â€¢ ì¼ì£¼: ${pDm.c}${r.pSaju.day.b.c} (${pDm.k}${r.pSaju.day.b.k})
â€¢ ì¼ê°„: ${pDm.k}${ELEMENT[pDm.e].k}
â€¢ ë‚©ìŒ: ${r.pNapeum.name} (${r.pNapeum.elementK})
â€¢ ìš©ì‹ : ${ELEMENT[r.pGods.yong].k}
â€¢ ì‚¬ì£¼ ì›êµ­: ${r.pSaju.year.s.c}${r.pSaju.year.b.c} ${r.pSaju.month.s.c}${r.pSaju.month.b.c} ${r.pSaju.day.s.c}${r.pSaju.day.b.c}

ã€ê¶í•© ì ìˆ˜ã€‘
â€¢ ì´ì : ${r.totalScore}ì  (${r.grade})

ã€ì„¸ë¶€ ë¶„ì„ ê²°ê³¼ã€‘
`;

    const categoryNames = {
        ilgan: 'ì¼ê°„(ì²œê°„) ê¶í•©',
        ilji: 'ì¼ì§€(ë°°ìš°ìê¶) ê¶í•©', 
        samhap: 'ì‚¼í•©/ë°©í•© ê¶í•©',
        napeum: 'ë‚©ìŒ ê¶í•©',
        yongsin: 'ìš©ì‹  ê¶í•©',
        jijanggan: 'ì§€ì¥ê°„(ì•”í•©) ê¶í•©',
        ddi: 'ë  ê¶í•©',
        ilju: 'ê·€ì¸ ê¶í•©',
        wonJinGuiMun: 'ì›ì§„/ê·€ë¬¸ ê¶í•©',
        yukChin: 'ìœ¡ì¹œ ê¶í•©'
    };
    
    for (const key in r.analysis) {
        if (r.analysis[key].details.length === 0) continue;
        text += `\n[${categoryNames[key]}] (${r.analysis[key].score > 0 ? '+' : ''}${r.analysis[key].score}ì )\n`;
        r.analysis[key].details.forEach(d => {
            text += `â€¢ ${d.title}: ${d.desc}\n`;
        });
    }
    
    text += `
===== AI í•´ì„ ìš”ì²­ =====

[í˜ë¥´ì†Œë‚˜ ì„¤ì •]
ë‹¹ì‹ ì€ 30ë…„ ê²½ë ¥ì˜ í˜„ëŒ€ì ì´ê³  ì„¸ë ¨ëœ ëª…ë¦¬í•™ìì…ë‹ˆë‹¤.
- ì „ë¬¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ë˜, ì‰¬ìš´ ë¹„ìœ ë¥¼ ì„ì–´ ì„¤ëª…í•´ì£¼ì„¸ìš”.
- ë§íˆ¬ëŠ” ë”°ëœ»í•˜ê³  í¬ë§ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
- ë¶€ì •ì ì¸ ë‚´ìš©ë„ ê±´ì„¤ì ì¸ ì¡°ì–¸ê³¼ í•¨ê»˜ ì „ë‹¬í•´ì£¼ì„¸ìš”.

[ë¶„ì„ ìš”ì²­ì‚¬í•­]
ìœ„ ë‘ ì‚¬ëŒì˜ ê¶í•© ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì„ ìƒì„¸íˆ ì„œìˆ í˜•ìœ¼ë¡œ í•´ì„í•´ ì£¼ì„¸ìš”:

1. ë‘ ì‚¬ëŒì˜ ì²«ì¸ìƒê³¼ ëŒë¦¼
   - ì¼ê°„ê³¼ ë‚©ìŒ ê¸°ë°˜ìœ¼ë¡œ ì„œë¡œë¥¼ ì–´ë–»ê²Œ ëŠë¼ëŠ”ì§€

2. ì—°ì•  ì‹œì ˆ ëª¨ìŠµ
   - ë°ì´íŠ¸ ìŠ¤íƒ€ì¼, ì„œë¡œì—ê²Œ ëŒë¦¬ëŠ” í¬ì¸íŠ¸

3. ê²°í˜¼ í›„ ìƒí™œ
   - ì¼ì§€(ë°°ìš°ìê¶) ê¸°ë°˜ ê°€ì •ìƒí™œ ì˜ˆì¸¡
   - ê°ˆë“± í¬ì¸íŠ¸ì™€ í•´ê²°ì±…

4. ì„œë¡œì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥
   - ìš©ì‹  ê¶í•© ê¸°ë°˜ ê·€ì¸ ê´€ê³„ ë¶„ì„
   - ë§Œë‚˜ë©´ ìš´ì´ ì¢‹ì•„ì§€ëŠ”ì§€, ê¸°ìš´ì´ ë¹ ì§€ëŠ”ì§€

5. ìˆ¨ê²¨ì§„ ì¸ì—° (ì•”í•©ì´ ìˆë‹¤ë©´)
   - ë¹„ë°€ìŠ¤ëŸ¬ìš´ ëŒë¦¼, ì „ìƒì˜ ì¸ì—° ê°€ëŠ¥ì„±

6. ì¥ê¸°ì  ì „ë§
   - 10ë…„, 20ë…„ í›„ì—ë„ í•¨ê»˜í•  ìˆ˜ ìˆëŠ”ì§€
   - ìœ„ê¸°ê°€ ì˜¬ ìˆ˜ ìˆëŠ” ì‹œê¸°ì™€ ëŒ€ì²˜ë²•

7. ì¢…í•© ì¡°ì–¸
   - ì´ ì»¤í”Œì´ í–‰ë³µí•´ì§€ê¸° ìœ„í•œ êµ¬ì²´ì  ì¡°ì–¸
   - ì„œë¡œì—ê²Œ í•´ì£¼ë©´ ì¢‹ì€ ë§ê³¼ í–‰ë™
`;

    navigator.clipboard.writeText(text).then(() => {
        toast('ğŸ“‹ ë³µì‚¬ ì™„ë£Œ! Geminië‚˜ ChatGPTì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”');
    }).catch(() => {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        toast('ğŸ“‹ ë³µì‚¬ ì™„ë£Œ!');
    });
}

/* ========================================
   18. ê³µìœ 
   ======================================== */
function openShareModal() {
    if (!currentNumbers.length) { toast('ë¨¼ì € ë²ˆí˜¸ë¥¼ ìƒì„±í•˜ì„¸ìš”'); return; }
    document.getElementById('share-balls').innerHTML = currentNumbers.map(n => createBall(n, true)).join('');
    document.getElementById('share-modal').classList.add('active');
}

function closeShareModal() { document.getElementById('share-modal').classList.remove('active'); }

function shareNumbers() {
    const text = `ğŸ€ ì‚¬ì£¼ë¡œë˜ Pro\n${currentNumbers.join(' - ')}\nâœ¨ ì—­ëŒ€ ë‹¹ì²¨ë²ˆí˜¸ 100% ì œì™¸`;
    if (navigator.share) navigator.share({title:'ì‚¬ì£¼ë¡œë˜',text}).catch(copyNumbers);
    else copyNumbers();
}

function copyNumbers() {
    navigator.clipboard.writeText(`ğŸ€ ì‚¬ì£¼ë¡œë˜: ${currentNumbers.join(', ')}`).then(() => { toast('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'); closeShareModal(); });
}

function copyAccount() {
    navigator.clipboard.writeText(MY_ACCOUNT).then(() => toast('ê³„ì¢Œë²ˆí˜¸ ë³µì‚¬ë¨!'));
}

function saveImage() {
    if (!currentNumbers.length) { toast('ë¨¼ì € ë²ˆí˜¸ë¥¼ ìƒì„±í•˜ì„¸ìš”'); return; }
    toast('ìŠ¤í¬ë¦°ìƒ·ìœ¼ë¡œ ì €ì¥í•´ì£¼ì„¸ìš” ğŸ“±');
}
</script>

<!-- ì €ì‘ê¶Œ í‘œì‹œ -->
<div style="text-align:center;padding:20px;color:#555;font-size:11px;">
    Â© 2025 ì‚¬ì£¼ë¡œë˜ Pro. All Rights Reserved.<br>
    <span style="font-size:10px;color:#444;">ì´ ì„œë¹„ìŠ¤ì˜ ëª¨ë“  ì½˜í…ì¸ ì™€ ì½”ë“œëŠ” ì €ì‘ê¶Œë²•ì— ì˜í•´ ë³´í˜¸ë©ë‹ˆë‹¤.</span>
</div>

</body>
</html>
